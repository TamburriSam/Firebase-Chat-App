/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={342:(t,e,n)=>{"use strict";var r=n(475),i=n(444),o=n(163),a=n(765),s=n(936);function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c,l=u(r),h=((c={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",c["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",c["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",c["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",c["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",c["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",c["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",c["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",c["recaptcha-error"]="ReCAPTCHA error.",c),f=new a.ErrorFactory("appCheck","AppCheck",h),d=new Map,p={activated:!1,tokenListeners:[]},v={enabled:!1};function g(t){return d.get(t)||p}function y(t,e){d.set(t,e)}function m(){return v}function _(){return self.grecaptcha}function b(t){if(!g(t).activated)throw f.create("use-before-activation",{appName:t.name})}function w(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return b(t),[4,g(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=g(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function I(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),a=g(t);y(t,o.__assign(o.__assign({},a),{reCAPTCHAState:o.__assign(o.__assign({},a.reCAPTCHAState),{widgetId:i})}))}var T="https://content-firebaseappcheck.googleapis.com/v1beta",E=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new a.Deferred,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new a.Deferred,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function S(t,e){var n=t.url,r=t.body;return o.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,u,c,l,h,d,p;return o.__generator(this,(function(o){switch(o.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),a={method:"POST",body:JSON.stringify(r),headers:t},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,a)];case 2:return s=o.sent(),[3,4];case 3:throw u=o.sent(),f.create("fetch-network-error",{originalErrorMessage:u.message});case 4:if(200!==s.status)throw f.create("fetch-status-error",{httpStatus:s.status});o.label=5;case 5:return o.trys.push([5,7,,8]),[4,s.json()];case 6:return c=o.sent(),[3,8];case 7:throw l=o.sent(),f.create("fetch-parse-error",{originalErrorMessage:l.message});case 8:if(!(h=c.ttl.match(/^([\d.]+)(s)$/))||!h[2]||isNaN(Number(h[1])))throw f.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+c.ttl});return d=1e3*Number(h[1]),p=Date.now(),[2,{token:c.attestationToken,expireTimeMillis:p+d,issuedAtTimeMillis:p}]}}))}))}function C(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:T+"/projects/"+r+"/apps/"+i+":exchangeRecaptchaToken?key="+o,body:{recaptcha_token:e}}}function k(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:T+"/projects/"+r+"/apps/"+i+":exchangeDebugToken?key="+o,body:{debug_token:e}}}var A="firebase-app-check-store",N="debug-token",P=null;function R(){return P||(P=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(f.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(A,{keyPath:"compositeKey"})}}}catch(t){e(f.create("storage-open",{originalErrorMessage:t.message}))}})))}function x(t){return O(L(t))}function D(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,R()];case 1:return n=o.sent(),r=n.transaction(A,"readwrite"),i=r.objectStore(A),a=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){a.onsuccess=function(e){t()},r.onerror=function(t){var n;e(f.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function O(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,R()];case 1:return e=o.sent(),n=e.transaction(A,"readonly"),r=n.objectStore(A),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(f.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function L(t){return t.options.appId+"-"+t.name}var M=new s.Logger("@firebase/app-check");function F(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!a.isIndexedDBAvailable())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,x(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),M.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}function U(t,e){return a.isIndexedDBAvailable()?function(t,e){return D(L(t),e)}(t,e).catch((function(t){M.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function q(){return m().enabled}function j(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){if((t=m()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}var V={error:"UNKNOWN_ERROR"};function B(t,e,n){return void 0===n&&(n=!1),o.__awaiter(this,void 0,void 0,(function(){var r,i,s,u,c,l,h,d,p,v,m,_,I;return o.__generator(this,(function(T){switch(T.label){case 0:return b(t),q()?(r=S,i=k,s=[t],[4,j()]):[3,3];case 1:return[4,r.apply(void 0,[i.apply(void 0,s.concat([T.sent()])),e])];case 2:return[2,{token:T.sent().token}];case 3:return u=g(t),c=u.token,l=void 0,c?[3,5]:[4,F(t)];case 4:(h=T.sent())&&H(h)&&(c=h,y(t,o.__assign(o.__assign({},u),{token:c})),K(t,{token:c.token})),T.label=5;case 5:if(!n&&c&&H(c))return[2,{token:c.token}];T.label=6;case 6:return T.trys.push([6,12,,13]),u.customProvider?[4,u.customProvider.getToken()]:[3,8];case 7:return d=T.sent(),p=a.issuedAtTime(d.token),v=null!==p&&p<Date.now()&&p>0?1e3*p:Date.now(),c=o.__assign(o.__assign({},d),{issuedAtTimeMillis:v}),[3,11];case 8:return[4,w(t).catch((function(t){throw f.create("recaptcha-error")}))];case 9:return m=T.sent(),[4,S(C(t,m),e)];case 10:c=T.sent(),T.label=11;case 11:return[3,13];case 12:return _=T.sent(),M.error(_),l=_,[3,13];case 13:return c?[3,14]:(I=function(t){return{token:(e=V,a.base64.encodeString(JSON.stringify(e),!1)),error:t};var e}(l),[3,16]);case 14:return I={token:c.token},y(t,o.__assign(o.__assign({},u),{token:c})),[4,U(t,c)];case 15:T.sent(),T.label=16;case 16:return K(t,I),[2,I]}}))}))}function K(t,e){for(var n=0,r=g(t).tokenListeners;n<r.length;n++){var i=r[n];try{i(e)}catch(t){}}}function H(t){return t.expireTimeMillis-Date.now()>0}function W(t){return{activate:function(e,n){return function(t,e,n){var r=g(t);if(r.activated)throw f.create("already-activated",{appName:t.name});var i=o.__assign(o.__assign({},r),{activated:!0});"string"==typeof e?i.siteKey=e:i.customProvider=e,i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,y(t,i),i.siteKey&&function(t,e){var n=g(t),r=new a.Deferred;y(t,o.__assign(o.__assign({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);var u,c,l=_();return l?l.ready((function(){I(t,e,l,i),r.resolve(l)})):(u=function(){var n=_();if(!n)throw new Error("no recaptcha");n.ready((function(){I(t,e,n,i),r.resolve(n)}))},(c=document.createElement("script")).src="https://www.google.com/recaptcha/api.js",c.onload=u,document.head.appendChild(c)),r.promise}(t,i.siteKey).catch((function(){}))}(t,e,n)},setTokenAutoRefreshEnabled:function(e){return function(t,e){var n=g(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),y(t,o.__assign(o.__assign({},n),{isTokenAutoRefreshEnabled:e}))}(t,e)}}}function G(t,e){return{getToken:function(n){return B(t,e,n)},addTokenListener:function(n){return function(t,e,n){var r=g(t),i=o.__assign(o.__assign({},r),{tokenListeners:o.__spreadArray(o.__spreadArray([],r.tokenListeners),[n])});if(q()){var a=m();a.enabled&&a.token&&a.token.promise.then((function(t){return n({token:t})})).catch((function(){}))}else{if(!i.tokenRefresher){var s=function(t,e){var n=this;return new E((function(){return o.__awaiter(n,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return g(t).token?[3,2]:[4,B(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,B(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=g(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return n=Math.min(n,r),Math.max(0,n-Date.now())}return 0}),3e4,96e4)}(t,e);i.tokenRefresher=s}if(i.tokenRefresher.isRunning()||!0!==r.isTokenAutoRefreshEnabled||i.tokenRefresher.start(),r.token&&H(r.token)){var u=r.token;Promise.resolve().then((function(){return n({token:u.token})})).catch((function(){}))}}y(t,i)}(t,e,n)},removeTokenListener:function(e){return function(t,e){var n=g(t),r=n.tokenListeners.filter((function(t){return t!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),y(t,o.__assign(o.__assign({},n),{tokenListeners:r}))}(t,e)}}}var z="app-check-internal";!function(t){t.INTERNAL.registerComponent(new i.Component("appCheck",(function(t){return W(t.getProvider("app").getImmediate())}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider(z).initialize()}))),t.INTERNAL.registerComponent(new i.Component(z,(function(t){return G(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.1.4")}(l.default),function(){var t=a.getGlobal();if("string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){var e=m();e.enabled=!0;var n=new a.Deferred;e.token=n,"string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,O(N)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:((r=e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),D(N,r)).catch((function(t){return M.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}())}}()},475:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>w,firebase:()=>b});var r,i,o=n(163),a=n(765),s=n(444),u=n(936),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",f="[DEFAULT]",d=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/app-check"]="fire-app-check",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new u.Logger("@firebase/app"),v=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,a.deepCopy)(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=f),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){p.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!=typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if((0,a.contains)(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void p.warn(c.join(" "))}o(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument");(0,u.setUserLogHandler)(t,e)},apps:null,SDK_VERSION:"8.6.8",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,a.contains)(e,t))throw l.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return p.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw l.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&(0,a.deepExtend)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++){var f=h[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=(0,o.__assign)((0,o.__assign)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,a.deepExtend)(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,a.isBrowser)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,a.isNode)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_.apply(void 0,t)};var b=g;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new y(t)}),"PRIVATE")),t.registerVersion(h,"0.6.27",void 0),t.registerVersion("fire-js","")}(b);const w=b},444:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Component:()=>o,ComponentContainer:()=>u,Provider:()=>s});var r=n(163),i=n(765),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),a="[DEFAULT]",s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}try{for(var i=(0,r.__values)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=(0,r.__read)(o.value,2),u=s[0],c=s[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=a),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,r.__read)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=a),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var i=t.options,o=void 0===i?{}:i,a=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:a,options:o});try{for(var u=(0,r.__values)(this.instancesDeferred.entries()),c=u.next();!c.done;c=u.next()){var l=(0,r.__read)(c.value,2),h=l[0],f=l[1];a===this.normalizeInstanceIdentifier(h)&&f.resolve(s)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return this.invokeOnInitCallbacks(s,a),s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,i,o=this.onInitCallbacks.get(e);if(o)try{for(var a=(0,r.__values)(o),s=a.next();!s.done;s=a.next()){var u=s.value;try{u(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===a?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=a),this.component?this.component.multipleInstances?t:a:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},899:(t,e,n)=>{"use strict";var r=n(475),i=n(444),o=n(765),a=n(163),s=n(936);t=n.hmd(t);var u="";function c(t){u=t}var l,h=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.stringify)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.jsonEval)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),f=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.contains)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),d=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new h(e)}}catch(t){}return new f},p=d("localStorage"),v=d("sessionStorage"),g=new s.Logger("@firebase/database"),y=(l=1,function(){return l++}),m=function(t){var e=(0,o.stringToByteArray)(t),n=new o.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)},_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=_.apply(null,i):n+="object"==typeof i?(0,o.stringify)(i):i,n+=" "}return n},b=null,w=!0,I=function(t,e){(0,o.assert)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(g.logLevel=s.LogLevel.VERBOSE,b=g.log.bind(g),e&&v.set("logging_enabled",!0)):"function"==typeof t?b=t:(b=null,v.remove("logging_enabled"))},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===w&&(w=!1,null===b&&!0===v.get("logging_enabled")&&I(!0)),b){var n=_.apply(null,t);b(n)}},E=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];T.apply(void 0,(0,a.__spreadArray)([t],(0,a.__read)(e)))}},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+_.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));g.error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+_.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));throw g.error(n),new Error(n)},k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+_.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));g.warn(n)},A=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},N="[MIN_NAME]",P="[MAX_NAME]",R=function(t,e){if(t===e)return 0;if(t===N||e===P)return-1;if(e===N||t===P)return 1;var n=q(t),r=q(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},x=function(t,e){return t===e?0:t<e?-1:1},D=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.stringify)(e))},O=function(t){if("object"!=typeof t||null===t)return(0,o.stringify)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.stringify)(e[i]),r+=":",r+=O(t[e[i]]);return r+"}"},L=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function M(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var F=function(t){(0,o.assert)(!A(t),"Invalid JSON number");var e,n,r,i,a;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},U=new RegExp("^-?(0*)\\d{1,10}$"),q=function(t){if(U.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},j=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw k("Exception was thrown by user callback.",e),t}),Math.floor(0))}},V=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},B=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){k('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),K=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(T("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',k(t)},t}(),H=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),W=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,G="websocket",z="long_polling",Q=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=p.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&p.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function Y(t,e,n){var r;if((0,o.assert)("string"==typeof e,"typeof type must == string"),(0,o.assert)("object"==typeof n,"typeof params must == object"),e===G)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==z)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return M(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}var X=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.contains)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.deepCopy)(this.counters_)},t}(),$={},J={};function Z(t){var e=t.toString();return $[e]||($[e]=new X),$[e]}var tt=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&j((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),et="start",nt="close",rt=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(t),this.stats_=Z(e),this.urlFn=function(t){return s.appCheckToken&&(t.ac=s.appCheckToken),Y(e,z,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new tt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.isNodeSdk)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new it((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.__read)(t,5),i=r[0],o=r[1],s=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===et)n.id=o,n.password=s;else{if(i!==nt)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.__read)(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!((0,o.isNodeSdk)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.base64Encode)(e),r=L(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.stringify)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),it=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.isNodeSdk)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=y(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(t){T("frame writing exception"),t.stack&&T(t.stack),T(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||T("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.isNodeSdk)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){T("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),ot=null;"undefined"!=typeof MozWebSocket?ot=MozWebSocket:"undefined"!=typeof WebSocket&&(ot=WebSocket);var at=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=Z(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={v:"5"};return!(0,o.isNodeSdk)()&&"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i.ac=r),Y(t,G,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,p.set("previous_websocket_failure",!0);try{if((0,o.isNodeSdk)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+u+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.nodeAdmin?i.headers.Authorization=this.authToken||"":i.headers["X-Firebase-AppCheck"]=this.appCheckToken||"";var a=process.env,s=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new ot(this.connURL,[],i)}else i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}},this.mySock=new ot(this.connURL,[],i)}catch(t){this.log_("Error instantiating WebSocket.");var c=t.message||t.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ot&&!t.forceDisallow_},t.previouslyFailed=function(){return p.isInMemoryStorage||!0===p.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){p.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.jsonEval)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.assert)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=L(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),st=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[rt,at]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=at&&at.isAvailable(),o=i&&!at.previouslyFailed();if(e.webSocketOnly&&(i||k("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[at];else{var s=this.transports_=[];try{for(var u=(0,a.__values)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&s.push(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),ut=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new st(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=V((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=D("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?S("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&k("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),V((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):V((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(p.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),ct=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),lt=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.assert)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=(0,a.__spreadArray)([],(0,a.__read)(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.assert)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),ht=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.isMobileCordova)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return(0,a.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(lt),ft=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function dt(){return new ft("")}function pt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function vt(t){return t.pieces_.length-t.pieceNum_}function gt(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new ft(t.pieces_,e)}function yt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function mt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function _t(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ft(e,0)}function bt(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ft)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new ft(n,0)}function wt(t){return t.pieceNum_>=t.pieces_.length}function It(t,e){var n=pt(t),r=pt(e);if(null===n)return e;if(n===r)return It(gt(t),gt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Tt(t,e){for(var n=mt(t,0),r=mt(e,0),i=0;i<n.length&&i<r.length;i++){var o=R(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Et(t,e){if(vt(t)!==vt(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function St(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(vt(t)>vt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Ct=function(t,e){this.errorPrefix_=e,this.parts_=mt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.stringLength)(this.parts_[n]);kt(this)};function kt(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+At(t))}function At(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Nt,Pt,Rt=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return(0,a.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(lt),xt=1e3,Dt=function(t){function e(n,r,i,a,s,u,c,l){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=e.nextPersistentConnectionId_++,h.log_=E("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=xt,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!(0,o.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Rt.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&ht.getInstance().on("online",h.onOnline_,h),h}return(0,a.__extends)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r,a:t,b:e};this.log_((0,o.stringify)(i)),(0,o.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new o.Deferred,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&i===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.assert)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,o.contains)(t,"w")){var n=(0,o.safeGet)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();k("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.isAdmin)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.isValidFormat)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.stringify)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):S("Unrecognized action received from server: "+(0,o.stringify)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=xt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=xt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,s,u,c,l,h,f,d,p,v,g,y=this;return(0,a.__generator)(this,(function(m){switch(m.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,s=this.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,r())},h=function(t){(0,o.assert)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)},this.realtime_={close:l,sendRequest:h},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)])];case 2:return d=a.__read.apply(void 0,[m.sent(),2]),p=d[0],v=d[1],u?T("getToken() completed but was canceled"):(T("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=v&&v.token,c=new ut(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){k(t+" ("+y.repoInfo_.toString()+")"),y.interrupt("server_kill")}),s)),[3,4];case 3:return g=m.sent(),this.log_("Failed to get token: "+g),u||(this.repoInfo_.nodeAdmin&&k(g),l()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){T("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){T("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=xt,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return O(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new ft(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){T("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){T("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=(0,a.__values)(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,(0,a.__values)(s.values())),c=u.next();!c.done;c=u.next()){var l=c.value;this.sendListen_(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.isNodeSdk)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+u.replace(/\./g,"-")]=1,(0,o.isMobileCordova)()?t["framework.cordova"]=1:(0,o.isReactNative)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=ht.getInstance().currentlyOnline();return(0,o.isEmpty)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(ct),Ot=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Lt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ot(N,t),r=new Ot(N,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ot.MIN},t}(),Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Nt},set:function(t){Nt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return R(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return new Ot(P,Nt)},e.prototype.makePost=function(t,e){return(0,o.assert)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ot(t,Nt)},e.prototype.toString=function(){return".key"},e}(Lt),Ft=new Mt,Ut=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),qt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Vt.EMPTY_NODE,this.right=null!=o?o:Vt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Vt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Vt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),jt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new qt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Vt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,qt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Ut(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Ut(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Ut(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Ut(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new jt,t}();function Bt(t,e){return R(t.name,e.name)}function Kt(t,e){return R(t,e)}var Ht,Wt,Gt,zt,Qt,Yt=function(t){return"number"==typeof t?"number:"+F(t):"string:"+t},Xt=function(t){if(t.isLeafNode()){var e=t.val();(0,o.assert)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,o.contains)(e,".sv"),"Priority must be a string or number.")}else(0,o.assert)(t===Pt||t.isEmpty(),"priority of unexpected type.");(0,o.assert)(t===Pt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},$t=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Xt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Ht},set:function(t){Ht=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return wt(e)?this:".priority"===pt(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=pt(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.assert)(".priority"!==r||1===vt(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(gt(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Yt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?F(this.value_):this.value_,this.lazyHash_=m(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.assert)(i>=0,"Unknown leaf type: "+n),(0,o.assert)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Jt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?R(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return new Ot(P,new $t("[PRIORITY-POST]",Gt))},e.prototype.makePost=function(t,e){var n=Wt(t);return new Ot(e,new $t("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Lt)),Zt=Math.log(2),te=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Zt,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ee=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new qt(a,o.node,qt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new qt(a,o.node,qt.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new qt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,qt.BLACK):(s(h,qt.BLACK),s(h,qt.RED))}return o}(new te(t.length));return new Vt(r||e,o)},ne={},re=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.assert)(ne&&Jt,"ChildrenNode.ts has not been loaded"),zt=zt||new t({".priority":ne},{".priority":Jt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.safeGet)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Vt?e:null},t.prototype.hasIndex=function(t){return(0,o.contains)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.assert)(e!==Ft,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],s=!1,u=n.getIterator(Ot.Wrap),c=u.getNext();c;)s=s||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=s?ee(i,e.getCompare()):ne;var l=e.toString(),h=(0,a.__assign)({},this.indexSet_);h[l]=e;var f=(0,a.__assign)({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.map)(this.indexes_,(function(t,i){var a=(0,o.safeGet)(r.indexSet_,i);if((0,o.assert)(a,"Missing index implementation for "+i),t===ne){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(Ot.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),ee(s,a.getCompare())}return ne}var l=n.get(e.name),h=t;return l&&(h=h.remove(new Ot(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.map)(this.indexes_,(function(t){if(t===ne)return t;var r=n.get(e.name);return r?t.remove(new Ot(e.name,r)):t})),this.indexSet_)},t}(),ie=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Xt(this.priorityNode_),this.children_.isEmpty()&&(0,o.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Qt||(Qt=new t(new Vt(Kt),null,re.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Qt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Qt:e},t.prototype.getChild=function(t){var e=pt(t);return null===e?this:this.getImmediateChild(e).getChild(gt(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.assert)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ot(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?Qt:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=pt(t);if(null===n)return e;(0,o.assert)(".priority"!==pt(t)||1===vt(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(gt(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Jt,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Yt(this.getPriority().val())+":"),this.forEachChild(Jt,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":m(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ot(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ot(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ot(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Ot.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Ot.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===oe?-1:0},t.prototype.withIndex=function(e){if(e===Ft||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Ft||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Jt),r=e.getIterator(Jt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Ft?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),oe=new(function(t){function e(){return t.call(this,new Vt(Kt),ie.EMPTY_NODE,re.Default)||this}return(0,a.__extends)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return ie.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(ie));function ae(t,e){if(void 0===e&&(e=null),null===t)return ie.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.assert)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new $t(t,ae(e));if(t instanceof Array){var n=ie.EMPTY_NODE;return M(t,(function(e,r){if((0,o.contains)(t,e)&&"."!==e.substring(0,1)){var i=ae(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(ae(e))}var r=[],i=!1;if(M(t,(function(t,e){if("."!==t.substring(0,1)){var n=ae(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Ot(t,n)))}})),0===r.length)return ie.EMPTY_NODE;var a=ee(r,Bt,(function(t){return t.name}),Kt);if(i){var s=ee(r,Jt.getCompare());return new ie(a,ae(e),new re({".priority":s},{".priority":Jt}))}return new ie(a,ae(e),re.Default)}Object.defineProperties(Ot,{MIN:{value:new Ot(N,ie.EMPTY_NODE)},MAX:{value:new Ot(P,oe)}}),Mt.__EMPTY_NODE=ie.EMPTY_NODE,$t.__childrenNodeConstructor=ie,Pt=oe,Gt=oe,function(t){Wt=t}(ae);var se,ue,ce=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.assert)(!wt(e)&&".priority"!==pt(e),"Can't create PathIndex with empty path or .priority key"),n}return(0,a.__extends)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?R(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=ae(t),r=ie.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ot(e,r)},e.prototype.maxPost=function(){var t=ie.EMPTY_NODE.updateChild(this.indexPath_,oe);return new Ot(P,t)},e.prototype.toString=function(){return mt(this.indexPath_,0).join("/")},e}(Lt),le=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?R(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return Ot.MAX},e.prototype.makePost=function(t,e){var n=ae(t);return new Ot(e,n)},e.prototype.toString=function(){return".value"},e}(Lt)),he="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",fe=(se=0,ue=[],function(t){var e,n=t===se;se=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=he.charAt(t%64),t=Math.floor(t/64);(0,o.assert)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===ue[e];e--)ue[e]=0;ue[e]++}else for(e=0;e<12;e++)ue[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=he.charAt(ue[e]);return(0,o.assert)(20===i.length,"nextPushId: Length should be 20."),i}),de=function(t){if("2147483647"===t)return"-";var e=q(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return P;var o=n[i],a=he.charAt(he.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},pe=function(t){if("-2147483648"===t)return N;var e=q(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=he.charAt(he.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function ve(t){return{type:"value",snapshotNode:t}}function ge(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ye(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function me(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var _e=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){(0,o.assert)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(ye(e,s)):(0,o.assert)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(ge(e,n)):a.trackChildChange(me(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Jt,(function(t,r){e.hasChild(t)||n.trackChildChange(ye(t,r))})),e.isLeafNode()||e.forEachChild(Jt,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(me(e,r,i))}else n.trackChildChange(ge(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?ie.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),be=function(){function t(e){this.indexedFilter_=new _e(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ot(e,n))||(n=ie.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=ie.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(ie.EMPTY_NODE);var i=this;return e.forEachChild(Jt,(function(t,e){i.matches(new Ot(t,e))||(r=r.updateImmediateChild(t,ie.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),we=function(){function t(t){this.rangedFilter_=new be(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ot(e,n))||(n=ie.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=ie.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=ie.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(ie.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,ie.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;(0,o.assert)(u.numChildren()===this.limit_,"");var c=new Ot(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(me(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(ye(e,f));var v=u.updateImmediateChild(e,ie.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(ge(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=i&&(i.trackChildChange(ye(l.name,l.node)),i.trackChildChange(ge(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,ie.EMPTY_NODE)):t},t}(),Ie=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Jt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:N},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:P},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Jt},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Te(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Ee(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Se(t,e){var n=t.copy();return n.index_=e,n}function Ce(t){var e,n={};return t.isDefault()||(t.index_===Jt?e="$priority":t.index_===le?e="$value":t.index_===Ft?e="$key":((0,o.assert)(t.index_ instanceof ce,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,o.stringify)(e),t.startSet_&&(n.startAt=(0,o.stringify)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,o.stringify)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,o.stringify)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,o.stringify)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function ke(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Jt&&(e.i=t.index_.toString()),e}var Ae=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=E("p:rest:"),o.listens_={},o}return(0,a.__extends)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.assert)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=Ce(t._queryParams);this.restRequest_(s+".json",l,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),(0,o.safeGet)(a.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=Ce(t._queryParams),r=t._path.toString(),i=new o.Deferred;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var s=(0,a.__read)(i,2),u=s[0],c=s[1];u&&u.accessToken&&(e.auth=u.accessToken),c&&c.token&&(e.ac=c.token);var l=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.querystring)(e);r.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=(0,o.jsonEval)(h.responseText)}catch(t){k("Failed to parse JSON response for "+l+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&k("Got unsuccessful REST response for "+l+" Status: "+h.status),n(h.status);n=null}},h.open("GET",l,!0),h.send()}))},e}(ct),Ne=function(){function t(){this.rootNode_=ie.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function Pe(){return{value:null,children:new Map}}function Re(t,e,n){if(wt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=pt(e);t.children.has(r)||t.children.set(r,Pe()),Re(t.children.get(r),e=gt(e),n)}}function xe(t,e){if(wt(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(Jt,(function(e,n){Re(t,new ft(e),n)})),xe(t,e)}if(t.children.size>0){var r=pt(e);return e=gt(e),t.children.has(r)&&xe(t.children.get(r),e)&&t.children.delete(r),0===t.children.size}return!0}function De(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){De(r,new ft(e.toString()+"/"+t),n)}))}var Oe,Le=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,a.__assign)({},t);return this.last_&&M(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Me=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Le(t);var n=1e4+2e4*Math.random();V(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;M(e,(function(e,i){i>0&&(0,o.contains)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),V(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function Fe(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Oe||(Oe={}));var Ue,qe=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Oe.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(wt(this.path)){if(null!=this.affectedTree.value)return(0,o.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new ft(e));return new t(dt(),n,this.revert)}return(0,o.assert)(pt(this.path)===e,"operationForChild called for unrelated child."),new t(gt(this.path),this.affectedTree,this.revert)},t}(),je=function(){function t(t,e){this.source=t,this.path=e,this.type=Oe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return wt(this.path)?new t(this.source,dt()):new t(this.source,gt(this.path))},t}(),Ve=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Oe.OVERWRITE}return t.prototype.operationForChild=function(e){return wt(this.path)?new t(this.source,dt(),this.snap.getImmediateChild(e)):new t(this.source,gt(this.path),this.snap)},t}(),Be=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Oe.MERGE}return t.prototype.operationForChild=function(e){if(wt(this.path)){var n=this.children.subtree(new ft(e));return n.isEmpty()?null:n.value?new Ve(this.source,dt(),n.value):new t(this.source,dt(),n)}return(0,o.assert)(pt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,gt(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Ke=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(wt(t))return this.isFullyInitialized()&&!this.filtered_;var e=pt(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),He=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function We(t,e,n,r,i,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.assertionError)("Should only compare child_ events.");var r=new Ot(e.childName,e.snapshotNode),i=new Ot(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Ge(t,e){return{eventCache:t,serverCache:e}}function ze(t,e,n,r){return Ge(new Ke(e,n,r),t.serverCache)}function Qe(t,e,n,r){return Ge(t.eventCache,new Ke(e,n,r))}function Ye(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Xe(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var $e=function(){function t(t,e){void 0===e&&(Ue||(Ue=new Vt(x)),e=Ue),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return M(e,(function(t,e){n=n.set(new ft(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:dt(),value:this.value};if(wt(t))return null;var n=pt(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(gt(t),e);return null!=i?{path:bt(new ft(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(wt(e))return this;var n=pt(e),r=this.children.get(n);return null!==r?r.subtree(gt(e)):new t(null)},t.prototype.set=function(e,n){if(wt(e))return new t(n,this.children);var r=pt(e),i=(this.children.get(r)||new t(null)).set(gt(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(wt(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=pt(e),r=this.children.get(n);if(r){var i=r.remove(gt(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(wt(t))return this.value;var e=pt(t),n=this.children.get(e);return n?n.get(gt(t)):null},t.prototype.setTree=function(e,n){if(wt(e))return n;var r,i=pt(e),o=(this.children.get(i)||new t(null)).setTree(gt(e),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(dt(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(bt(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,dt(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(wt(t))return null;var i=pt(t),o=this.children.get(i);return o?o.findOnPath_(gt(t),bt(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,dt(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(wt(e))return this;this.value&&r(n,this.value);var i=pt(e),o=this.children.get(i);return o?o.foreachOnPath_(gt(e),bt(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(dt(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(bt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),Je=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new $e(null))},t}();function Ze(t,e,n){if(wt(e))return new Je(new $e(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=It(i,e);return o=o.updateChild(a,n),new Je(t.writeTree_.set(i,o))}var s=new $e(n),u=t.writeTree_.setTree(e,s);return new Je(u)}function tn(t,e,n){var r=t;return M(n,(function(t,n){r=Ze(r,bt(e,t),n)})),r}function en(t,e){if(wt(e))return Je.empty();var n=t.writeTree_.setTree(e,new $e(null));return new Je(n)}function nn(t,e){return null!=rn(t,e)}function rn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(It(n.path,e)):null}function on(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Jt,(function(t,n){e.push(new Ot(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ot(t,n.value))})),e}function an(t,e){if(wt(e))return t;var n=rn(t,e);return new Je(null!=n?new $e(n):t.writeTree_.subtree(e))}function sn(t){return t.writeTree_.isEmpty()}function un(t,e){return cn(dt(),t.writeTree_,e)}function cn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.assert)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=cn(bt(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(bt(t,".priority"),r)),n}function ln(t,e){return wn(e,t)}function hn(t,e){if(t.snap)return St(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&St(bt(t.path,n),e))return!0;return!1}function fn(t){return t.visible}function dn(t,e,n){for(var r=Je.empty(),i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)St(n,s)?r=Ze(r,u=It(n,s),a.snap):St(s,n)&&(u=It(s,n),r=Ze(r,dt(),a.snap.getChild(u)));else{if(!a.children)throw(0,o.assertionError)("WriteRecord should have .snap or .children");if(St(n,s))r=tn(r,u=It(n,s),a.children);else if(St(s,n))if(wt(u=It(s,n)))r=tn(r,dt(),a.children);else{var c=(0,o.safeGet)(a.children,pt(u));if(c){var l=c.getChild(gt(u));r=Ze(r,dt(),l)}}}}}return r}function pn(t,e,n,r,i){if(r||i){var o=an(t.visibleWrites,e);return!i&&sn(o)?n:i||null!=n||nn(o,dt())?un(dn(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(St(t.path,e)||St(e,t.path))}),e),n||ie.EMPTY_NODE):null}var a=rn(t.visibleWrites,e);if(null!=a)return a;var s=an(t.visibleWrites,e);return sn(s)?n:null!=n||nn(s,dt())?un(s,n||ie.EMPTY_NODE):null}function vn(t,e,n,r){return pn(t.writeTree,t.treePath,e,n,r)}function gn(t,e){return function(t,e,n){var r=ie.EMPTY_NODE,i=rn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Jt,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=an(t.visibleWrites,e);return n.forEachChild(Jt,(function(t,e){var n=un(an(o,new ft(t)),e);r=r.updateImmediateChild(t,n)})),on(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return on(an(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function yn(t,e,n,r){return function(t,e,n,r,i){(0,o.assert)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=bt(e,n);if(nn(t.visibleWrites,a))return null;var s=an(t.visibleWrites,a);return sn(s)?i.getChild(n):un(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function mn(t,e){return function(t,e){return rn(t.visibleWrites,e)}(t.writeTree,bt(t.treePath,e))}function _n(t,e,n){return function(t,e,n,r){var i=bt(e,n),o=rn(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?un(an(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function bn(t,e){return wn(bt(t.treePath,e),t.writeTree)}function wn(t,e){return{treePath:t,writeTree:e}}var In=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.assert)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,me(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,ye(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,ge(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.assertionError)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,me(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Tn=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),En=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Ke(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _n(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Xe(this.viewCache_),i=function(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=an(t.visibleWrites,e),c=rn(u,dt());if(null!=c)s=c;else{if(null==n)return[];s=un(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(t.writeTree,t.treePath,e,n,r,i,o)}(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();function Sn(t,e,n,r,i,a){var s=e.eventCache;if(null!=mn(r,n))return e;var u=void 0,c=void 0;if(wt(n))if((0,o.assert)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var l=Xe(e),h=gn(r,l instanceof ie?l:ie.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),h,a)}else{var f=vn(r,Xe(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var d=pt(n);if(".priority"===d){(0,o.assert)(1===vt(n),"Can't have a priority with additional path components");var p=s.getNode(),v=yn(r,n,p,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(p,v):s.getNode()}else{var g=gt(n),y=void 0;if(s.isCompleteForChild(d)){c=e.serverCache.getNode();var m=yn(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(d).updateChild(g,m):s.getNode().getImmediateChild(d)}else y=_n(r,d,e.serverCache);u=null!=y?t.filter.updateChild(s.getNode(),d,y,g,i,a):s.getNode()}}return ze(e,u,s.isFullyInitialized()||wt(n),t.filter.filtersNodes())}function Cn(t,e,n,r,i,o,a,s){var u,c=e.serverCache,l=a?t.filter:t.filter.getIndexedFilter();if(wt(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=pt(n);if(!c.isCompleteForPath(n)&&vt(n)>1)return e;var d=gt(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,Tn,null)}var v=Qe(e,u,c.isFullyInitialized()||wt(n),l.filtersNodes());return Sn(t,v,n,i,new En(i,v,o),s)}function kn(t,e,n,r,i,o,a){var s,u,c=e.eventCache,l=new En(i,e,o);if(wt(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=ze(e,u,!0,t.filter.filtersNodes());else{var h=pt(n);if(".priority"===h)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=ze(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=gt(n),d=c.getNode().getImmediateChild(h),p=void 0;if(wt(f))p=r;else{var v=l.getCompleteChild(h);p=null!=v?".priority"===yt(f)&&v.getChild(_t(f)).isEmpty()?v:v.updateChild(f,r):ie.EMPTY_NODE}s=d.equals(p)?e:ze(e,t.filter.updateChild(c.getNode(),h,p,f,l,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function An(t,e){return t.eventCache.isCompleteForChild(e)}function Nn(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function Pn(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=wt(n)?r:new $e(null).setTree(n,r);var l=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=Nn(0,e.serverCache.getNode().getImmediateChild(n),r);c=Cn(t,c,new ft(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=Nn(0,e.serverCache.getNode().getImmediateChild(n),r);c=Cn(t,c,new ft(n),h,i,o,a,s)}})),c}var Rn,xn=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new _e(r.getIndex()),o=(n=r).loadsAllData()?new _e(n.getIndex()):n.hasLimit()?new we(n):new be(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(ie.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(ie.EMPTY_NODE,s.getNode(),null),l=new Ke(u,a.isFullyInitialized(),i.filtersNodes()),h=new Ke(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ge(h,l),this.eventGenerator_=new He(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function Dn(t,e){var n=Xe(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!wt(e)&&!n.getImmediateChild(pt(e)).isEmpty())?n.getChild(e):null}function On(t){return 0===t.eventRegistrations_.length}function Ln(t,e,n){var r=[];if(n){(0,o.assert)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function Mn(t,e,n,r){e.type===Oe.MERGE&&null!==e.source.queryId&&((0,o.assert)(Xe(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.assert)(Ye(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=t.viewCache_,u=function(t,e,n,r,i){var a,s,u=new In;if(n.type===Oe.OVERWRITE){var c=n;c.source.fromUser?a=kn(t,e,c.path,c.snap,r,i,u):((0,o.assert)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!wt(c.path),a=Cn(t,e,c.path,c.snap,r,i,s,u))}else if(n.type===Oe.MERGE){var l=n;l.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=bt(n,r);An(e,pt(c))&&(s=kn(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=bt(n,r);An(e,pt(c))||(s=kn(t,s,c,u,i,o,a))})),s}(t,e,l.path,l.children,r,i,u):((0,o.assert)(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered(),a=Pn(t,e,l.path,l.children,r,i,s,u))}else if(n.type===Oe.ACK_USER_WRITE){var h=n;a=h.revert?function(t,e,n,r,i,a){var s;if(null!=mn(r,n))return e;var u=new En(r,e,i),c=e.eventCache.getNode(),l=void 0;if(wt(n)||".priority"===pt(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=vn(r,Xe(e));else{var f=e.serverCache.getNode();(0,o.assert)(f instanceof ie,"serverChildren would be complete if leaf node"),h=gn(r,f)}h=h,l=t.filter.updateFullNode(c,h,a)}else{var d=pt(n),p=_n(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(l=null!=p?t.filter.updateChild(c,d,p,gt(n),u,a):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(c,d,ie.EMPTY_NODE,gt(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=vn(r,Xe(e))).isLeafNode()&&(l=t.filter.updateFullNode(l,s,a))}return s=e.serverCache.isFullyInitialized()||null!=mn(r,dt()),ze(e,l,s,t.filter.filtersNodes())}(t,e,h.path,r,i,u):function(t,e,n,r,i,o,a){if(null!=mn(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(wt(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Cn(t,e,n,u.getNode().getChild(n),i,o,s,a);if(wt(n)){var c=new $e(null);return u.getNode().forEachChild(Ft,(function(t,e){c=c.set(new ft(t),e)})),Pn(t,e,n,c,i,o,s,a)}return e}var l=new $e(null);return r.foreach((function(t,e){var r=bt(n,t);u.isCompleteForPath(r)&&(l=l.set(t,u.getNode().getChild(r)))})),Pn(t,e,n,l,i,o,s,a)}(t,e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==Oe.LISTEN_COMPLETE)throw(0,o.assertionError)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache;return Sn(t,Qe(e,o.getNode(),o.isFullyInitialized()||wt(n),o.isFiltered()),n,r,Tn,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Ye(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ve(Ye(e)))}}(e,a,f),{viewCache:a,changes:f}}(t.processor_,s,e,n,r);return i=t.processor_,a=u.viewCache,(0,o.assert)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,o.assert)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,o.assert)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,Fn(t,u.changes,u.viewCache.eventCache.getNode(),null)}function Fn(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),We(t,i,"child_removed",e,r,n),We(t,i,"child_added",e,r,n),We(t,i,"child_moved",o,r,n),We(t,i,"child_changed",e,r,n),We(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}var Un,qn=function(){this.views=new Map};function jn(t,e,n,r){var i,s,u=e.source.queryId;if(null!==u){var c=t.views.get(u);return(0,o.assert)(null!=c,"SyncTree gave us an op for an invalid query."),Mn(c,e,n,r)}var l=[];try{for(var h=(0,a.__values)(t.views.values()),f=h.next();!f.done;f=h.next())c=f.value,l=l.concat(Mn(c,e,n,r))}catch(t){i={error:t}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}return l}function Vn(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=vn(n,i?r:null),u=!1;s?u=!0:r instanceof ie?(s=gn(n,r),u=!1):(s=ie.EMPTY_NODE,u=!1);var c=Ge(new Ke(s,u,!1),new Ke(r,i,!1));return new xn(e,c)}return a}function Bn(t){var e,n,r=[];try{for(var i=(0,a.__values)(t.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Kn(t,e){var n,r,i=null;try{for(var o=(0,a.__values)(t.views.values()),s=o.next();!s.done;s=o.next()){var u=s.value;i=i||Dn(u,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Hn(t,e){if(e._queryParams.loadsAllData())return zn(t);var n=e._queryIdentifier;return t.views.get(n)}function Wn(t,e){return null!=Hn(t,e)}function Gn(t){return null!=zn(t)}function zn(t){var e,n;try{for(var r=(0,a.__values)(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var Qn=1,Yn=function(t){this.listenProvider_=t,this.syncPointTree_=new $e(null),this.pendingWriteTree_={visibleWrites:Je.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Xn(t,e,n,r,i){return function(t,e,n,r,i){(0,o.assert)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ze(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?nr(t,new Ve({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function $n(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.assert)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=t.allWrites.length-1;i&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&hn(u,r.path)?i=!1:St(r.path,u.path)&&(a=!0)),s--}return!!i&&(a?(function(t){t.visibleWrites=dn(t.allWrites,fn,dt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(r.snap?t.visibleWrites=en(t.visibleWrites,r.path):M(r.children,(function(e){t.visibleWrites=en(t.visibleWrites,bt(r.path,e))})),!0))}(t.pendingWriteTree_,e)){var i=new $e(null);return null!=r.snap?i=i.set(dt(),!0):M(r.children,(function(t){i=i.set(new ft(t),!0)})),nr(t,new qe(r.path,i,n))}return[]}function Jn(t,e,n){return nr(t,new Ve({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Zn(t,e,n,r){var i=e._path,s=t.syncPointTree_.get(i),u=[];if(s&&("default"===e._queryIdentifier||Wn(s,e))){var c=function(t,e,n,r){var i,s,u=e._queryIdentifier,c=[],l=[],h=Gn(t);if("default"===u)try{for(var f=(0,a.__values)(t.views.entries()),d=f.next();!d.done;d=f.next()){var p=(0,a.__read)(d.value,2),v=p[0],g=p[1];l=l.concat(Ln(g,n,r)),On(g)&&(t.views.delete(v),g.query._queryParams.loadsAllData()||c.push(g.query))}}catch(t){i={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}else(g=t.views.get(u))&&(l=l.concat(Ln(g,n,r)),On(g)&&(t.views.delete(u),g.query._queryParams.loadsAllData()||c.push(g.query)));return h&&!Gn(t)&&c.push(new((0,o.assert)(Rn,"Reference.ts has not been loaded"),Rn)(e._repo,e._path)),{removed:c,events:l}}(s,e,n,r);0===s.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var l=c.removed;u=c.events;var h=-1!==l.findIndex((function(t){return t._queryParams.loadsAllData()})),f=t.syncPointTree_.findOnPath(i,(function(t,e){return Gn(e)}));if(h&&!f){var d=t.syncPointTree_.subtree(i);if(!d.isEmpty())for(var p=function(t){return t.fold((function(t,e,n){if(e&&Gn(e))return[zn(e)];var r=[];return e&&(r=Bn(e)),M(n,(function(t,e){r=r.concat(e)})),r}))}(d),v=0;v<p.length;++v){var g=p[v],y=g.query,m=or(t,g);t.listenProvider_.startListening(hr(y),ar(t,y),m.hashFn,m.onComplete)}}!f&&l.length>0&&!r&&(h?t.listenProvider_.stopListening(hr(e),null):l.forEach((function(e){var n=t.queryToTagMap.get(sr(e));t.listenProvider_.stopListening(hr(e),n)}))),function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=sr(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,l)}return u}function tr(t,e,n){var r=e._path,i=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=It(t,r);i=i||Kn(e,n),a=a||Gn(e)}));var s,u=t.syncPointTree_.get(r);u?(a=a||Gn(u),i=i||Kn(u,dt())):(u=new qn,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=i?s=!0:(s=!1,i=ie.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=Kn(e,dt());n&&(i=i.updateImmediateChild(t,n))})));var c=Wn(u,e);if(!c&&!e._queryParams.loadsAllData()){var l=sr(e);(0,o.assert)(!t.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=Qn++;t.queryToTagMap.set(l,h),t.tagToQueryMap.set(h,l)}var f=function(t,e,n,r,i,o){var a=Vn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Jt,(function(t,e){r.push(ge(t,e))})),n.isFullyInitialized()&&r.push(ve(n.getNode())),Fn(t,r,n.getNode(),e)}(a,n)}(u,e,n,ln(t.pendingWriteTree_,r),i,s);if(!c&&!a){var d=Hn(u,e);f=f.concat(function(t,e,n){var r=e._path,i=ar(t,e),a=or(t,n),s=t.listenProvider_.startListening(hr(e),i,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(i)(0,o.assert)(!Gn(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!wt(t)&&e&&Gn(e))return[zn(e).query];var r=[];return e&&(r=r.concat(Bn(e).map((function(t){return t.query})))),M(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];t.listenProvider_.stopListening(hr(h),ar(t,h))}return s}(t,e,d))}return f}function er(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=Kn(n,It(t,e));if(r)return r}));return pn(r,e,i,n,!0)}function nr(t,e){return rr(e,t.syncPointTree_,null,ln(t.pendingWriteTree_,dt()))}function rr(t,e,n,r){if(wt(t.path))return ir(t,e,n,r);var i=e.get(dt());null==n&&null!=i&&(n=Kn(i,dt()));var o=[],a=pt(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=bn(r,a);o=o.concat(rr(s,u,c,l))}return i&&(o=o.concat(jn(i,t,r,n))),o}function ir(t,e,n,r){var i=e.get(dt());null==n&&null!=i&&(n=Kn(i,dt()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=bn(r,e),u=t.operationForChild(e);u&&(o=o.concat(ir(u,i,a,s)))})),i&&(o=o.concat(jn(i,t,r,n))),o}function or(t,e){var n=e.query,r=ar(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||ie.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=ur(t,n);if(r){var i=cr(r),o=i.path,a=i.queryId,s=It(o,e);return lr(t,o,new je(Fe(a),s))}return[]}(t,n._path,r):function(t,e){return nr(t,new je({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return Zn(t,n,null,i)}}}function ar(t,e){var n=sr(e);return t.queryToTagMap.get(n)}function sr(t){return t._path.toString()+"$"+t._queryIdentifier}function ur(t,e){return t.tagToQueryMap.get(e)}function cr(t){var e=t.indexOf("$");return(0,o.assert)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ft(t.substr(0,e))}}function lr(t,e,n){var r=t.syncPointTree_.get(e);return(0,o.assert)(r,"Missing sync point for query tag that we're tracking"),jn(r,n,ln(t.pendingWriteTree_,e),null)}function hr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.assert)(Un,"Reference.ts has not been loaded"),Un)(t._repo,t._path):t}var fr=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),dr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=bt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return er(this.syncTree_,this.path_)},t}(),pr=function(t,e,n){return t&&"object"==typeof t?((0,o.assert)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?vr(t[".sv"],e,n):"object"==typeof t[".sv"]?gr(t[".sv"],e):void(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},vr=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,o.assert)(!1,"Unexpected server value: "+t)}},gr=function(t,e,n){t.hasOwnProperty("increment")||(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&(0,o.assert)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.assert)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},yr=function(t,e,n,r){return _r(e,new dr(n,t),r)},mr=function(t,e,n){return _r(t,new fr(e),n)};function _r(t,e,n){var r,i=t.getPriority().val(),o=pr(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=pr(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new $t(s,ae(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new $t(o))),u.forEachChild(Jt,(function(t,i){var o=_r(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var br=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function wr(t,e){for(var n=e instanceof ft?e:new ft(e),r=t,i=pt(n);null!==i;){var a=(0,o.safeGet)(r.node.children,i)||{children:{},childCount:0};r=new br(i,r,a),i=pt(n=gt(n))}return r}function Ir(t){return t.node.value}function Tr(t,e){t.node.value=e,Ar(t)}function Er(t){return t.node.childCount>0}function Sr(t,e){M(t.node.children,(function(n,r){e(new br(n,t,r))}))}function Cr(t,e,n,r){n&&!r&&e(t),Sr(t,(function(t){Cr(t,e,!0,r)})),n&&r&&e(t)}function kr(t){return new ft(null===t.parent?t.name:kr(t.parent)+"/"+t.name)}function Ar(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===Ir(t)&&!Er(t)}(n),i=(0,o.contains)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Ar(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,Ar(t))}(t.parent,t.name,t)}var Nr=/[\[\].#$\/\u0000-\u001F\u007F]/,Pr=/[\[\].#$\u0000-\u001F\u007F]/,Rr=10485760,xr=function(t){return"string"==typeof t&&0!==t.length&&!Nr.test(t)},Dr=function(t){return"string"==typeof t&&0!==t.length&&!Pr.test(t)},Or=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!A(t)||t&&"object"==typeof t&&(0,o.contains)(t,".sv")},Lr=function(t,e,n,r){r&&void 0===e||Mr((0,o.errorPrefix)(t,"value"),e,n)},Mr=function(t,e,n){var r=n instanceof ft?new Ct(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+At(r));if("function"==typeof e)throw new Error(t+"contains a function "+At(r)+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+At(r));if("string"==typeof e&&e.length>Rr/3&&(0,o.stringLength)(e)>Rr)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+At(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,a=!1;if(M(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!xr(e)))throw new Error(t+" contains an invalid key ("+e+") "+At(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,u;!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.stringLength)(e),kt(t)}(r,e),Mr(t,n,r),u=(s=r).parts_.pop(),s.byteLength_-=(0,o.stringLength)(u),s.parts_.length>0&&(s.byteLength_-=1)})),i&&a)throw new Error(t+' contains ".value" child '+At(r)+" in addition to actual children.")}},Fr=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.errorPrefix)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var a=[];M(e,(function(t,e){var r=new ft(t);if(Mr(i,e,bt(n,r)),".priority"===yt(r)&&!Or(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=mt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!xr(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Tt);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&St(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},Ur=function(t,e,n){if(!n||void 0!==e){if(A(e))throw new Error((0,o.errorPrefix)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Or(e))throw new Error((0,o.errorPrefix)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},qr=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.errorPrefix)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},jr=function(t,e,n,r){if(!(r&&void 0===n||xr(n)))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Vr=function(t,e,n,r){if(!(r&&void 0===n||Dr(n)))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Br=function(t,e){if(".info"===pt(e))throw new Error(t+" failed = Can't modify data under /.info/")},Kr=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!xr(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Dr(t)}(n))throw new Error((0,o.errorPrefix)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Hr=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,o.errorPrefix)(t,e)+"must be a boolean.")},Wr=function(){this.eventLists_=[],this.recursionDepth_=0};function Gr(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||Et(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function zr(t,e,n){Gr(t,n),Yr(t,(function(t){return Et(t,e)}))}function Qr(t,e,n){Gr(t,n),Yr(t,(function(t){return St(t,e)||St(e,t)}))}function Yr(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];i&&(e(i.path)?(Xr(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Xr(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();b&&T("event: "+n.toString()),j(r)}}}var $r="repo_interrupt",Jr=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Wr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Pe(),this.transactionQueueTree_=new br,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function Zr(t){var e=t.infoData_.getNode(new ft(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function ti(t){return(e=(e={timestamp:Zr(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function ei(t,e,n,r,i){t.dataUpdateCount++;var a=new ft(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i)if(r){var u=(0,o.map)(n,(function(t){return ae(t)}));s=function(t,e,n,r){var i=ur(t,r);if(i){var o=cr(i),a=o.path,s=o.queryId,u=It(a,e),c=$e.fromObject(n);return lr(t,a,new Be(Fe(s),u,c))}return[]}(t.serverSyncTree_,a,u,i)}else{var c=ae(n);s=function(t,e,n,r){var i=ur(t,r);if(null!=i){var o=cr(i),a=o.path,s=o.queryId,u=It(a,e);return lr(t,a,new Ve(Fe(s),u,n))}return[]}(t.serverSyncTree_,a,c,i)}else if(r){var l=(0,o.map)(n,(function(t){return ae(t)}));s=function(t,e,n){var r=$e.fromObject(n);return nr(t,new Be({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,l)}else{var h=ae(n);s=Jn(t.serverSyncTree_,a,h)}var f=a;s.length>0&&(f=pi(t,a)),Qr(t.eventQueue_,f,s)}function ni(t,e){ri(t,"connected",e),!1===e&&function(t){li(t,"onDisconnectEvents");var e=ti(t),n=Pe();De(t.onDisconnect_,dt(),(function(r,i){var o=yr(r,i,t.serverSyncTree_,e);Re(n,r,o)}));var r=[];De(n,dt(),(function(e,n){r=r.concat(Jn(t.serverSyncTree_,e,n));var i=_i(t,e);pi(t,i)})),t.onDisconnect_=Pe(),Qr(t.eventQueue_,dt(),r)}(t)}function ri(t,e,n){var r=new ft("/.info/"+e),i=ae(n);t.infoData_.updateSnapshot(r,i);var o=Jn(t.infoSyncTree_,r,i);Qr(t.eventQueue_,r,o)}function ii(t){return t.nextWriteId_++}function oi(t,e,n,r,i){li(t,"set",{path:e.toString(),value:n,priority:r});var o=ti(t),a=ae(n,r),s=er(t.serverSyncTree_,e),u=mr(a,s,o),c=ii(t),l=Xn(t.serverSyncTree_,e,u,c,!0);Gr(t.eventQueue_,l),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||k("set at "+e+" failed: "+n);var a=$n(t.serverSyncTree_,c,!o);Qr(t.eventQueue_,e,a),hi(0,i,n,r)}));var h=_i(t,e);pi(t,h),Qr(t.eventQueue_,h,[])}function ai(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&xe(t.onDisconnect_,e),hi(0,n,r,i)}))}function si(t,e,n,r){var i=ae(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&Re(t.onDisconnect_,e,i),hi(0,r,n,o)}))}function ui(t,e,n){var r;r=".info"===pt(e._path)?Zn(t.infoSyncTree_,e,n):Zn(t.serverSyncTree_,e,n),zr(t.eventQueue_,e._path,r)}function ci(t){t.persistentConnection_&&t.persistentConnection_.interrupt($r)}function li(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),T.apply(void 0,(0,a.__spreadArray)([r],(0,a.__read)(e)))}function hi(t,e,n,r){e&&j((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function fi(t,e,n){return er(t.serverSyncTree_,e,n)||ie.EMPTY_NODE}function di(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||mi(t,e),Ir(e)){var n=gi(t,e);(0,o.assert)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=fi(t,e,r),a=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];(0,o.assert)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=It(e,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=e;t.server_.put(f.toString(),h,(function(r){li(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat($n(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);for(mi(t,wr(t.transactionQueueTree_,e)),di(t,t.transactionQueueTree_),Qr(t.eventQueue_,e,i),s=0;s<o.length;s++)j(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else for(k("transaction at "+f.toString()+" failed: "+r),s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r;pi(t,e)}}),s)}(t,kr(e),n)}else Er(e)&&Sr(e,(function(e){di(t,e)}))}function pi(t,e){var n=vi(t,e),r=kr(n);return function(t,e,n){if(0!==e.length){for(var r=[],i=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c,l=e[s],h=It(n,l.path),f=!1;if((0,o.assert)(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)f=!0,u=l.abortReason,i=i.concat($n(t.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)f=!0,u="maxretry",i=i.concat($n(t.serverSyncTree_,l.currentWriteId,!0));else{var d=fi(t,l.path,a);l.currentInputSnapshot=d;var p=e[s].update(d.val());if(void 0!==p){Mr("transaction failed: Data returned ",p,l.path);var v=ae(p);"object"==typeof p&&null!=p&&(0,o.contains)(p,".priority")||(v=v.updatePriority(d.getPriority()));var g=l.currentWriteId,y=ti(t),m=mr(v,d,y);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=m,l.currentWriteId=ii(t),a.splice(a.indexOf(g),1),i=(i=i.concat(Xn(t.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally))).concat($n(t.serverSyncTree_,g,!0))}else f=!0,u="nodata",i=i.concat($n(t.serverSyncTree_,l.currentWriteId,!0))}Qr(t.eventQueue_,n,i),i=[],f&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===u?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(u),!1,null)}))))},u=0;u<e.length;u++)s(u);for(mi(t,t.transactionQueueTree_),u=0;u<r.length;u++)j(r[u]);di(t,t.transactionQueueTree_)}}(t,gi(t,n),r),r}function vi(t,e){var n,r=t.transactionQueueTree_;for(n=pt(e);null!==n&&void 0===Ir(r);)r=wr(r,n),n=pt(e=gt(e));return r}function gi(t,e){var n=[];return yi(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function yi(t,e,n){var r=Ir(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Sr(e,(function(e){yi(t,e,n)}))}function mi(t,e){var n=Ir(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Tr(e,n.length>0?n:void 0)}Sr(e,(function(e){mi(t,e)}))}function _i(t,e){var n=kr(vi(t,e)),r=wr(t.transactionQueueTree_,e);return function(t,e,n){for(var r=t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){bi(t,e)})),bi(t,r),Cr(r,(function(e){bi(t,e)})),n}function bi(t,e){var n=Ir(e);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?((0,o.assert)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):((0,o.assert)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat($n(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===a?Tr(e,void 0):n.length=a+1,Qr(t.eventQueue_,kr(e),i),s=0;s<r.length;s++)j(r[s])}}var wi=function(t,e){var n=Ii(t),r=n.namespace;"firebase.com"===n.domain&&C(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||C("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&k("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Q(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new ft(n.pathString)}},Ii=function(t){var e="",n="",r="",i="",o="",s=!0,u="https",c=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=(0,a.__values)(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):k("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(l=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=e.length;var p=e.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:o}},Ti=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.stringify)(this.snapshot.exportVal())},t}(),Ei=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Si=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Ci=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.Deferred;return ai(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){Br("OnDisconnect.remove",this._path);var t=new o.Deferred;return si(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){Br("OnDisconnect.set",this._path),Lr("OnDisconnect.set",t,this._path,!1);var e=new o.Deferred;return si(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){Br("OnDisconnect.setWithPriority",this._path),Lr("OnDisconnect.setWithPriority",t,this._path,!1),Ur("OnDisconnect.setWithPriority",e,!1);var n=new o.Deferred;return function(t,e,n,r,i){var o=ae(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&Re(t.onDisconnect_,e,o),hi(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){Br("OnDisconnect.update",this._path),Fr("OnDisconnect.update",t,this._path,!1);var e=new o.Deferred;return function(t,e,n,r){if((0,o.isEmpty)(n))return T("onDisconnect().update() called with empty data.  Don't do anything."),void hi(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&M(n,(function(n,r){var i=ae(r);Re(t.onDisconnect_,bt(e,n),i)})),hi(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),ki=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return wt(this._path)?null:yt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ri(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=ke(this._queryParams),e=O(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return ke(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,o.getModularInstance)(e))instanceof t))return!1;var n=this._repo===e._repo,r=Et(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function Ai(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ni(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ft){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==N)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==P)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Jt){if(null!=e&&!Or(e)||null!=n&&!Or(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.assert)(t.getIndex()instanceof ce||t.getIndex()===le,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Pi(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Ri=function(t){function e(e,n){return t.call(this,e,n,new Ie,!1)||this}return(0,a.__extends)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=_t(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(ki),xi=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new ft(e),r=Li(this.ref,e);return new t(this._node.getChild(n),r,Jt)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,Li(n.ref,r),Jt))}))},t.prototype.hasChild=function(t){var e=new ft(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Di(t,e){return(t=(0,o.getModularInstance)(t))._checkNotDeleted("ref"),void 0!==e?Li(t._root,e):t._root}function Oi(t,e){(t=(0,o.getModularInstance)(t))._checkNotDeleted("refFromURL");var n=wi(e,t._repo.repoInfo_.nodeAdmin);Kr("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||C("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Di(t,n.path.toString())}function Li(t,e){var n;return null===pt((t=(0,o.getModularInstance)(t))._path)?("child","path",!1,(n=e)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Vr("child","path",n,false)):Vr("child","path",e,!1),new Ri(t._repo,bt(t._path,e))}function Mi(t,e){t=(0,o.getModularInstance)(t),Br("push",t._path),Lr("push",e,t._path,!0);var n,r=Zr(t._repo),i=fe(r),a=Li(t,i),s=Li(t,i);return n=null!=e?Ui(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Fi(t){return Br("remove",t._path),Ui(t,null)}function Ui(t,e){t=(0,o.getModularInstance)(t),Br("set",t._path),Lr("set",e,t._path,!1);var n=new o.Deferred;return oi(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function qi(t,e){t=(0,o.getModularInstance)(t),Br("setPriority",t._path),Ur("setPriority",e,!1);var n=new o.Deferred;return oi(t._repo,bt(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function ji(t,e,n){if(Br("setWithPriority",t._path),Lr("setWithPriority",e,t._path,!1),Ur("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.Deferred;return oi(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Vi(t,e){Fr("update",e,t._path,!1);var n=new o.Deferred;return function(t,e,n,r){li(t,"update",{path:e.toString(),value:n});var i=!0,a=ti(t),s={};if(M(n,(function(n,r){i=!1,s[n]=yr(bt(e,n),ae(r),t.serverSyncTree_,a)})),i)T("update() called with empty data.  Don't do anything."),hi(0,r,"ok",void 0);else{var u=ii(t),c=function(t,e,n,r){!function(t,e,n,r){(0,o.assert)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=tn(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=$e.fromObject(n);return nr(t,new Be({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,s,u);Gr(t.eventQueue_,c),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||k("update at "+e+" failed: "+n);var a=$n(t.serverSyncTree_,u,!o),s=a.length>0?pi(t,e):e;Qr(t.eventQueue_,s,a),hi(0,r,n,i)})),M(n,(function(n){var r=_i(t,bt(e,n));pi(t,r)})),Qr(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function Bi(t){return function(t,e){var n=function(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=It(t,n);r=r||Kn(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||Kn(i,dt()):(i=new qn,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Ke(r,!0,!1):null;return Ye(Vn(i,e,ln(t.pendingWriteTree_,e._path),o?a.getNode():ie.EMPTY_NODE,o).viewCache_)}(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=ae(n).withIndex(e._queryParams.getIndex()),i=Jn(t.serverSyncTree_,e._path,r);return zr(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return li(t,"get for query "+(0,o.stringify)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=(0,o.getModularInstance)(t))._repo,t).then((function(e){return new xi(e,new Ri(t._repo,t._path),t._queryParams.getIndex())}))}var Ki=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Ti("value",this,new xi(t.snapshotNode,new Ri(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Ei(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),Hi=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Ei(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.assert)(null!=t.childName,"Child events should have a childName.");var n=Li(new Ri(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Ti(t.type,this,new xi(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function Wi(t,e,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){ui(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Si(n,o||void 0),c="value"===e?new Ki(u):new Hi(e,u);return function(t,e,n){var r;r=".info"===pt(e._path)?tr(t.infoSyncTree_,e,n):tr(t.serverSyncTree_,e,n),zr(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return ui(t._repo,t,c)}}function Gi(t,e,n,r){return Wi(t,"value",e,n,r)}function zi(t,e,n,r){return Wi(t,"child_added",e,n,r)}function Qi(t,e,n,r){return Wi(t,"child_changed",e,n,r)}function Yi(t,e,n,r){return Wi(t,"child_moved",e,n,r)}function Xi(t,e,n,r){return Wi(t,"child_removed",e,n,r)}function $i(t,e,n){var r=null,i=n?new Si(n):null;"value"===e?r=new Ki(i):e&&(r=new Hi(e,i)),ui(t._repo,t,r)}var Ji=function(){},Zi=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Lr("endAt",this._value,t._path,!0);var e=Ee(t._queryParams,this._value,this._key);if(Pi(e),Ni(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ki(t._repo,t._path,e,t._orderByCalled)},e}(Ji);function to(t,e){return jr("endAt","key",e,!0),new Zi(t,e)}var eo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Lr("endBefore",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===Ft?("string"==typeof n&&(n=pe(n)),i=Ee(e,n,r)):i=Ee(e,n,null==r?N:pe(r)),i.endBeforeSet_=!0,i);if(Pi(o),Ni(o),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ki(t._repo,t._path,o,t._orderByCalled)},e}(Ji);function no(t,e){return jr("endBefore","key",e,!0),new eo(t,e)}var ro=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Lr("startAt",this._value,t._path,!0);var e=Te(t._queryParams,this._value,this._key);if(Pi(e),Ni(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ki(t._repo,t._path,e,t._orderByCalled)},e}(Ji);function io(t,e){return void 0===t&&(t=null),jr("startAt","key",e,!0),new ro(t,e)}var oo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Lr("startAfter",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===Ft?("string"==typeof n&&(n=de(n)),i=Te(e,n,r)):i=Te(e,n,null==r?P:de(r)),i.startAfterSet_=!0,i);if(Pi(o),Ni(o),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ki(t._repo,t._path,o,t._orderByCalled)},e}(Ji);function ao(t,e){return jr("startAfter","key",e,!0),new oo(t,e)}var so=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ki(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),t._orderByCalled);var e,n,r},e}(Ji);function uo(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new so(t)}var co=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ki(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),t._orderByCalled);var e,n,r},e}(Ji);function lo(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new co(t)}var ho=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Ai(t,"orderByChild");var e=new ft(this._path);if(wt(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new ce(e),r=Se(t._queryParams,n);return Ni(r),new ki(t._repo,t._path,r,!0)},e}(Ji);function fo(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Vr("orderByChild","path",t,!1),new ho(t)}var po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Ai(t,"orderByKey");var e=Se(t._queryParams,Ft);return Ni(e),new ki(t._repo,t._path,e,!0)},e}(Ji);function vo(){return new po}var go=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Ai(t,"orderByPriority");var e=Se(t._queryParams,Jt);return Ni(e),new ki(t._repo,t._path,e,!0)},e}(Ji);function yo(){return new go}var mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Ai(t,"orderByValue");var e=Se(t._queryParams,le);return Ni(e),new ki(t._repo,t._path,e,!0)},e}(Ji);function _o(){return new mo}var bo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(Lr("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Zi(this._value,this._key)._apply(new ro(this._value,this._key)._apply(t))},e}(Ji);function wo(t,e){return jr("equalTo","key",e,!0),new bo(t,e)}function Io(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=(0,o.getModularInstance)(t);try{for(var u=(0,a.__values)(r),c=u.next();!c.done;c=u.next()){var l=c.value;s=l._apply(s)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s}!function(t){(0,o.assert)(!Rn,"__referenceConstructor has already been defined"),Rn=t}(Ri),function(t){(0,o.assert)(!Un,"__referenceConstructor has already been defined"),Un=t}(Ri);var To={},Eo=!1;function So(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||C("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),T("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=wi(o,i),u=s.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=wi(o,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new H(H.OWNER):new K(t.name,t.options,e);Kr("Invalid Firebase Database URL",s),wt(s.path)||C("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n,r){var i=To[e.name];i||(i={},To[e.name]=i);var o=i[t.toURLString()];return o&&C("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Jr(t,Eo,n,r),i[t.toURLString()]=o,o}(u,t,l,new B(t.name,n));return new Co(h,t)}var Co=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(function(t,e,n){if(t.stats_=Z(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Ae(t.repoInfo_,(function(e,n,r,i){ei(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return ni(t,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.stringify)(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new Dt(t.repoInfo_,e,(function(e,n,r,i){ei(t,e,n,r,i)}),(function(e){ni(t,e)}),(function(e){!function(t,e){M(e,(function(e,n){ri(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}var r,i;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=(r=function(){return new Me(t.stats_,t.server_)},i=t.repoInfo_.toString(),J[i]||(J[i]=r()),J[i]),t.infoData_=new Ne,t.infoSyncTree_=new Yn({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=Jn(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),ri(t,"connected",!1),t.serverSyncTree_=new Yn({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);Qr(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Ri(this._repo,dt())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,e=this.app.name,(n=To[e])&&n[t.key]===t||C("Database "+e+"("+t.repoInfo_+") has already been deleted."),ci(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&C("Cannot call "+t+" on a deleted database.")},t}();function ko(t){(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOffline"),ci(t._repo)}function Ao(t){var e;(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume($r)}var No={".sv":"timestamp"},Po=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Ro(t,e,n){var r;if(t=(0,o.getModularInstance)(t),Br("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new o.Deferred,s=Gi(t,(function(){}));return function(e,n,r,i,s,u){li(e,"transaction on "+n);var c={path:n,update:r,onComplete:function(e,n,r){var i=null;e?a.reject(e):(i=new xi(r,new Ri(t._repo,t._path),Jt),a.resolve(new Po(n,i)))},status:null,order:y(),applyLocally:u,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=fi(e,n,void 0);c.currentInputSnapshot=l;var h=c.update(l.val());if(void 0===h)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Mr("transaction failed: Data returned ",h,c.path),c.status=0;var f=wr(e.transactionQueueTree_,n),d=Ir(f)||[];d.push(c),Tr(f,d);var p=void 0;"object"==typeof h&&null!==h&&(0,o.contains)(h,".priority")?(p=(0,o.safeGet)(h,".priority"),(0,o.assert)(Or(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(er(e.serverSyncTree_,n)||ie.EMPTY_NODE).getPriority().val();var v=ti(e),g=ae(h,p),m=mr(g,l,v);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=m,c.currentWriteId=ii(e);var _=Xn(e.serverSyncTree_,n,m,c.currentWriteId,c.applyLocally);Qr(e.eventQueue_,n,_),di(e,e.transactionQueueTree_)}}(t._repo,t._path,e,0,s,i),a.promise}var xo=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.validateArgCount)("OnDisconnect.set",1,2,arguments.length),(0,o.validateCallback)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.validateArgCount)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,k("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.validateCallback)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),Do=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Oo=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.validateArgCount)("DataSnapshot.child",0,1,arguments.length),e=String(e),Vr("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),Vr("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),(0,o.validateCallback)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),new Mo(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Lo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var a,s=this;(0,o.validateArgCount)("Query.on",2,4,arguments.length),(0,o.validateCallback)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,i),c=function(t,e){n.call(u.context,new Oo(s.database,t),e)};c.userCallback=n,c.context=u.context;var l=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return Gi(this._delegate,c,l),n;case"child_added":return zi(this._delegate,c,l),n;case"child_removed":return Xi(this._delegate,c,l),n;case"child_changed":return Qi(this._delegate,c,l),n;case"child_moved":return Yi(this._delegate,c,l),n;default:throw new Error((0,o.errorPrefix)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.validateArgCount)("Query.off",0,3,arguments.length),qr("Query.off",t,!0),(0,o.validateCallback)("Query.off","callback",e,!0),(0,o.validateContextObject)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,$i(this._delegate,t,r)}else $i(this._delegate,t)},t.prototype.get=function(){var t=this;return Bi(this._delegate).then((function(e){return new Oo(t.database,e)}))},t.prototype.once=function(e,n,r,i){var a=this;(0,o.validateArgCount)("Query.once",1,4,arguments.length),(0,o.validateCallback)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=new o.Deferred,c=function(t,e){var r=new Oo(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":Gi(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":zi(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":Xi(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":Qi(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":Yi(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error((0,o.errorPrefix)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return(0,o.validateArgCount)("Query.limitToFirst",1,1,arguments.length),new t(this.database,Io(this._delegate,uo(e)))},t.prototype.limitToLast=function(e){return(0,o.validateArgCount)("Query.limitToLast",1,1,arguments.length),new t(this.database,Io(this._delegate,lo(e)))},t.prototype.orderByChild=function(e){return(0,o.validateArgCount)("Query.orderByChild",1,1,arguments.length),new t(this.database,Io(this._delegate,fo(e)))},t.prototype.orderByKey=function(){return(0,o.validateArgCount)("Query.orderByKey",0,0,arguments.length),new t(this.database,Io(this._delegate,vo()))},t.prototype.orderByPriority=function(){return(0,o.validateArgCount)("Query.orderByPriority",0,0,arguments.length),new t(this.database,Io(this._delegate,yo()))},t.prototype.orderByValue=function(){return(0,o.validateArgCount)("Query.orderByValue",0,0,arguments.length),new t(this.database,Io(this._delegate,_o()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAt",0,2,arguments.length),new t(this.database,Io(this._delegate,io(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAfter",0,2,arguments.length),new t(this.database,Io(this._delegate,ao(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endAt",0,2,arguments.length),new t(this.database,Io(this._delegate,to(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endBefore",0,2,arguments.length),new t(this.database,Io(this._delegate,no(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.validateArgCount)("Query.equalTo",1,2,arguments.length),new t(this.database,Io(this._delegate,wo(e,n)))},t.prototype.toString=function(){return(0,o.validateArgCount)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.validateArgCount)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.validateCallback)(t,"cancel",r.cancel,!0),r.context=n,(0,o.validateContextObject)(t,"context",r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error((0,o.errorPrefix)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Mo(this.database,new Ri(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Mo=function(t){function e(e,n){var r=t.call(this,e,new ki(n._repo,n._path,new Ie,!1))||this;return r.database=e,r._delegate=n,r}return(0,a.__extends)(e,t),e.prototype.getKey=function(){return(0,o.validateArgCount)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.validateArgCount)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,Li(this._delegate,t))},e.prototype.getParent=function(){(0,o.validateArgCount)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.validateArgCount)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.validateArgCount)("Reference.set",1,2,arguments.length),(0,o.validateCallback)("Reference.set","onComplete",e,!0);var n=Ui(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.validateArgCount)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,k("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Br("Reference.update",this._delegate._path),(0,o.validateCallback)("Reference.update","onComplete",e,!0);var i=Vi(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("Reference.setWithPriority","onComplete",n,!0);var r=ji(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.validateArgCount)("Reference.remove",0,1,arguments.length),(0,o.validateCallback)("Reference.remove","onComplete",t,!0);var e=Fi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.validateArgCount)("Reference.transaction",1,3,arguments.length),(0,o.validateCallback)("Reference.transaction","transactionUpdate",t,!1),(0,o.validateCallback)("Reference.transaction","onComplete",e,!0),Hr("Reference.transaction","applyLocally",n,!0);var i=Ro(this._delegate,t,{applyLocally:n}).then((function(t){return new Do(t.committed,new Oo(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.validateArgCount)("Reference.setPriority",1,2,arguments.length),(0,o.validateCallback)("Reference.setPriority","onComplete",e,!0);var n=qi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.validateArgCount)("Reference.push",0,2,arguments.length),(0,o.validateCallback)("Reference.push","onComplete",n,!0);var i=Mi(this._delegate,t),a=i.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return Br("Reference.onDisconnect",this._delegate._path),new xo(new Ci(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Lo),Fo=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={}),(t=(0,o.getModularInstance)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&C("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&C('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new H(H.OWNER);else if(r.mockUserToken){var s=(0,o.createMockUserToken)(r.mockUserToken,t.app.options.projectId);a=new H(s)}!function(t,e,n,r){t.repoInfo_=new Q(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(i,e,n,a)}(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,o.validateArgCount)("database.ref",0,1,arguments.length),t instanceof Mo){var e=Oi(this._delegate,t.toString());return new Mo(this,e)}return e=Di(this._delegate,t),new Mo(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.validateArgCount)(e,1,1,arguments.length);var n=Oi(this._delegate,t);return new Mo(this,n)},t.prototype.goOffline=function(){return(0,o.validateArgCount)("database.goOffline",0,0,arguments.length),ko(this._delegate)},t.prototype.goOnline=function(){return(0,o.validateArgCount)("database.goOnline",0,0,arguments.length),Ao(this._delegate)},t.ServerValue={TIMESTAMP:No,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}(),Uo=Object.freeze({__proto__:null,forceLongPolling:function(){at.forceDisallow(),rt.forceAllow()},forceWebSockets:function(){rt.forceDisallow()},isWebSocketsAvailable:function(){return at.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Le(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);M(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n;t.stats_.incrementCounter(e),n=e,t.statsReporter_.statsToReport_[n]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,a=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;c(r);var l=new i.Provider("auth-internal",new i.ComponentContainer("database-standalone"));return l.setComponent(new i.Component("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Fo(So(e,l,void 0,n,u),e),namespace:a}}}),qo=Dt;Dt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Dt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var jo=ut,Vo=Q,Bo=Object.freeze({__proto__:null,DataConnection:qo,RealTimeConnection:jo,hijackHash:function(t){var e=Dt.prototype.put;return Dt.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Dt.prototype.put=e}},ConnectionTarget:Vo,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){Eo=t}(t)}}),Ko=Fo.ServerValue;!function(e){c(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.Component("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Fo(So(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Mo,Query:Lo,Database:Fo,DataSnapshot:Oo,enableLogging:I,INTERNAL:Uo,ServerValue:Ko,TEST_ACCESS:Bo}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.10.5"),(0,o.isNodeSdk)()&&(t.exports=n)}(r.default)},936:(t,e,n)=>{"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(e),n.d(e,{LogLevel:()=>o,Logger:()=>h,setLogLevel:()=>f,setUserLogHandler:()=>d});var o,a=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){a.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++)n(i[r])}},765:(t,e,n)=>{"use strict";n.r(e),n.d(e,{CONSTANTS:()=>i,Deferred:()=>d,ErrorFactory:()=>R,FirebaseError:()=>P,MAX_VALUE_MILLIS:()=>at,RANDOM_FACTOR:()=>st,Sha1:()=>Q,areCookiesEnabled:()=>A,assert:()=>o,assertionError:()=>a,async:()=>$,base64:()=>u,base64Decode:()=>l,base64Encode:()=>c,calculateBackoffMillis:()=>ut,contains:()=>V,createMockUserToken:()=>p,createSubscribe:()=>Y,decode:()=>M,deepCopy:()=>h,deepExtend:()=>f,errorPrefix:()=>tt,extractQuerystring:()=>z,getGlobal:()=>N,getModularInstance:()=>lt,getUA:()=>v,isAdmin:()=>j,isBrowser:()=>m,isBrowserExtension:()=>_,isElectron:()=>w,isEmpty:()=>K,isIE:()=>I,isIndexedDBAvailable:()=>C,isMobileCordova:()=>g,isNode:()=>y,isNodeSdk:()=>E,isReactNative:()=>b,isSafari:()=>S,isUWP:()=>T,isValidFormat:()=>q,isValidTimestamp:()=>F,issuedAtTime:()=>U,jsonEval:()=>O,map:()=>H,ordinal:()=>ct,querystring:()=>W,querystringDecode:()=>G,safeGet:()=>B,stringLength:()=>ot,stringToByteArray:()=>it,stringify:()=>L,validateArgCount:()=>Z,validateCallback:()=>nt,validateContextObject:()=>rt,validateIndexedDBOpenable:()=>k,validateNamespace:()=>et});var r=n(163),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var e=s(t);return u.encodeByteArray(e,!0)},l=function(t){try{return u.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(t){return f(void 0,t)}function f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=f(t[n],e[n]));return t}var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=(0,r.__assign)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[u.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),u.encodeString(JSON.stringify(a),!1),""].join(".")}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function g(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function y(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function m(){return"object"==typeof self&&self.self===self}function _(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function b(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function w(){return v().indexOf("Electron/")>=0}function I(){var t=v();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function T(){return v().indexOf("MSAppHost/")>=0}function E(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function S(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){return"indexedDB"in self&&null!=indexedDB}function k(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function A(){return!(!navigator||!navigator.cookieEnabled)}function N(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}var P=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,R.prototype.create),o}return(0,r.__extends)(e,t),e}(Error),R=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?x(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new P(i,s,r);return u},t}();function x(t,e){return t.replace(D,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var D=/\{\$([^}]+)}/g;function O(t){return JSON.parse(t)}function L(t){return JSON.stringify(t)}var M=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=O(l(o[0])||""),n=O(l(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},F=function(t){var e=M(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},U=function(t){var e=M(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},q=function(t){var e=M(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},j=function(t){var e=M(t).claims;return"object"==typeof e&&!0===e.admin};function V(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function K(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function H(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function W(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function G(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[0],i=n[1];e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function z(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var Q=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function Y(t,e){var n=new X(t,e);return n.subscribe.bind(n)}var X=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=J),void 0===r.error&&(r.error=J),void 0===r.complete&&(r.complete=J);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function $(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function J(){}var Z=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function tt(t,e){return t+" failed: "+e+" argument "}function et(t,e,n){if((!n||e)&&"string"!=typeof e)throw new Error(tt(t,"namespace")+"must be a valid firebase namespace.")}function nt(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(tt(t,e)+"must be a valid function.")}function rt(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(tt(t,e)+"must be a valid context object.")}var it=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},ot=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},at=144e5,st=.5;function ut(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(st*r*(Math.random()-.5)*2);return Math.min(at,r+i)}function ct(t){return Number.isFinite(t)?t+function(t){var e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";var n=t%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(t):""+t}function lt(t){return t&&t._delegate?t._delegate:t}},59:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r.default});var r=n(475);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,n){if(n){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(n=n(o=r[t=t[t.length-1]]))!=o&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Ra(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Ra(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Ra(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,l=null;function h(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function y(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++_)}var m="closure_uid_"+(1e9*Math.random()>>>0),_=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function k(t,e,n){this.code=P+t,this.message=e||R[t]||"",this.a=n||null}function A(t){var e=t&&t.code;return e?new k(e.substring(P.length),t.message,t.serverResponse):null}S(k,Error),k.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},k.prototype.toJSON=function(){return this.w()};var N,P="auth/",R={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},x={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function D(t){for(var e in x)if(x[e].id===t)return{firebaseEndpoint:(t=x[e]).Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function O(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function M(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");L.call(this,n+t[r])}function F(t,e){throw new M("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function U(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function q(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function j(){this.b=this.a=null}N=D("__EID__")?"__EID__":void 0,S(L,Error),L.prototype.name="CustomError",S(M,L),M.prototype.name="AssertionError",U.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var V=new U((function(){return new K}),(function(t){t.reset()}));function B(){var t=be,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function K(){this.next=this.b=this.a=null}j.prototype.add=function(t,e){var n=V.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},K.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},K.prototype.reset=function(){this.next=this.b=this.a=null};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},G=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},z=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},Q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Y(t,e){return 0<=H(t,e)}function X(t,e){var n;return(n=0<=(e=H(t,e)))&&Array.prototype.splice.call(t,e,1),n}function $(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length}))}function J(t){return Array.prototype.concat.apply([],arguments)}function Z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,rt=/</g,it=/>/g,ot=/"/g,at=/'/g,st=/\x00/g,ut=/[\x00&<>"']/;function ct(t,e){return-1!=t.indexOf(e)}function lt(t,e){return t<e?-1:t>e?1:0}t:{var ht=u.navigator;if(ht){var ft=ht.userAgent;if(ft){tt=ft;break t}}tt=""}function dt(t){return ct(tt,t)}function pt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function gt(t){var e,n={};for(e in t)n[e]=t[e];return n}var yt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<yt.length;o++)n=yt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _t(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;F("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function bt(t,e){this.a=t===Et&&e||"",this.b=Tt}function wt(t){return t instanceof bt&&t.constructor===bt&&t.b===Tt?t.a:(F("expected object of type Const, got '"+t+"'"),"type_error:Const")}bt.prototype.ta=!0,bt.prototype.sa=function(){return this.a},bt.prototype.toString=function(){return"Const{"+this.a+"}"};var It,Tt={},Et={};function St(){if(void 0===It){var t=null,e=u.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){u.console&&u.console.error(t.message)}It=t}else It=t}return It}function Ct(t,e){this.a=e===Rt?t:""}function kt(t){return t instanceof Ct&&t.constructor===Ct?t.a:(F("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function At(t,e){var n=wt(t);if(!Pt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=St();return new Ct(t=e?e.createScriptURL(t):t,Rt)}(t=n.replace(Nt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof bt?wt(t):encodeURIComponent(String(t))})))}Ct.prototype.ta=!0,Ct.prototype.sa=function(){return this.a.toString()},Ct.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nt=/%{(\w+)}/g,Pt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Rt={};function xt(t,e){this.a=e===qt?t:""}function Dt(t){return t instanceof xt&&t.constructor===xt?t.a:(F("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}xt.prototype.ta=!0,xt.prototype.sa=function(){return this.a.toString()},xt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ot=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Mt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof xt)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),Mt.test(t))t=new xt(t,qt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&Ot.test(e[1])?new xt(t,qt):null}return t}function Ut(t){return t instanceof xt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),Mt.test(t)||(t="about:invalid#zClosurez"),new xt(t,qt))}var qt={},jt=new xt("about:invalid#zClosurez",qt);function Vt(t,e,n){this.a=n===Bt?t:""}Vt.prototype.ta=!0,Vt.prototype.sa=function(){return this.a.toString()},Vt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bt={};function Kt(t,e,n,r){return t=t instanceof xt?t:Ut(t),e=e||u,n=n instanceof bt?wt(n):n||"",e.open(Dt(t),n,r,void 0)}function Ht(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Wt(t){return ut.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(rt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(it,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ot,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(at,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(st,"&#0;"))),t}function Gt(t){return Gt[" "](t),t}Gt[" "]=f;var zt,Qt,Yt=dt("Opera"),Xt=dt("Trident")||dt("MSIE"),$t=dt("Edge"),Jt=$t||Xt,Zt=dt("Gecko")&&!(ct(tt.toLowerCase(),"webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),te=ct(tt.toLowerCase(),"webkit")&&!dt("Edge");function ee(){var t=u.document;return t?t.documentMode:void 0}t:{var ne="",re=(Qt=tt,Zt?/rv:([^\);]+)(\)|;)/.exec(Qt):$t?/Edge\/([\d\.]+)/.exec(Qt):Xt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Qt):te?/WebKit\/(\S+)/.exec(Qt):Yt?/(?:Version)[ \/]?(\S+)/.exec(Qt):void 0);if(re&&(ne=re?re[1]:""),Xt){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){zt=String(ie);break t}}zt=ne}var oe,ae={};function se(t){return function(t,e){var n=ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=et(String(zt)).split("."),r=et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=lt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||lt(0==a[2].length,0==s[2].length)||lt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}u.document&&Xt?oe=ee()||parseInt(zt,10)||void 0:oe=void 0;var ue=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Qt){}var ce=!Xt||9<=Number(ue);function le(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function he(t,e){pt(e,(function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:pe.hasOwnProperty(n)?t.setAttribute(pe[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,de,pe={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ve(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!p(o)||g(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(g(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){a="function"==typeof o.item;break t}}a=!1}W(a?Z(o):o,r)}}}function ge(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function ye(t){u.setTimeout((function(){throw t}),0)}function me(t,e){de||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);de=function(){t.then(we)}}else de=function(){var t=we;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!dt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(fe||(fe=function(){var t=u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(t=function(){var t=ge(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=I((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!dt("Trident")&&!dt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),fe(t)):u.setImmediate(t)}}(),_e||(de(),_e=!0),be.add(t,e)}var _e=!1,be=new j;function we(){for(var t;t=B();){try{t.a.call(t.b)}catch(t){ye(t)}q(V,t)}_e=!1}function Ie(t,e){if(this.a=Te,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Me(n,Ee,t)}),(function(t){if(!(t instanceof Ke))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Me(n,Se,t)}))}catch(t){Me(this,Se,t)}}var Te=0,Ee=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var ke=new U((function(){return new Ce}),(function(t){t.reset()}));function Ae(t,e,n){var r=ke.get();return r.g=t,r.b=e,r.f=n,r}function Ne(t){if(t instanceof Ie)return t;var e=new Ie(f);return Me(e,Ee,t),e}function Pe(t){return new Ie((function(e,n){n(t)}))}function Re(t,e,n){Fe(t,e,n,null)||me(T(e,t))}function xe(t){return new Ie((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Re(t[o],T(i,o,!0),T(i,o,!1));else e(r)}))}function De(t,e){if(t.a==Te)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Te&&1==r?De(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):qe(n),je(n,i,Se,e)))}t.c=null}else Me(t,Se,e)}function Oe(t,e){t.b||t.a!=Ee&&t.a!=Se||Ue(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,r){var i=Ae(null,null,null);return i.a=new Ie((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ke?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,Oe(t,i),i.a}function Me(t,e,n){t.a==Te&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Fe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Ue(t),e!=Se||n instanceof Ke||function(t,e){t.g=!0,me((function(){t.g&&Be.call(null,e)}))}(t,n)))}function Fe(t,e,n,r){if(t instanceof Ie)return Oe(t,Ae(e||f,n||null,r)),!0;if(O(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Ue(t){t.h||(t.h=!0,me(t.gc,t))}function qe(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function je(t,e,n,r){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ve(e,n,r);else try{e.c?e.g.call(e.f):Ve(e,n,r)}catch(t){Be.call(null,t)}q(ke,e)}function Ve(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ie.prototype.then=function(t,e,n){return Le(this,v(t)?t:null,v(e)?e:null,n)},Ie.prototype.$goog_Thenable=!0,(t=Ie.prototype).oa=function(t,e){return(t=Ae(t,t,e)).c=!0,Oe(this,t),this},t.o=function(t,e){return Le(this,null,t,e)},t.cancel=function(t){if(this.a==Te){var e=new Ke(t);me((function(){De(this,e)}),this)}},t.$c=function(t){this.a=Te,Me(this,Ee,t)},t.ad=function(t){this.a=Te,Me(this,Se,t)},t.gc=function(){for(var t;t=qe(this);)je(this,t,this.a,this.i);this.h=!1};var Be=ye;function Ke(t){L.call(this,t)}function He(){0!=We&&(Ge[y(this)]=this),this.ya=this.ya,this.pa=this.pa}S(Ke,L),Ke.prototype.name="cancel";var We=0,Ge={};function ze(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=We)){var e=y(t);if(0!=We&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ge[e]}}He.prototype.ya=!1,He.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Qe=Object.freeze||function(t){return t},Ye=!Xt||9<=Number(ue),Xe=Xt&&!se("9"),$e=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(t){}return t}();function Je(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Ze(t,e){if(Je.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Zt){t:{try{Gt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Je.prototype.preventDefault=function(){this.defaultPrevented=!0},S(Ze,Je);var tn=Qe({2:"touch",3:"pen",4:"mouse"});Ze.prototype.preventDefault=function(){Ze.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Ze.prototype.g=function(){return this.a};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++nn,this.wa=this.Qa=!1}function on(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function an(t){this.src=t,this.a={},this.b=0}function sn(t,e){var n=e.type;n in t.a&&X(t.a[n],e)&&(on(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function un(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==r)return i}return-1}an.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=un(t,e,r,i);return-1<a?(e=t[a],n||(e.Qa=!1)):((e=new rn(e,this.src,o,!!r,i)).Qa=n,t.push(e)),e};var cn="closure_lm_"+(1e6*Math.random()|0),ln={};function hn(t,e,n,r,i){if(r&&r.once)dn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)hn(t,e[o],n,r,i);else n=In(n),t&&t[en]?En(t,e,n,g(r)?!!r.capture:!!r,i):fn(t,e,n,!1,r,i)}function fn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=g(i)?!!i.capture:!!i,s=bn(t);if(s||(t[cn]=s=new an(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=_n,e=Ye?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)$e||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else n=In(n),t&&t[en]?Sn(t,e,n,g(r)?!!r.capture:!!r,i):fn(t,e,n,!0,r,i)}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=In(n),t&&t[en]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=un(o=t.a[e],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=bn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=un(e,n,r,i)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.wa){var e=t.src;if(e&&e[en])sn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=bn(e))?(sn(n,t),0==n.b&&(n.src=null,e[cn]=null)):on(t)}}}function gn(t){return t in ln?ln[t]:ln[t]="on"+t}function yn(t,e,n,r){var i=!0;if((t=bn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=mn(o,r),i=i&&!1!==o)}return i}function mn(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&vn(t),n.call(r,e)}function _n(t,e){if(t.wa)return!0;if(!Ye){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Ze(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=yn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=yn(r[i],t,!1,e),n=n&&o}return n}return mn(t,new Ze(e,this))}function bn(t){return(t=t[cn])instanceof an?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(t){return v(t)?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function Tn(){He.call(this),this.v=new an(this),this.bc=this,this.hb=null}function En(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Sn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Cn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&sn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function kn(t,e,n){if(v(t))n&&(t=I(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=I(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function An(t){var e=null;return new Ie((function(n,r){-1==(e=kn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw u.clearTimeout(e),t}))}function Nn(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Pn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Rn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Rn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function xn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Dn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Dn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(Tn,He),Tn.prototype[en]=!0,Tn.prototype.addEventListener=function(t,e,n,r){hn(this,t,e,n,r)},Tn.prototype.removeEventListener=function(t,e,n,r){pn(this,t,e,n,r)},Tn.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"==typeof t)t=new Je(t,n);else if(t instanceof Je)t.target=t.target||n;else{var i=t;mt(t=new Je(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=Cn(a,r,!0,t)&&i}if(i=Cn(a=t.b=n,r,!0,t)&&i,i=Cn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Cn(a=t.b=e[o],r,!1,t)&&i;return i},Tn.prototype.Da=function(){if(Tn.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)on(n[r]);delete e.a[t],e.b--}}this.hb=null},(t=Rn.prototype).X=function(){xn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return xn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Dn(this.b,t)?this.b[t]:e},t.set=function(t,e){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var On=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Mn(this,t.c),this.l=t.l,this.a=t.a,Fn(this,t.g),this.f=t.f,Un(this,rr(t.b)),this.h=t.h):t&&(n=String(t).match(On))?(this.i=!!e,Mn(this,n[1]||"",!0),this.l=Kn(n[2]||""),this.a=Kn(n[3]||"",!0),Fn(this,n[4]),this.f=Kn(n[5]||"",!0),Un(this,n[6]||"",!0),this.h=Kn(n[7]||"")):(this.i=!!e,this.b=new $n(null,this.i))}function Mn(t,e,n){t.c=n?Kn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Un(t,e,n){e instanceof $n?(t.b=e,function(t,e){e&&!t.f&&(Jn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(tr(this,e),nr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Hn(e,Yn)),t.b=new $n(e,t.i))}function qn(t,e,n){t.b.set(e,n)}function jn(t,e){return t.b.get(e)}function Vn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function Bn(t,e,n,r){var i=new Ln(null,void 0);return t&&Mn(i,t),e&&(i.a=e),n&&Fn(i,n),r&&(i.f=r),i}function Kn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Wn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Wn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Hn(e,Gn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Hn(e,Gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Hn(n,"/"==n.charAt(0)?Qn:zn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Hn(n,Xn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Mn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Fn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ct(i,"./")||ct(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?Un(e,rr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Gn=/[#\/\?@]/g,zn=/[#\?:]/g,Qn=/[#\?]/g,Yn=/[#\?@]/g,Xn=/#/g;function $n(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Jn(t){t.a||(t.a=new Rn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Zn(t){var e=Pn(t);if(void 0===e)throw Error("Keys are undefined");var n=new $n(null,void 0);t=Nn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?nr(n,i,o):n.add(i,o)}return n}function tr(t,e){Jn(t),e=ir(t,e),Dn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Dn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&xn(t)))}function er(t,e){return Jn(t),e=ir(t,e),Dn(t.a.b,e)}function nr(t,e,n){tr(t,e),0<n.length&&(t.c=null,t.a.set(ir(t,e),Z(n)),t.b+=n.length)}function rr(t){var e=new $n;return e.c=t.c,t.a&&(e.a=new Rn(t.a),e.b=t.b),e}function ir(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function or(t){var e=[];return sr(new ar,t,e),e.join("")}function ar(){}function sr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),sr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),lr(r,n),n.push(":"),sr(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":lr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=$n.prototype).add=function(t,e){Jn(this),this.c=null,t=ir(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Jn(this),this.a.forEach((function(n,r){W(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Jn(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.X=function(t){Jn(this);var e=[];if("string"==typeof t)er(this,t)&&(e=J(e,this.a.get(ir(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=J(e,t[n])}return e},t.set=function(t,e){return Jn(this),this.c=null,er(this,t=ir(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ur={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},cr=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function lr(t,e){e.push('"',t.replace(cr,(function(t){var e=ur[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ur[t]=e),e})),'"')}function hr(){var t=Rr();return Xt&&!!ue&&11==ue||/Edge\/\d+/.test(t)}function fr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function dr(t,e){e=e||u.window;var n="about:blank";t&&(n=Dt(Ft(t)||jt)),e.location.href=n}function pr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<pr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function vr(t){return!!((t=(t||Rr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function gr(t){t=t||u.window;try{t.close()}catch(t){}}function yr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Rr().toLowerCase(),r&&(e.target=r,ct(n,"crios/")&&(e.target="_blank")),Ar(Rr())==Cr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof xt?n:Ft(void 0!==n.href?n.href:String(n))||jt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((dt("iPhone")&&!dt("iPod")&&!dt("iPad")||dt("iPad")||dt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(_t(a=ge(document,"A"),"HTMLAnchorElement"),e=e instanceof xt?e:Ut(e),a.href=Dt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Kt("",r,n,a),t=Dt(e),a&&(Jt&&ct(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Wt(t)+'">',t=new Vt(t=(r=St())?r.createHTML(t):t,null,Bt),r=a.document)&&(r.write(function(t){return t instanceof Vt&&t.constructor===Vt?t.a:(F("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Kt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var mr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_r=/^[^@]+@[^@]+$/;function br(){var t=null;return new Ie((function(e){"complete"==u.document.readyState?e():(t=function(){e()},dn(window,"load",t))})).o((function(e){throw pn(window,"load",t),e}))}function wr(t){return t=t||Rr(),!("file:"!==Mr()&&"ionic:"!==Mr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ir(){var t=u.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Tr(){return void 0!==u.WorkerGlobalScope&&"function"==typeof u.importScripts}function Er(){return r.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.default.INTERNAL.hasOwnProperty("node")?"Node":Tr()?"Worker":"Browser"}function Sr(){var t=Er();return"ReactNative"===t||"Node"===t}var Cr="Firefox",kr="Chrome";function Ar(t){var e=t.toLowerCase();return ct(e,"opera/")||ct(e,"opr/")||ct(e,"opios/")?"Opera":ct(e,"iemobile")?"IEMobile":ct(e,"msie")||ct(e,"trident/")?"IE":ct(e,"edge/")?"Edge":ct(e,"firefox/")?Cr:ct(e,"silk/")?"Silk":ct(e,"blackberry")?"Blackberry":ct(e,"webos")?"Webos":!ct(e,"safari/")||ct(e,"chrome/")||ct(e,"crios/")||ct(e,"android")?!ct(e,"chrome/")&&!ct(e,"crios/")||ct(e,"edge/")?ct(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":kr:"Safari"}var Nr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Pr(t,e){e=e||[];var n,r=[],i={};for(n in Nr)i[Nr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Er())?r=Ar(i=Rr()):"Worker"===r&&(r=Ar(i=Rr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Rr(){return u.navigator&&u.navigator.userAgent||""}function xr(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Dr(){try{var t=u.localStorage,e=Vr();if(t)return t.setItem(e,"1"),t.removeItem(e),!hr()||!!u.indexedDB}catch(t){return Tr()&&!!u.indexedDB}return!1}function Or(){return(Lr()||"chrome-extension:"===Mr()||wr())&&!Sr()&&Dr()&&!Tr()}function Lr(){return"http:"===Mr()||"https:"===Mr()}function Mr(){return u.location&&u.location.protocol||null}function Fr(t){return!vr(t=t||Rr())&&Ar(t)!=Cr}function Ur(t){return void 0===t?null:or(t)}function qr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function jr(t){if(null!==t)return JSON.parse(t)}function Vr(t){return t||Math.floor(1e9*Math.random()).toString()}function Br(t){return"Safari"!=Ar(t=t||Rr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Kr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Hr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Rr(),e=Er(),this.b=vr(t)||"ReactNative"===e}function Wr(){var t=u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Gr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zr(){return!(!xr("fireauth.oauthhelper",u)&&!xr("fireauth.iframe",u))}Hr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!=typeof t.onLine||!Lr()&&"chrome-extension:"!==Mr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Qr,Yr={};function Xr(t){Yr[t]||(Yr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var $r={};Object.defineProperty($r,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty($r,"abcd",{configurable:!0,enumerable:!0,value:2}),Qr=2==$r.abcd}catch(Qt){Qr=!1}function Jr(t,e,n){Qr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Zr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Jr(t,n,e[n])}function ti(t){var e={};return Zr(e,t),e}function ei(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Jr(e,n,ei(t[n]));return e}function ni(t){var e=t&&(t[si]?"phone":null);if(!(e&&t&&t[ai]))throw new k("internal-error","Internal assert: invalid MultiFactorInfo object");Jr(this,"uid",t[ai]),Jr(this,"displayName",t[ii]||null);var n=null;t[oi]&&(n=new Date(t[oi]).toUTCString()),Jr(this,"enrollmentTime",n),Jr(this,"factorId",e)}function ri(t){try{var e=new ui(t)}catch(t){e=null}return e}ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ii="displayName",oi="enrolledAt",ai="mfaEnrollmentId",si="phoneInfo";function ui(t){ni.call(this,t),Jr(this,"phoneNumber",t[si])}function ci(t){var e={},n=t[di],r=t[vi],i=t[gi];if(t=ri(t[pi]),!i||i!=hi&&i!=fi&&!n||i==fi&&!r||i==li&&!t)throw Error("Invalid checkActionCode response!");i==fi?(e[mi]=n||null,e[bi]=n||null,e[yi]=r):(e[mi]=r||null,e[bi]=r||null,e[yi]=n||null),e[_i]=t||null,Jr(this,Ii,i),Jr(this,wi,ei(e))}S(ui,ni),ui.prototype.w=function(){var t=ui.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var li="REVERT_SECOND_FACTOR_ADDITION",hi="EMAIL_SIGNIN",fi="VERIFY_AND_CHANGE_EMAIL",di="email",pi="mfaInfo",vi="newEmail",gi="requestType",yi="email",mi="fromEmail",_i="multiFactorInfo",bi="previousEmail",wi="data",Ii="operation";function Ti(t){var e=jn(t=Vn(t),Ei)||null,n=jn(t,Si)||null,r=jn(t,Ai)||null;if(r=r&&Pi[r]||null,!e||!n||!r)throw new k("argument-error",Ei+", "+Si+"and "+Ai+" are required in a valid action code URL.");Zr(this,{apiKey:e,operation:r,code:n,continueUrl:jn(t,Ci)||null,languageCode:jn(t,ki)||null,tenantId:jn(t,Ni)||null})}var Ei="apiKey",Si="oobCode",Ci="continueUrl",ki="languageCode",Ai="mode",Ni="tenantId",Pi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:li,signIn:hi,verifyAndChangeEmail:fi,verifyEmail:"VERIFY_EMAIL"};function Ri(t){try{return new Ti(t)}catch(t){return null}}function xi(t){var e=t[Fi];if(void 0===e)throw new k("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new k("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Di];if(n&&"object"==typeof n){e=n[ji];var r=n[Ui];if(n=n[qi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new k("argument-error",Ui+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new k("argument-error",qi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new k("argument-error",ji+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new k("missing-android-pkg-name")}}else if(void 0!==n)throw new k("argument-error",Di+" property must be a non null object when specified.");if(this.f=null,(e=t[Mi])&&"object"==typeof e){if("string"==typeof(e=e[Vi])&&e.length)this.f=e;else if(void 0!==e)throw new k("argument-error",Vi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new k("argument-error",Mi+" property must be a non null object when specified.");if(void 0!==(e=t[Li])&&"boolean"!=typeof e)throw new k("argument-error",Li+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Oi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new k("argument-error",Oi+" property must be a non empty string when specified.");this.i=t||null}var Di="android",Oi="dynamicLinkDomain",Li="handleCodeInApp",Mi="iOS",Fi="url",Ui="installApp",qi="minimumVersion",ji="packageName",Vi="bundleId";function Bi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ki=null;function Hi(t){var e=Gi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Wi(t){try{return new Hi(t)}catch(t){return null}}function Gi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=function(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ki[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ki){Ki={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ki[o]&&(Ki[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(t){}return null}Hi.prototype.T=function(){return this.f},Hi.prototype.l=function(){return this.c},Hi.prototype.toString=function(){return this.h};var zi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Qi=["client_id","response_type","scope","redirect_uri","state"],Yi={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:Qi},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:Qi},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:Qi},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:zi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Xi(t){for(var e in Yi)if(Yi[e].fa==t)return Yi[e];return null}function $i(t){var e={};e["facebook.com"]=no,e["google.com"]=io,e["github.com"]=ro,e["twitter.com"]=oo;var n=t&&t[Zi];try{if(n)return e[n]?new e[n](t):new eo(t);if(void 0!==t[Ji])return new to(t)}catch(t){}return null}var Ji="idToken",Zi="providerId";function to(t){var e=t[Zi];if(!e&&t[Ji]){var n=Wi(t[Ji]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Jr(this,"providerId",e),Jr(this,"isNewUser",n)}function eo(t){to.call(this,t),Jr(this,"profile",ei((t=jr(t.rawUserInfo||"{}"))||{}))}function no(t){if(eo.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ro(t){if(eo.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Jr(this,"username",this.profile&&this.profile.login||null)}function io(t){if(eo.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function oo(t){if(eo.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Jr(this,"username",t.screenName||null)}function ao(t){var e=Vn(t),n=jn(e,"link"),r=jn(Vn(n),"link");return e=jn(e,"deep_link_id"),jn(Vn(e),"link")||e||r||n||t}function so(t,e){if(!t&&!e)throw new k("internal-error","Internal assert: no raw session string available");if(t&&e)throw new k("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?uo:co}S(eo,to),S(no,eo),S(ro,eo),S(io,eo),S(oo,eo);var uo="enroll",co="signin";function lo(){}function ho(t,e){return t.then((function(t){if(t[Za]){var n=Wi(t[Za]);if(!n||e!=n.i)throw new k("user-mismatch");return t}throw new k("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==P+"user-not-found"?new k("user-mismatch"):t}))}function fo(t,e){if(!e)throw new k("internal-error","failed to construct a credential");this.a=e,Jr(this,"providerId",t),Jr(this,"signInMethod",t)}function po(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function vo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new fo(t.providerId,t.pendingToken)}catch(t){}return null}function go(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Jr(this,"idToken",e.idToken),e.accessToken&&Jr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Jr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new k("internal-error","failed to construct a credential");Jr(this,"accessToken",e.oauthToken),Jr(this,"secret",e.oauthTokenSecret)}Jr(this,"providerId",t),Jr(this,"signInMethod",n)}function yo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Zn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function mo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new go(t.providerId,e,t.signInMethod)}catch(t){}}return null}function _o(t,e){this.Qc=e||[],Zr(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(Xi(t)||{}).Ja||null,this.pb=null}function bo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new k("argument-error",'SAML provider IDs must be prefixed with "saml."');_o.call(this,t,[])}function wo(t){_o.call(this,t,Qi),this.a=[]}function Io(){wo.call(this,"facebook.com")}function To(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Io).credential({accessToken:e})}function Eo(){wo.call(this,"github.com")}function So(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Eo).credential({accessToken:e})}function Co(){wo.call(this,"google.com"),this.Ca("profile")}function ko(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new Co).credential({idToken:n,accessToken:e})}function Ao(){_o.call(this,"twitter.com",zi)}function No(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new k("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new go("twitter.com",n,"twitter.com")}function Po(t,e,n){this.a=t,this.f=e,Jr(this,"providerId","password"),Jr(this,"signInMethod",n===xo.EMAIL_LINK_SIGN_IN_METHOD?xo.EMAIL_LINK_SIGN_IN_METHOD:xo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Ro(t){return t&&t.email&&t.password?new Po(t.email,t.password,t.signInMethod):null}function xo(){Zr(this,{providerId:"password",isOAuthProvider:!1})}function Do(t,e){if(!(e=Oo(e)))throw new k("argument-error","Invalid email link!");return new Po(t,e.code,xo.EMAIL_LINK_SIGN_IN_METHOD)}function Oo(t){return(t=Ri(t=ao(t)))&&t.operation===hi?t:null}function Lo(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new k("internal-error");this.a=t,Jr(this,"providerId","phone"),this.fa="phone",Jr(this,"signInMethod","phone")}function Mo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return W(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Lo(e)}return null}function Fo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function Uo(t){try{this.a=t||r.default.auth()}catch(t){throw new k("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Zr(this,{providerId:"phone",isOAuthProvider:!1})}function qo(t,e){if(!t)throw new k("missing-verification-id");if(!e)throw new k("missing-verification-code");return new Lo({fb:t,eb:e})}function jo(t){if(t.temporaryProof&&t.phoneNumber)return new Lo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return ko(o,n);case"facebook.com":return To(n);case"github.com":return So(n);case"twitter.com":return No(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new fo(e,a):new go(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new wo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function Vo(t){if(!t.isOAuthProvider)throw new k("invalid-oauth-provider")}function Bo(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new k("invalid-auth-event");if(this.g&&this.a)throw new k("invalid-auth-event");if(this.g&&!this.f)throw new k("invalid-auth-event")}function Ko(t){return(t=t||{}).type?new Bo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&A(t.error),t.postBody,t.tenantId):null}function Ho(){this.b=null,this.a=[]}so.prototype.Ha=function(){return this.a?Ne(this.a):Ne(this.b)},so.prototype.w=function(){return this.type==uo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},lo.prototype.ka=function(){},lo.prototype.b=function(){},lo.prototype.c=function(){},lo.prototype.w=function(){},fo.prototype.ka=function(t){return bs(t,po(this))},fo.prototype.b=function(t,e){var n=po(this);return n.idToken=e,ws(t,n)},fo.prototype.c=function(t,e){return ho(Is(t,po(this)),e)},fo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},go.prototype.ka=function(t){return bs(t,yo(this))},go.prototype.b=function(t,e){var n=yo(this);return n.idToken=e,ws(t,n)},go.prototype.c=function(t,e){return ho(Is(t,yo(this)),e)},go.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},_o.prototype.Ka=function(t){return this.Jb=gt(t),this},S(bo,_o),S(wo,_o),wo.prototype.Ca=function(t){return Y(this.a,t)||this.a.push(t),this},wo.prototype.Rb=function(){return Z(this.a)},wo.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new k("argument-error","credential failed: must provide the ID token and/or the access token.");return new go(this.providerId,n,this.providerId)},S(Io,wo),Jr(Io,"PROVIDER_ID","facebook.com"),Jr(Io,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(Eo,wo),Jr(Eo,"PROVIDER_ID","github.com"),Jr(Eo,"GITHUB_SIGN_IN_METHOD","github.com"),S(Co,wo),Jr(Co,"PROVIDER_ID","google.com"),Jr(Co,"GOOGLE_SIGN_IN_METHOD","google.com"),S(Ao,_o),Jr(Ao,"PROVIDER_ID","twitter.com"),Jr(Ao,"TWITTER_SIGN_IN_METHOD","twitter.com"),Po.prototype.ka=function(t){return this.signInMethod==xo.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Ps,{email:this.a,oobCode:this.f}):ru(t,Js,{email:this.a,password:this.f})},Po.prototype.b=function(t,e){return this.signInMethod==xo.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Rs,{idToken:e,email:this.a,oobCode:this.f}):ru(t,Hs,{idToken:e,email:this.a,password:this.f})},Po.prototype.c=function(t,e){return ho(this.ka(t),e)},Po.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Zr(xo,{PROVIDER_ID:"password"}),Zr(xo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Zr(xo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Lo.prototype.ka=function(t){return t.gb(Fo(this))},Lo.prototype.b=function(t,e){var n=Fo(this);return n.idToken=e,ru(t,tu,n)},Lo.prototype.c=function(t,e){var n=Fo(this);return n.operation="REAUTH",ho(t=ru(t,eu,n),e)},Lo.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Uo.prototype.gb=function(t,e){var n=this.a.a;return Ne(e.verify()).then((function(r){if("string"!=typeof r)throw new k("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=g(t)?t.session:null,o=g(t)?t.phoneNumber:t;return(i&&i.type==uo?i.Ha().then((function(t){return function(t,e){return ru(t,Gs,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==co?i.Ha().then((function(e){return function(t,e){return ru(t,zs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return ru(t,Bs,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new k("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Zr(Uo,{PROVIDER_ID:"phone"}),Zr(Uo,{PHONE_SIGN_IN_METHOD:"phone"}),Bo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Bo.prototype.T=function(){return this.h},Bo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Wo,Go=null;function zo(t){var e="unauthorized-domain",n=void 0,r=Vn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Ht("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Ht("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",k.call(this,e,n)}function Qo(t,e,n){k.call(this,t,n),(t=e||{}).Kb&&Jr(this,"email",t.Kb),t.ea&&Jr(this,"phoneNumber",t.ea),t.credential&&Jr(this,"credential",t.credential),t.$b&&Jr(this,"tenantId",t.$b)}function Yo(t){if(t.code){var e=t.code||"";0==e.indexOf(P)&&(e=e.substring(P.length));var n={credential:jo(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new k(e,t.message||void 0);return new Qo(e,n,t.message)}return null}function Xo(){}function $o(t){return t.c||(t.c=t.b())}function Jo(){}function Zo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ta(){}function ea(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.qc,this),this.a.onerror=I(this.Tb,this),this.a.onprogress=I(this.rc,this),this.a.ontimeout=I(this.vc,this)}function na(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ra(t,e,n){this.reset(t,e,n,void 0,void 0)}function ia(t){this.f=t,this.b=this.c=this.a=null}function oa(t,e){this.name=t,this.value=e}S(zo,k),S(Qo,k),Qo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&mt(t,e),t},Qo.prototype.toJSON=function(){return this.w()},Xo.prototype.c=null,S(Jo,Xo),Jo.prototype.a=function(){var t=Zo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Jo.prototype.b=function(){var t={};return Zo(this)&&(t[0]=!0,t[1]=!0),t},Wo=new Jo,S(ta,Xo),ta.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new ea;throw Error("Unsupported browser")},ta.prototype.b=function(){return{}},(t=ea.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,na(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",na(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,na(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ra.prototype.a=null,ra.prototype.reset=function(t,e,n,r,i){r||E(),delete this.a},oa.prototype.toString=function(){return this.name};var aa=new oa("SEVERE",1e3),sa=new oa("WARNING",900),ua=new oa("CONFIG",700),ca=new oa("FINE",500);function la(t){return t.c?t.c:t.a?la(t.a):(F("Root logger has no level set."),null)}ia.prototype.log=function(t,e,n){if(t.value>=la(this).value)for(v(e)&&(e=e()),t=new ra(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var ha={},fa=null;function da(t){var e;if(fa||(fa=new ia(""),ha[""]=fa,fa.c=ua),!(e=ha[t])){e=new ia(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=da(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,ha[t]=e}return e}function pa(t,e){t&&t.log(ca,e,void 0)}function va(t){this.f=t}function ga(t){Tn.call(this),this.u=t,this.h=void 0,this.readyState=ya,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=da("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(va,Xo),va.prototype.a=function(){return new ga(this.f)},va.prototype.b=function(t){return function(){return t}}({}),S(ga,Tn);var ya=0;function ma(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function _a(t){t.readyState=4,t.g=null,t.c=null,t.m=null,ba(t)}function ba(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function wa(t){Tn.call(this),this.headers=new Rn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ia,this.u=this.S=!1}(t=ga.prototype).open=function(t,e){if(this.readyState!=ya)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,ba(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,_a(this)),this.readyState=ya},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,ba(this)),this.a&&(this.readyState=3,ba(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ma(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?_a(this):ba(this),3==this.readyState&&ma(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,_a(this))},t.sc=function(t){this.a&&(this.response=t,_a(this))},t.Va=function(t){var e=this.i;e&&e.log(sa,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&_a(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(sa,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(sa,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ga.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(wa,Tn);var Ia="";wa.prototype.b=da("goog.net.XhrIo");var Ta=/^https?$/i,Ea=["POST","PUT"];function Sa(t){return"content-type"==t.toLowerCase()}function Ca(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ka(t),Na(t)}function ka(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Aa(t){if(t.c&&void 0!==s)if(t.C[1]&&4==Ra(t)&&2==xa(t))pa(t.b,Da(t,"Local request error detected and ignored"));else if(t.i&&4==Ra(t))kn(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==Ra(t)){pa(t.b,Da(t,"Request complete")),t.c=!1;try{var e,n=xa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(On)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!Ta.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Ra(t)?t.a.statusText:""}catch(e){pa(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+xa(t)+"]",ka(t)}}finally{Na(t)}}}function Na(t,e){if(t.a){Pa(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(aa,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Pa(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(u.clearTimeout(t.s),t.s=null)}function Ra(t){return t.a?t.a.readyState:0}function xa(t){try{return 2<Ra(t)?t.a.status:-1}catch(t){return-1}}function Da(t,e){return e+" ["+t.P+" "+t.l+" "+xa(t)+"]"}function Oa(t){var e=Wa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function La(t,e,n){t.a=!0,t.c=n,t.f=!e,qa(t)}function Ma(t){if(t.a){if(!t.v)throw new ja(t);t.v=!1}}function Fa(t,e,n,r){t.g.push([e,n,r]),t.a&&qa(t)}function Ua(t){return Q(t.g,(function(t){return v(t[1])}))}function qa(t){if(t.h&&t.a&&Ua(t)){var e=t.h,n=Ka[e];n&&(u.clearTimeout(n.a),delete Ka[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.s,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(O(e)||"function"==typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,Ua(t)||(n=!0)}}t.c=e,r&&(s=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof Oa?(Fa(e,s,r),e.C=!0):e.then(s,r)),n&&(e=new Ba(e),Ka[e.a]=e,t.h=e.a)}function ja(){L.call(this)}function Va(){L.call(this)}function Ba(t){this.a=u.setTimeout(I(this.c,this),0),this.b=t}(t=wa.prototype).Ma=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",pa(this.b,Da(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(pa(this.b,Da(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Na(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Na(this,!0)),wa.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?Aa(this):this.Jc())},t.Jc=function(){Aa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ia:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(aa,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return pa(this.b,"Can not get response: "+t.message),null}},Oa.prototype.cancel=function(t){if(this.a)this.c instanceof Oa&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Va(this),Ma(this),La(this,!1,t))}},Oa.prototype.m=function(t,e){this.i=!1,La(this,t,e)},Oa.prototype.then=function(t,e,n){var r,i,o=new Ie((function(t,e){r=t,i=e}));return Fa(this,r,(function(t){t instanceof Va?o.cancel():i(t)})),o.then(t,e,n)},Oa.prototype.$goog_Thenable=!0,S(ja,L),ja.prototype.message="Deferred has already fired",ja.prototype.name="AlreadyCalledError",S(Va,L),Va.prototype.message="Deferred was canceled",Va.prototype.name="CanceledError",Ba.prototype.c=function(){throw delete Ka[this.a],this.b};var Ka={};function Ha(t){var e={},n=e.document||document,r=kt(t).toString(),i=ge(document,"SCRIPT"),o={Xb:i,Ma:void 0},a=new Oa(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout((function(){Ga(i,!0);var t=new Ya(Qa,"Timeout reached for loading script "+r);Ma(a),La(a,!1,t)}),c),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ga(i,e.xd||!1,s),Ma(a),La(a,!0,null))},i.onerror=function(){Ga(i,!0,s);var t=new Ya(za,"Error while loading script "+r);Ma(a),La(a,!1,t)},mt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),he(i,o),function(t,e){_t(t,"HTMLScriptElement"),t.src=kt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=u?e=h(e.document):(null===l&&(l=h(u.document)),e=l),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Wa(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&Ga(t,!0,this.Ma)}}function Ga(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var za=0,Qa=1;function Ya(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function Xa(t){this.f=t}function $a(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||ts,this.g=gt(t.secureTokenHeaders||es),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||ns,this.a=gt(t.firebaseHeaders||rs),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Er(),!(n=u.XMLHttpRequest||n&&r.default.INTERNAL.node&&r.default.INTERNAL.node.XMLHttpRequest)&&!Tr())throw new k("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Tr()?this.f=new va(self):Sr()?this.f=new Xa(n):this.f=new ta,this.b=null}S(Ya,L),S(Xa,Xo),Xa.prototype.a=function(){return new this.f},Xa.prototype.b=function(){return{}};var Ja,Za="idToken",ts=new Hr(3e4,6e4),es={"Content-Type":"application/x-www-form-urlencoded"},ns=new Hr(3e4,6e4),rs={"Content-Type":"application/json"};function is(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function os(t,e){e&&(t.l=as("https://securetoken.googleapis.com/v1/token",e),t.h=as("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=as("https://identitytoolkit.googleapis.com/v2/",e))}function as(t,e){return t=Vn(t),e=Vn(e.url),t.f=t.a+t.f,Mn(t,e.c),t.a=e.a,Fn(t,e.g),t.toString()}function ss(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function us(t,e,n,r,i,o,a){(function(){var t=Rr();return!((t=Ar(t)!=kr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Xt&&ue&&!(9<ue))})()||Tr()?t=I(t.u,t):(Ja||(Ja=new Ie((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(u[ls]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Fa(t,null,e,void 0)}(Ha(At(cs,{onload:ls})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=I(t.s,t)),t(e,n,r,i,o,a)}$a.prototype.T=function(){return this.b},$a.prototype.u=function(t,e,n,r,i,o){if(Tr()&&(void 0===u.fetch||void 0===u.Headers||void 0===u.Request))throw new k("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new wa(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}En(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return pa(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Sn(a,"ready",(function(){s&&clearTimeout(s),ze(this)})),Sn(a,"timeout",(function(){s&&clearTimeout(s),ze(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Wo.a(),t.C=t.D?$o(t.D):$o(Wo),t.a.onreadystatechange=I(t.Wb,t);try{pa(t.b,Da(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){return pa(t.b,Da(t,"Error opening Xhr: "+e.message)),void Ca(t,e)}e=r||"";var o=new Rn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)W(t,e,void 0);else for(var n=Pn(t),r=Nn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Sa,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!Y(Ea,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Pa(t),0<t.g&&(t.u=function(t){return Xt&&se(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),pa(t.b,Da(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ma,t)):t.s=kn(t.Ma,t.g,t)),pa(t.b,Da(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){pa(t.b,Da(t,"Send error: "+e.message)),Ca(t,e)}}(a,t,n,r,i)};var cs=new bt(Et,"https://apis.google.com/js/client.js?onload=%{onload}"),ls="__fcb"+Math.floor(1e6*Math.random()).toString();function hs(t){if("string"!=typeof(t=t.email)||!_r.test(t))throw new k("invalid-email")}function fs(t){"email"in t&&hs(t)}function ds(t){if(!t[Za]){if(t.mfaPendingCredential)throw new k("multi-factor-auth-required",null,gt(t));throw new k("internal-error")}}function ps(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new k("internal-error")}else{if(!t.sessionInfo)throw new k("missing-verification-id");if(!t.code)throw new k("missing-verification-code")}}$a.prototype.s=function(t,e,n,r,i){var o=this;Ja.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},$a.prototype.Ab=function(){return ru(this,Ws,{})},$a.prototype.Cb=function(t,e){return ru(this,Ks,{idToken:t,email:e})},$a.prototype.Db=function(t,e){return ru(this,Hs,{idToken:t,password:e})};var vs={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function gs(t){if(!t.phoneVerificationInfo)throw new k("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new k("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new k("missing-verification-code")}function ys(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new k("internal-error")}function ms(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&er(t=new $n(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function _s(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Yo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Yo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Yo(t)):t.errorMessage&&(e=iu(t.errorMessage)),e)throw e;ds(t)}function bs(t,e){return e.returnIdpCredential=!0,ru(t,Qs,e)}function ws(t,e){return e.returnIdpCredential=!0,ru(t,Xs,e)}function Is(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ru(t,Ys,e)}function Ts(t){if(!t.oobCode)throw new k("invalid-action-code")}(t=$a.prototype).Eb=function(t,e){var n={idToken:t},r=[];return pt(vs,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),ru(this,Ks,n)},t.wb=function(t,e){return mt(t={requestType:"PASSWORD_RESET",email:t},e),ru(this,Us,t)},t.xb=function(t,e){return mt(t={requestType:"EMAIL_SIGNIN",email:t},e),ru(this,Ls,t)},t.vb=function(t,e){return mt(t={requestType:"VERIFY_EMAIL",idToken:t},e),ru(this,Ms,t)},t.Fb=function(t,e,n){return mt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),ru(this,Fs,t)},t.gb=function(t){return ru(this,Zs,t)},t.ob=function(t,e){return ru(this,Vs,{oobCode:t,newPassword:e})},t.Sa=function(t){return ru(this,Ss,{oobCode:t})},t.kb=function(t){return ru(this,Es,{oobCode:t})};var Es={endpoint:"setAccountInfo",A:Ts,Z:"email",B:!0},Ss={endpoint:"resetPassword",A:Ts,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new k("internal-error")},B:!0},Cs={endpoint:"signupNewUser",A:function(t){if(hs(t),!t.password)throw new k("weak-password")},G:ds,V:!0,B:!0},ks={endpoint:"createAuthUri",B:!0},As={endpoint:"deleteAccount",O:["idToken"]},Ns={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new k("internal-error")}},Ps={endpoint:"emailLinkSignin",O:["email","oobCode"],A:hs,G:ds,V:!0,B:!0},Rs={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:hs,G:ds,V:!0},xs={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:gs,G:ds,B:!0,Na:!0},Ds={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:gs,G:ds,B:!0,Na:!0},Os={endpoint:"getAccountInfo"},Ls={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new k("internal-error");hs(t)},Z:"email",B:!0},Ms={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Fs={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Us={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new k("internal-error");hs(t)},Z:"email",B:!0},qs={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},js={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new k("internal-error")}},Vs={endpoint:"resetPassword",A:Ts,Z:"email",B:!0},Bs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ks={endpoint:"setAccountInfo",O:["idToken"],A:fs,V:!0},Hs={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(fs(t),!t.password)throw new k("weak-password")},G:ds,V:!0},Ws={endpoint:"signupNewUser",G:ds,V:!0,B:!0},Gs={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new k("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new k("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},zs={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},Qs={endpoint:"verifyAssertion",A:ys,Za:ms,G:_s,V:!0,B:!0},Ys={endpoint:"verifyAssertion",A:ys,Za:ms,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new k("user-not-found");if(t.errorMessage)throw iu(t.errorMessage);ds(t)},V:!0,B:!0},Xs={endpoint:"verifyAssertion",A:function(t){if(ys(t),!t.idToken)throw new k("internal-error")},Za:ms,G:_s,V:!0},$s={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new k("invalid-custom-token")},G:ds,V:!0,B:!0},Js={endpoint:"verifyPassword",A:function(t){if(hs(t),!t.password)throw new k("wrong-password")},G:ds,V:!0,B:!0},Zs={endpoint:"verifyPhoneNumber",A:ps,G:ds,B:!0},tu={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new k("internal-error");ps(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Yo(t);ds(t)}},eu={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ps,G:ds,B:!0},nu={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Za]^!!t.refreshToken)throw new k("internal-error")},B:!0,Na:!0};function ru(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.O))return Pe(new k("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return Ne(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,a){var s=Vn(e+n);qn(s,"key",t.c),a&&qn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&qn(s,c,i[c]);return new Ie((function(e,n){us(t,s.toString(),(function(t){t?t.error?n(ou(t,o||{})):e(t):n(new k("network-request-failed"))}),r,u?void 0:or(qr(i)),t.a,t.v.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)})).then((function(t){return r=t,e.Za?e.Za(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new k("internal-error");return r[e.Z]}))}function iu(t){return ou({error:{errors:[{message:t}],code:400,message:t}})}function ou(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new k(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",mt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new k(r[i],e);return!e&&t&&(e=Ur(t)),new k("internal-error",e)}function au(t){this.b=t,this.a=null,this.sb=function(t){return(lu||(lu=new Ie((function(t,e){function n(){Kr(),xr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Kr(),e(Error("Network Error"))},timeout:uu.get()})}if(xr("gapi.iframes.Iframe"))t();else if(xr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){xr("gapi.load")?n():e(Error("Network Error"))},Ne(Ha(r=At(su,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw lu=null,t})))).then((function(){return new Ie((function(e,n){xr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),cu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var su=new bt(Et,"https://apis.google.com/js/api.js?onload=%{onload}"),uu=new Hr(3e4,6e4),cu=new Hr(5e3,15e3),lu=null;function hu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Bn((t=Vn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):Bn("https",this.l,null,"/__/auth/iframe"),this.a=t,qn(this.a,"apiKey",this.h),qn(this.a,"appName",this.i),this.b=null,this.c=[]}function fu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function du(t){try{return r.default.app(t).auth().Ga()}catch(t){return[]}}function pu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function vu(t){var e=fr();return function(t){return ru(t,qs,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Vn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Vn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:mr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new zo(fr())}))}function gu(t){return t.m||(t.m=br().then((function(){if(!t.u){var e=t.c,n=t.i,r=du(t.b),i=new hu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=Z(r||[]),t.u=i.toString()}t.v=new au(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then((function(){t.a.register("authEvent",e,xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Ko(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ne(n)}return n.status="ERROR",Ne(n)}))}(t)}))),t.m}function yu(t){return t.l||(t.C=t.c?Pr(t.c,du(t.b)):null,t.l=new $a(t.g,D(t.i),t.C),t.f&&os(t.l,t.f)),t.l}function mu(t,e,n,r,i,o,a,s,u,c,l,h){return(t=new fu(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=gt(u||null),t.f=c,t.zb(l).toString()}function _u(t){if(this.a=t||r.default.INTERNAL.reactNative&&r.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new k("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function bu(t){this.b=t,this.a={},this.f=I(this.c,this)}hu.prototype.toString=function(){return this.f?qn(this.a,"v",this.f):tr(this.a.b,"v"),this.b?qn(this.a,"eid",this.b):tr(this.a.b,"eid"),this.c.length?qn(this.a,"fw",this.c.join(",")):tr(this.a.b,"fw"),this.a.toString()},fu.prototype.zb=function(t){return this.h=t,this},fu.prototype.toString=function(){if(this.v){var t=Vn(this.v.url);t=Bn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Bn("https",this.u,null,"/__/auth/handler");if(qn(t,"apiKey",this.s),qn(t,"appName",this.c),qn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.default.app(this.c).auth().la()}catch(t){n=null}for(var i in e.pb=n,qn(t,"providerId",this.a.providerId),e=qr((n=this.a).Jb))e[i]=e[i].toString();i=n.Qc,e=gt(e);for(var o=0;o<i.length;o++){var a=i[o];a in e&&delete e[a]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),vt(e)||qn(t,"customParameters",Ur(e))}if("function"==typeof this.a.Rb&&(n=this.a.Rb()).length&&qn(t,"scopes",n.join(",")),this.l?qn(t,"redirectUrl",this.l):tr(t.b,"redirectUrl"),this.g?qn(t,"eventId",this.g):tr(t.b,"eventId"),this.i?qn(t,"v",this.i):tr(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!jn(t,s)&&qn(t,s,this.b[s]);return this.h?qn(t,"tid",this.h):tr(t.b,"tid"),this.f?qn(t,"eid",this.f):tr(t.b,"eid"),(s=du(this.c)).length&&qn(t,"fw",s.join(",")),t.toString()},(t=pu.prototype).Pb=function(t,e,n){var r=new k("popup-closed-by-user"),i=new k("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return gu(t).then((function(){return function(t,e){return t.sb.then((function(){return new Ie((function(n){t.a.send(e.type,e,n,xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&gr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Ie((function(e){return function n(){An(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return An(n).then((function(){e(r)}))}))},t.Yb=function(){var t=Rr();return!Fr(t)&&!Br(t)},t.Ub=function(){return!1},t.Nb=function(t,e,n,r,i,o,a,s){if(!t)return Pe(new k("popup-blocked"));if(a&&!Fr())return this.ma().o((function(e){gr(t),i(e)})),r(),Ne();this.a||(this.a=vu(yu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw gr(t),i(e),e}));return r(),e})).then((function(){Vo(n),a||dr(mu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Ob=function(t,e,n,r){this.a||(this.a=vu(yu(this)));var i=this;return this.a.then((function(){Vo(e),dr(mu(i.s,i.g,i.b,t,e,fr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return gu(this).then((function(){return t.v.sb})).o((function(){throw t.a=null,new k("network-request-failed")}))},t.ac=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ta=function(t){$(this.h,(function(e){return e==t}))},(t=_u.prototype).get=function(t){return Ne(this.a.getItem(t)).then((function(t){return t&&jr(t)}))},t.set=function(t,e){return Ne(this.a.setItem(t,Ur(e)))},t.U=function(t){return Ne(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var wu,Iu=[];function Tu(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Eu(t){this.a=t}function Su(t){this.c=t,this.b=!1,this.a=[]}function Cu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Pe(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ie((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return ku(t,c),e})).o((function(e){throw ku(t,c),e}))}function ku(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),$(t.a,(function(t){return t==e}))}}function Au(){if(!xu())throw new k("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Tr()&&self?(this.v=function(){var t=Tr()?self:null;if(W(Iu,(function(n){n.b==t&&(e=n)})),!e){var e=new bu(t);Iu.push(e)}return e}(),Tu(this.v,"keyChanged",(function(e,n){return Fu(t).then((function(e){return 0<e.length&&W(t.a,(function(t){t(e)})),{keyProcessed:Y(e,n.key)}}))})),Tu(this.v,"ping",(function(){return Ne(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?Ne().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Ne(null)}().then((function(e){(t.h=e)&&(t.g=new Su(new Eu(e)),Cu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Y(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Nu(t){return new Ie((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ie((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Nu(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Pu(t){return t.i||(t.i=Nu(t)),t.i}function Ru(t,e){var n=0;return new Ie((function r(i,o){Pu(t).then(e).then(i).o((function(e){if(!(3<++n))return Pu(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function xu(){try{return!!u.indexedDB}catch(t){return!1}}function Du(t){return t.objectStore("firebaseLocalStorage")}function Ou(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Lu(t){return new Ie((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Mu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Cu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Ne()}function Fu(t){return Pu(t).then((function(t){var e=Du(Ou(t,!1));return e.getAll?Lu(e.getAll()):new Ie((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=pr(t.c,n),t.c=n}return r}))}function Uu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function qu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ne().then((function(){if(xu()){var t=Vr(),r="__sak"+t;return wu||(wu=new Au),(n=wu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){W(e.a,(function(e){e(t)}))})),t}))}function ju(){this.a={},this.type="inMemory"}function Vu(){if(!function(){var t="Node"==Er();if(!(t=Bu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new k("internal-error","The LocalStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Bu()||r.default.INTERNAL.node.localStorage,this.type="localStorage"}function Bu(){try{var t=u.localStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Ku(){this.type="nullStorage"}function Hu(){if(!function(){var t="Node"==Er();if(!(t=Wu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new k("internal-error","The SessionStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Wu()||r.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Wu(){try{var t=u.sessionStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Gu(){var t={};t.Browser=Yu,t.Node=Xu,t.ReactNative=$u,t.Worker=Ju,this.a=t[Er()]}bu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];W(r,(function(e){i.push(Ne().then((function(){return e(t.origin,t.data.data)})))})),xe(i).then((function(r){var i=[];W(r,(function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})})),W(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Eu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Su.prototype.close=function(){for(;0<this.a.length;)ku(this,this.a[0]);this.b=!0},(t=Au.prototype).set=function(t,e){var n=this,r=!1;return Ru(this,(function(e){return Lu((e=Du(Ou(e,!0))).get(t))})).then((function(i){return Ru(n,(function(o){if(o=Du(Ou(o,!0)),i)return i.value=e,Lu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Lu(o.add(a))}))})).then((function(){return n.c[t]=e,Mu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Ru(this,(function(e){return Lu(Du(Ou(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Ru(this,(function(r){return n=!0,e.b++,Lu(Du(Ou(r,!0)).delete(t))})).then((function(){return delete e.c[t],Mu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){Uu(t),function e(){t.f=setTimeout((function(){t.l=Fu(t).then((function(e){0<e.length&&W(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){$(this.a,(function(e){return e==t})),0==this.a.length&&Uu(this)},(t=qu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){$(this.a,(function(e){return e==t}))},(t=ju.prototype).get=function(t){return Ne(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ne()},t.U=function(t){return delete this.a[t],Ne()},t.ca=function(){},t.ia=function(){},(t=Vu.prototype).get=function(t){var e=this;return Ne().then((function(){return jr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ne().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Ne().then((function(){e.a.removeItem(t)}))},t.ca=function(t){u.window&&hn(u.window,"storage",t)},t.ia=function(t){u.window&&pn(u.window,"storage",t)},(t=Ku.prototype).get=function(){return Ne(null)},t.set=function(){return Ne()},t.U=function(){return Ne()},t.ca=function(){},t.ia=function(){},(t=Hu.prototype).get=function(t){var e=this;return Ne().then((function(){return jr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ne().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Ne().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var zu,Qu,Yu={F:Vu,cb:Hu},Xu={F:Vu,cb:Hu},$u={F:_u,cb:Ku},Ju={F:Vu,cb:Ku},Zu={rd:"local",NONE:"none",td:"session"};function tc(){var t=!(Br(Rr())||!Ir()),e=Fr(),n=Dr();this.m=t,this.h=e,this.l=n,this.a={},zu||(zu=new Gu),t=zu;try{this.g=!hr()&&zr()||!u.indexedDB?new t.a.F:new qu(Tr()?new ju:new t.a.F)}catch(t){this.g=new ju,this.h=!0}try{this.i=new t.a.cb}catch(t){this.i=new ju}this.v=new ju,this.f=I(this.Zb,this),this.b={}}function ec(){return Qu||(Qu=new tc),Qu}function nc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function rc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function ic(t,e,n){return n=rc(e,n),"local"==e.F&&(t.b[n]=null),nc(t,e.F).U(n)}function oc(t){t.c&&(clearInterval(t.c),t.c=null)}function ac(t){this.a=t,this.b=ec()}(t=tc.prototype).get=function(t,e){return nc(this,t.F).get(rc(t,e))},t.set=function(t,e,n){var r=rc(t,n),i=this,o=nc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=rc(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),vt(this.a)&&(nc(this,"local").ca(this.f),this.h||(hr()||!zr())&&u.indexedDB||!this.l||function(t){oc(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Ze({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Zb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=rc(t,e),this.a[t]&&($(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(nc(this,"local").ia(this.f),oc(this))},t.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?nc(this,"local").ia(this.f):oc(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.nb(e))},Xt&&ue&&10==ue&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else W(t,I(this.nb,this))},t.nb=function(t){this.a[t]&&W(this.a[t],(function(t){t()}))};var sc,uc={name:"authEvent",F:"local"};function cc(){this.a=ec()}function lc(t,e){this.b=hc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===sc&&(sc=u.Int32Array?new Int32Array(mc):mc),this.reset()}S(lc,(function(){this.b=-1}));for(var hc=64,fc=hc-1,dc=[],pc=0;pc<fc;pc++)dc[pc]=0;var vc=J(128,dc);function gc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|sc[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function yc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(gc(t),i=0);else{if(!p(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(gc(t),i=0)}}t.c=i,t.g+=n}lc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):Z(this.h)};var mc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _c(){lc.call(this,8,bc)}S(_c,lc);var bc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function wc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new cc,this.g=new ac(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ic(t){return new k("invalid-cordova-configuration",t)}function Tc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Ec(t){return t.f||(t.f=t.ma().then((function(){return new Ie((function(e){t.Ea((function n(r){return e(r),t.Ta(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Sc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=ao(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=jr(jn(o=Vn(i),"firebaseError")||null))?A(o):null)?new Bo(r.c,r.b,null,null,o,null,r.T()):new Bo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Tc(t,i)}))}var n=new Bo("unknown",null,null,null,new k("no-auth-event")),r=!1,i=An(500).then((function(){return Sc(t).then((function(){r||Tc(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(xr("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Go||(Go=new Ho),function(t){var e=Go;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=xr("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Sc(t){var e=null;return function(t){return t.b.get(uc,t.a).then((function(t){return Ko(t)}))}(t.g).then((function(n){return e=n,ic((n=t.g).b,uc,n.a)})).then((function(){return e}))}function Cc(t){this.a=t,this.b=ec()}(t=wc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(wr(void 0)?br().then((function(){return new Ie((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Pe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof xr("universalLinks.subscribe",u))throw Ic("cordova-universal-links-plugin-fix is not installed");if(void 0===xr("BuildInfo.packageName",u))throw Ic("cordova-plugin-buildinfo is not installed");if("function"!=typeof xr("cordova.plugins.browsertab.openUrl",u))throw Ic("cordova-plugin-browsertab is not installed");if("function"!=typeof xr("cordova.InAppBrowser.open",u))throw Ic("cordova-plugin-inappbrowser is not installed")}),(function(){throw new k("cordova-not-ready")}))},t.Pb=function(t,e){return e(new k("operation-not-supported-in-this-environment")),Ne()},t.Nb=function(){return Pe(new k("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(t,e,n,r){if(this.c)return Pe(new k("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,l=null;return this.c=Ne().then((function(){return Vo(e),Ec(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Bo(e,r,null,o,new k("no-auth-event"),null,i),s=xr("BuildInfo.packageName",u);if("string"!=typeof s)throw new k("invalid-cordova-configuration");var c=xr("BuildInfo.displayName",u),l={};if(Rr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=s;else{if(!Rr().toLowerCase().match(/android/))return Pe(new k("operation-not-supported-in-this-environment"));l.apn=s}c&&(l.appDisplayName=c),o=function(t){var e=new _c;yc(e,t),t=[];var n=8*e.g;56>e.c?yc(e,vc,56-e.c):yc(e,vc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(gc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return z(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),l.sessionId=o;var h=mu(t.v,t.i,t.l,e,n,null,r,t.m,l,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(uc,a.w(),e)})).then((function(){var e=xr("cordova.plugins.browsertab.isAvailable",u);if("function"!=typeof e)throw new k("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=xr("cordova.plugins.browsertab.openUrl",u)))throw new k("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=xr("cordova.InAppBrowser.open",u)))throw new k("invalid-cordova-configuration");e=Rr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Ie((function(t,e){s=function(){var e=xr("cordova.plugins.browsertab.close",u);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),c=function(){a||(a=An(2e3).then((function(){e(new k("redirect-cancelled-by-user"))})))},l=function(){Wr()&&c()},o.addEventListener("resume",c,!1),Rr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(t){return Sc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),s&&i.Ta(s),i.c=null}))},t.Ea=function(t){this.b.push(t),Ec(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Bo("unknown",null,null,null,new k("no-auth-event")),t(e))}))},t.Ta=function(t){$(this.b,(function(e){return e==t}))};var kc={name:"pendingRedirect",F:"session"};function Ac(t){return ic(t.b,kc,t.a)}function Nc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=I(this.s,this),this.b=new Hc,this.C=new Yc,this.g=new Cc(Bc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Pc(this.D,this.v,this.m,N,this.J)}function Pc(t,e,n,i,o){var a=r.default.SDK_VERSION||null;return wr()?new wc(t,e,n,a,i,o):new pu(t,e,n,a,i,o)}function Rc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function xc(t){t.a.Yb()&&Rc(t).o((function(e){var n=new Bo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Uc(e)&&t.s(n)})),t.a.Ub()||Wc(t.b)}function Dc(t,e){Y(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(kc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Ac(t.g).then((function(){Rc(t).o((function(e){var n=new Bo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Uc(e)&&t.s(n)}))})):xc(t)})).o((function(){xc(t)}))}function Oc(t,e){$(t.h,(function(t){return t==e}))}Nc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Pc(this.D,this.v,this.m,null,this.J),this.i={}},Nc.prototype.s=function(t){if(!t)throw new k("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Wc(this.b),e};var Lc=new Hr(2e3,1e4),Mc=new Hr(3e4,6e4);function Fc(t,e,n,r,i,o,a){return t.a.Nb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Uc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function qc(t,e,n,r,i){var o;return function(t){return t.b.set(kc,"pending",t.a)}(t.g).then((function(){return t.a.Ob(e,n,r,i).o((function(e){if(Uc(e))throw new k("operation-not-supported-in-this-environment");return o=e,Ac(t.g).then((function(){throw o}))})).then((function(){return t.a.ac()?new Ie((function(){})):Ac(t.g).then((function(){return t.ra()})).then((function(){})).o((function(){}))}))}))}function jc(t,e,n,r,i){return t.a.Pb(r,(function(t){e.na(n,null,t,i)}),Lc.get())}Nc.prototype.ra=function(){return this.b.ra()};var Vc={};function Bc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Kc(t,e,n,r){var i=Bc(e,n,r);return Vc[i]||(Vc[i]=new Nc(t,e,n,r)),Vc[i]}function Hc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Wc(t){t.g||(t.g=!0,Qc(t,!1,null,null))}function Gc(t){t.g&&!t.i&&Qc(t,!1,null,null)}function zc(t,e){if(t.b=function(){return Ne(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Qc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Pe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):zc(t,n):zc(t,{user:null}),t.f=[],t.c=[]}function Yc(){}function Xc(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function $c(t,e){this.a=e,Jr(this,"verificationId",t)}function Jc(t,e,n,r){return new Uo(t).gb(e,n).then((function(t){return new $c(t,r)}))}function Zc(t){var e=Gi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new k("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Zr(this,{token:t,expirationTime:Gr(1e3*e.exp),authTime:Gr(1e3*e.auth_time),issuedAtTime:Gr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function tl(t,e,n){var r=e&&e[nl];if(!r)throw new k("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=gt(e),this.g=n,this.c=new so(null,r),this.b=[];var i=this;W(e[el]||[],(function(t){(t=ri(t))&&i.b.push(t)})),Jr(this,"auth",this.a),Jr(this,"session",this.c),Jr(this,"hints",this.b)}Hc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Hc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Qc(this,!0,null,t.a),Ne()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Qc(t,s,e,null)})).o((function(e){Qc(t,s,null,e)}))}(this,t,e):Pe(new k("invalid-auth-event")):(Qc(this,!1,null,null),Ne())}else Pe(new k("invalid-auth-event"))},Hc.prototype.ra=function(){var t=this;return new Ie((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new k("timeout");t.a&&t.a.cancel(),t.a=An(Mc.get()).then((function(){t.b||(t.g=!0,Qc(t,!0,null,e))}))}(t))}))},Yc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Ne()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):Pe(new k("invalid-auth-event"))}else Pe(new k("invalid-auth-event"))},$c.prototype.confirm=function(t){return t=qo(this.verificationId,t),this.a(t)};var el="mfaInfo",nl="mfaPendingCredential";function rl(t,e,n,r){k.call(this,"multi-factor-auth-required",r,e),this.b=new tl(t,e,n),Jr(this,"resolver",this.b)}function il(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new rl(e,t.serverResponse,n,t.message)}catch(t){}return null}function ol(){}function al(t){Jr(this,"factorId",t.fa),this.a=t}function sl(t){if(al.call(this,t),this.a.fa!=Uo.PROVIDER_ID)throw new k("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function ul(t,e){for(var n in Je.call(this,t),e)this[n]=e[n]}function cl(t,e){this.a=t,this.b=[],this.c=I(this.yc,this),hn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&W(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ai]=t.uid),t.displayName&&(r[ii]=t.displayName),t.enrollmentTime&&(r[oi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[si]=t.phoneNumber);try{e=new ui(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),ll(this,n)}function ll(t,e){t.b=e,Jr(t,"enrolledFactors",e)}function hl(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fl(t,e){t.stop(),t.b=An(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=u.document,e=null;return Wr()||!t?Ne():new Ie((function(n){e=function(){Wr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){fl(t,!0)})).o((function(e){t.i(e)&&fl(t,!1)}))}function dl(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function pl(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function vl(t,e){t.b=Wi(e[Za]||""),t.a=e.refreshToken,pl(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function gl(t,e){this.a=t||null,this.b=e||null,Zr(this,{lastSignInTime:Gr(e||null),creationTime:Gr(t||null)})}function yl(t,e,n,r,i,o){Zr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ml(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.default.SDK_VERSION?Pr(r.default.SDK_VERSION):null;this.a=new $a(this.l,D(N),i),(this.u=t.emulatorConfig||null)&&os(this.a,this.u),this.h=new dl(this.a),kl(this,e[Za]),vl(this.h,e),Jr(this,"refreshToken",this.h.a),Pl(this,n||{}),Tn.call(this),this.P=!1,this.s&&Or()&&(this.b=Kc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(t){return new hl((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.ba=I(this.ib,this);var o=this;this.za=null,this.Pa=function(t){o.xa(t.h)},this.qa=null,this.Ba=function(t){_l(o,t.c)},this.$=null,this.aa=[],this.Oa=function(t){Il(o,t.f)},this.ja=null,this.S=new cl(this,n),Jr(this,"multiFactor",this.S)}function _l(t,e){t.u=e,os(t.a,e),t.b&&(e=t.b,t.b=Kc(t.s,t.l,t.m,t.u),t.P&&(Oc(e,t),Dc(t.b,t)))}function bl(t,e){t.qa&&pn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&hn(e,"languageCodeChanged",t.Pa)}function wl(t,e){t.$&&pn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&hn(e,"emulatorConfigChanged",t.Ba)}function Il(t,e){t.aa=e,ss(t.a,r.default.SDK_VERSION?Pr(r.default.SDK_VERSION,t.aa):null)}function Tl(t,e){t.ja&&pn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&hn(e,"frameworkChanged",t.Oa)}function El(t){try{return r.default.app(t.m).auth()}catch(e){throw new k("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Sl(t){t.J||t.D.b||(t.D.start(),pn(t,"tokenChanged",t.ba),hn(t,"tokenChanged",t.ba))}function Cl(t){pn(t,"tokenChanged",t.ba),t.D.stop()}function kl(t,e){t.Aa=e,Jr(t,"_lat",e)}function Al(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return xe(e).then((function(){return t}))}function Nl(t){t.b&&!t.P&&(t.P=!0,Dc(t.b,t))}function Pl(t,e){Zr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new gl(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Rl(){}function xl(t){return Ne().then((function(){if(t.J)throw new k("app-deleted")}))}function Dl(t){return z(t.providerData,(function(t){return t.providerId}))}function Ol(t,e){e&&(Ll(t,e.providerId),t.providerData.push(e))}function Ll(t,e){$(t.providerData,(function(t){return t.providerId==e}))}function Ml(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Jr(t,e,n)}function Fl(t,e){t!=e&&(Zr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Jr(t,"metadata",function(t){return new gl(t.a,t.b)}(e.metadata)):Jr(t,"metadata",new gl),W(e.providerData,(function(e){Ol(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Jr(t,"refreshToken",t.h.a),ll(t.S,e.S.b))}function Ul(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return ru(t.a,Os,{idToken:e}).then(I(t.Kc,t))}(t,e).then((function(){return n||Ml(t,"isAnonymous",!1),e}))}))}function ql(t,e){e[Za]&&t.Aa!=e[Za]&&(vl(t.h,e),t.dispatchEvent(new ul("tokenChanged")),kl(t,e[Za]),Ml(t,"refreshToken",t.h.a))}function jl(t,e){return Ul(t).then((function(){if(Y(Dl(t),e))return Al(t).then((function(){throw new k("provider-already-linked")}))}))}function Vl(t,e,n){return ti({user:t,credential:jo(e),additionalUserInfo:e=$i(e),operationType:n})}function Bl(t,e){return ql(t,e),t.reload().then((function(){return t}))}function Kl(t,e,n,i,o){if(!Or())return Pe(new k("operation-not-supported-in-this-environment"));if(t.i&&!o)return Pe(t.i);var a=Xi(n.providerId),s=Vr(t.uid+":::"),u=null;(!Fr()||Ir())&&t.s&&n.isOAuthProvider&&(u=mu(t.s,t.l,t.m,e,n,null,s,r.default.SDK_VERSION||null,null,null,t.tenantId,t.u));var c=yr(u,a&&a.va,a&&a.ua);return i=i().then((function(){if(Wl(t),!o)return t.I().then((function(){}))})).then((function(){return Fc(t.b,c,e,n,s,!!u,t.tenantId)})).then((function(){return new Ie((function(n,r){t.na(e,null,new k("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=s,t.c=jc(t.b,t,e,c,s)}))})).then((function(t){return c&&gr(c),t?ti(t):null})).o((function(t){throw c&&gr(c),t})),Gl(t,i,o)}function Hl(t,e,n,r,i){if(!Or())return Pe(new k("operation-not-supported-in-this-environment"));if(t.i&&!i)return Pe(t.i);var o=null,a=Vr(t.uid+":::");return r=r().then((function(){if(Wl(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,Al(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Yl,t.w(),e.a)),e})).then((function(){return qc(t.b,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return Xl(t.ha);throw o})).then((function(){if(o)throw o})),Gl(t,r,i)}function Wl(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new k("internal-error");throw new k("auth-domain-config-required")}}function Gl(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Pe(t.i)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new ul("userInvalidated")),t.i=e),e}))}(t,e,n);return t.N.push(r),r.oa((function(){X(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=il(e.w(),El(t),I(t.jc,t))),n||e}))}function zl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Za]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new ml(e,n,t);return t.providerData&&W(t.providerData,(function(t){t&&Ol(i,ti(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function Ql(t){this.a=t,this.b=ec()}tl.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then((function(t){var n=gt(e.f);return delete n[el],delete n[nl],mt(n,t),e.g(n)}))},S(rl,k),ol.prototype.tb=function(t,e,n){return e.type==uo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),mt(n,{phoneVerificationInfo:Fo(t.a)}),ru(e,xs,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return mt(n={mfaPendingCredential:n},{phoneVerificationInfo:Fo(t.a)}),ru(e,Ds,n)}))}(this,t,e)},S(al,ol),S(sl,al),S(ul,Je),(t=cl.prototype).yc=function(t){ll(this,function(t){var e=[];return W(t.mfaInfo||[],(function(t){(t=ri(t))&&e.push(t)})),e}(t.hd))},t.Sb=function(){return this.a.I().then((function(t){return new so(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then((function(n){return t.tb(r,n,e)})).then((function(t){return ql(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return ru(r,nu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=G(e.b,(function(t){return t.uid!=n}));return ll(e,r),ql(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:z(this.b,(function(t){return t.w()}))}}},hl.prototype.start=function(){this.a=this.c,fl(this,!0)},hl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},dl.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},dl.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Pe(new k("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?function(t,e){return function(t,e){return new Ie((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?us(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(ou(t)):t.access_token&&t.refresh_token?n(t):r(new k("internal-error")):r(new k("network-request-failed"))}),"POST",Zn(e).toString(),t.g,t.m.get()):r(new k("internal-error"))}))}(t.f,e).then((function(e){return t.b=Wi(e.access_token),t.a=e.refresh_token,pl(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Ne(null):Ne({accessToken:this.b.toString(),refreshToken:this.a})},gl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(ml,Tn),ml.prototype.xa=function(t){this.za=t,is(this.a,t)},ml.prototype.la=function(){return this.za},ml.prototype.Ga=function(){return Z(this.aa)},ml.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Jr(ml.prototype,"providerId","firebase"),(t=ml.prototype).reload=function(){var t=this;return Gl(this,xl(this).then((function(){return Ul(t).then((function(){return Al(t)})).then(Rl)})))},t.oc=function(t){return this.I(t).then((function(t){return new Zc(t)}))},t.I=function(t){var e=this;return Gl(this,xl(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new k("internal-error");return t.accessToken!=e.Aa&&(kl(e,t.accessToken),e.dispatchEvent(new ul("tokenChanged"))),Ml(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new k("internal-error");Pl(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?z(t,(function(t){return new yl(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Ol(this,e[n]);Ml(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new ul("userReloaded",{hd:t}))},t.Lc=function(t){return Xr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},t.ub=function(t){var e=this,n=null;return Gl(this,t.c(this.a,this.uid).then((function(t){return ql(e,t),n=Vl(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Xr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},t.rb=function(t){var e=this,n=null;return Gl(this,jl(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Vl(e,t,"link"),Bl(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return Gl(this,jl(this,"phone").then((function(){return Jc(El(n),t,e,I(n.rb,n))})))},t.Mc=function(t,e){var n=this;return Gl(this,Ne().then((function(){return Jc(El(n),t,e,I(n.ub,n))})),!0)},t.Cb=function(t){var e=this;return Gl(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return ql(e,t),e.reload()})))},t.ed=function(t){var e=this;return Gl(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return ql(e,t),e.reload()})))},t.Db=function(t){var e=this;return Gl(this,this.I().then((function(n){return e.a.Db(n,t)})).then((function(t){return ql(e,t),e.reload()})))},t.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return xl(this);var e=this;return Gl(this,this.I().then((function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return ql(e,t),Ml(e,"displayName",t.displayName||null),Ml(e,"photoURL",t.photoUrl||null),W(e.providerData,(function(t){"password"===t.providerId&&(Jr(t,"displayName",e.displayName),Jr(t,"photoURL",e.photoURL))})),Al(e)})).then(Rl))},t.cd=function(t){var e=this;return Gl(this,Ul(this).then((function(n){return Y(Dl(e),t)?function(t,e,n){return ru(t,Ns,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return W(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),W(Dl(e),(function(t){n[t]||Ll(e,t)})),n[Uo.PROVIDER_ID]||Jr(e,"phoneNumber",null),Al(e)})):Al(e).then((function(){throw new k("no-such-provider")}))})))},t.delete=function(){var t=this;return Gl(this,this.I().then((function(e){return ru(t.a,As,{idToken:e})})).then((function(){t.dispatchEvent(new ul("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");bl(t,null),wl(t,null),Tl(t,null),t.N=[],t.J=!0,Cl(t),Jr(t,"refreshToken",null),t.b&&Oc(t.b,t)}))},t.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?I(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?I(this.Mb,this):null},t.Ec=function(t){var e=this;return Kl(this,"linkViaPopup",t,(function(){return jl(e,t.providerId).then((function(){return Al(e)}))}),!1)},t.Nc=function(t){return Kl(this,"reauthViaPopup",t,(function(){return Ne()}),!0)},t.Fc=function(t){var e=this;return Hl(this,"linkViaRedirect",t,(function(){return jl(e,t.providerId)}),!1)},t.Oc=function(t){return Hl(this,"reauthViaRedirect",t,(function(){return Ne()}),!0)},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Gl(this,this.I().then((function(n){return ws(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Vl(i,t,"link"),Bl(i,t)})).then((function(){return o})))},t.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Gl(this,Ne().then((function(){return ho(Is(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Vl(i,t,"reauthenticate"),ql(i,t),i.i=null,i.reload()})).then((function(){return o})),!0)},t.vb=function(t){var e=this,n=null;return Gl(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:Bi(new xi(t))})).then((function(t){return e.a.vb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Fb=function(t,e){var n=this,r=null;return Gl(this,this.I().then((function(t){return r=t,void 0===e||vt(e)?{}:Bi(new xi(e))})).then((function(e){return n.a.Fb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return Gl(this,t=ho(Ne(t),n.uid).then((function(t){return e=Vl(n,t,"reauthenticate"),ql(n,t),n.i=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&mt(t,this.metadata.w()),W(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),mt(t,this.S.w()),t};var Yl={name:"redirectUser",F:"session"};function Xl(t){return ic(t.b,Yl,t.a)}function $l(t){this.a=t,this.b=ec(),this.c=null,this.f=function(t){var e=th("local"),n=th("session"),r=th("none");return function(t,e,n){var r=rc(e,n),i=nc(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=jr(u.localStorage.getItem(r))}catch(t){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Zl,t.a).then((function(t){return t?th(t):e}))}))}))})).then((function(e){return t.c=e,Jl(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(th("local"),this.a,I(this.g,this))}function Jl(t,e){var n,r=[];for(n in Zu)Zu[n]!==e&&r.push(ic(t.b,th(Zu[n]),t.a));return r.push(ic(t.b,Zl,t.a)),function(t){return new Ie((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Re(t[s],T(o,s),a);else e(i)}))}(r)}$l.prototype.g=function(){var t=this,e=th("local");ih(this,(function(){return Ne().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Jl(t,"local").then((function(){t.c=e}))}))}))};var Zl={name:"persistence",F:"session"};function th(t){return{name:"authUser",F:t}}function eh(t,e){return ih(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function nh(t){return ih(t,(function(){return ic(t.b,t.c,t.a)}))}function rh(t,e,n){return ih(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),zl(t||{})}))}))}function ih(t,e){return t.f=t.f.then(e,e),t.f}function oh(t){if(this.l=!1,Jr(this,"settings",new Xc),Jr(this,"app",t),!dh(this).options||!dh(this).options.apiKey)throw new k("invalid-api-key");t=r.default.SDK_VERSION?Pr(r.default.SDK_VERSION):null,this.a=new $a(dh(this).options&&dh(this).options.apiKey,D(N),t),this.P=[],this.s=[],this.N=[],this.Pa=r.default.INTERNAL.createSubscribe(I(this.zc,this)),this.W=void 0,this.ib=r.default.INTERNAL.createSubscribe(I(this.Ac,this)),hh(this,null),this.i=new $l(dh(this).options.apiKey+":"+dh(this).name),this.D=new Ql(dh(this).options.apiKey+":"+dh(this).name),this.$=yh(this,function(t){var e=dh(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Yl,t.a).then((function(t){return t&&e&&(t.authDomain=e),zl(t||{})}))}(t.D,dh(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),Xl(t.D)}));return yh(t,e)}(t).then((function(){return rh(t.i,e,t.R)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return eh(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:nh(t.i)}))):null})).then((function(e){hh(t,e||null)}));return yh(t,n)}(this)),this.h=yh(this,function(t){return t.$.then((function(){return lh(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(th("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=I(this.Zc,this),this.Ba=I(this.da,this),this.qa=I(this.mc,this),this.za=I(this.wc,this),this.Aa=I(this.xc,this),this.b=null,function(t){var e=dh(t).options.authDomain,n=dh(t).options.apiKey;e&&Or()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Kc(e,n,dh(t).name,t.R),Dc(t.b,t),ph(t)&&Nl(ph(t)),t.m){Nl(t.m);var r=t.m;r.xa(t.la()),bl(r,t),Il(r=t.m,t.J),Tl(r,t),_l(r=t.m,t.R),wl(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=I(this.delete,this),this.INTERNAL.logFramework=I(this.Gc,this),this.u=0,Tn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.R){var t=Vn(this.R.url);t=ti({protocol:t.c,host:t.a,port:t.g,options:ti({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.R=null}function ah(t){Je.call(this,"languageCodeChanged"),this.h=t}function sh(t){Je.call(this,"emulatorConfigChanged"),this.c=t}function uh(t){Je.call(this,"frameworkChanged"),this.f=t}function ch(t){return t.Oa||Pe(new k("auth-domain-config-required"))}function lh(t){if(!Or())return Pe(new k("operation-not-supported-in-this-environment"));var e=ch(t).then((function(){return t.b.ra()})).then((function(t){return t?ti(t):null}));return yh(t,e)}function hh(t,e){ph(t)&&(function(t,e){$(t.W,(function(t){return t==e}))}(ph(t),t.Ba),pn(ph(t),"tokenChanged",t.qa),pn(ph(t),"userDeleted",t.za),pn(ph(t),"userInvalidated",t.Aa),Cl(ph(t))),e&&(e.W.push(t.Ba),hn(e,"tokenChanged",t.qa),hn(e,"userDeleted",t.za),hn(e,"userInvalidated",t.Aa),0<t.u&&Sl(e)),Jr(t,"currentUser",e),e&&(e.xa(t.la()),bl(e,t),Il(e,t.J),Tl(e,t),_l(e,t.R),wl(e,t))}function fh(t,e){var n=null,r=null;return yh(t,e.then((function(e){return n=jo(e),r=$i(e),function(t,e){var n={};return n.apiKey=dh(t).options.apiKey,n.authDomain=dh(t).options.authDomain,n.appName=dh(t).name,t.R&&(n.emulatorConfig=t.R),t.$.then((function(){return function(t,e,n,r){var i=new ml(t,e);return n&&(i.ha=n),r&&Il(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return ph(t)&&e.uid==ph(t).uid?(Fl(ph(t),e),t.da(e)):(hh(t,e),Nl(e),t.da(e))})).then((function(){gh(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=il(e.w(),t,I(t.kc,t))),n||e})).then((function(){return ti({user:ph(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function dh(t){return t.app}function ph(t){return t.currentUser}function vh(t){return ph(t)&&ph(t)._lat||null}function gh(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](vh(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](vh(t))}}function yh(t,e){return t.P.push(e),e.oa((function(){X(t.P,e)})),e}function mh(){}function _h(){this.a={},this.b=1e12}$l.prototype.yb=function(t){var e=null,n=this;return function(t){var e=new k("invalid-persistence-type"),n=new k("unsupported-persistence-type");t:{for(r in Zu)if(Zu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Er()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!xu()&&"none"!==t)throw n;break;default:if(!Dr()&&"none"!==t)throw n}}(t),ih(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Jl(n,t)})).then((function(){if(n.c=th(t),e)return n.b.set(n.c,e,n.a)})):Ne()}))},S(oh,Tn),S(ah,Je),S(sh,Je),S(uh,Je),(t=oh.prototype).yb=function(t){return yh(this,t=this.i.yb(t))},t.xa=function(t){this.aa===t||this.l||(this.aa=t,is(this.a,this.aa),this.dispatchEvent(new ah(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=u.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new k("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&!t&&br().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.R={url:t,ec:e},this.settings.jb=!0,os(this.a,this.R),this.dispatchEvent(new sh(this.R))}},t.Gc=function(t){this.J.push(t),ss(this.a,r.default.SDK_VERSION?Pr(r.default.SDK_VERSION,this.J):null),this.dispatchEvent(new uh(this.J))},t.Ga=function(){return Z(this.J)},t.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:dh(this).options.apiKey,authDomain:dh(this).options.authDomain,appName:dh(this).name,currentUser:ph(this)&&ph(this).w()}},t.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return fh(i,bs(i.a,o))}))},t.Xc=function(t){if(!Or())return Pe(new k("operation-not-supported-in-this-environment"));var e=this,n=Xi(t.providerId),i=Vr(),o=null;(!Fr()||Ir())&&dh(this).options.authDomain&&t.isOAuthProvider&&(o=mu(dh(this).options.authDomain,dh(this).options.apiKey,dh(this).name,"signInViaPopup",t,null,i,r.default.SDK_VERSION||null,null,null,this.T(),this.R));var a=yr(o,n&&n.va,n&&n.ua);return yh(this,n=ch(this).then((function(n){return Fc(n,a,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new Ie((function(t,n){e.na("signInViaPopup",null,new k("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=jc(e.b,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&gr(a),t?ti(t):null})).o((function(t){throw a&&gr(a),t})))},t.Yc=function(t){if(!Or())return Pe(new k("operation-not-supported-in-this-environment"));var e=this;return yh(this,ch(this).then((function(){return function(t){return ih(t,(function(){return t.b.set(Zl,t.c.F,t.a)}))}(e.i)})).then((function(){return qc(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.ra=function(){var t=this;return lh(this).then((function(e){return t.b&&Gc(t.b.b),e})).o((function(e){throw t.b&&Gc(t.b.b),e}))},t.dd=function(t){if(!t)return Pe(new k("null-user"));if(this.S!=t.tenantId)return Pe(new k("tenant-id-mismatch"));var e=this,n={};n.apiKey=dh(this).options.apiKey,n.authDomain=dh(this).options.authDomain,n.appName=dh(this).name;var r=function(t,e,n,r){var i=t.h,o={};return o[Za]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new ml(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&Il(e,r),Fl(e,t),e}(t,n,e.D,e.Ga());return yh(this,this.h.then((function(){if(dh(e).options.apiKey!=t.l)return r.reload()})).then((function(){return ph(e)&&t.uid==ph(e).uid?(Fl(ph(e),t),e.da(t)):(hh(e,r),Nl(r),e.da(r))})).then((function(){gh(e)})))},t.Bb=function(){var t=this;return yh(this,this.h.then((function(){return t.b&&Gc(t.b.b),ph(t)?(hh(t,null),nh(t.i).then((function(){gh(t)}))):Ne()})))},t.Zc=function(){var t=this;return rh(this.i,dh(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=ph(t)&&e){n=ph(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Fl(ph(t),e),ph(t).I();(ph(t)||e)&&(hh(t,e),e&&(Nl(e),e.ha=t.D),t.b&&Dc(t.b,t),gh(t))}}))},t.da=function(t){return eh(this.i,t)},t.mc=function(){gh(this),this.da(ph(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()},t.kc=function(t){var e=this;return this.h.then((function(){return fh(e,Ne(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(ph(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.N.push(e),yh(t,t.h.then((function(){!t.l&&Y(t.N,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(vh(t)))})))}(this,(function(){t.next(ph(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(ph(r)):"function"==typeof t.next&&t.next(ph(r))})),this.Pa(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"==typeof t?t(ph(r)):"function"==typeof t.next&&t.next(ph(r))})),this.ib(t,e,n)},t.nc=function(t){var e=this;return yh(this,this.h.then((function(){return ph(e)?ph(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return fh(e,ru(e.a,$s,{token:t}))})).then((function(t){var n=t.user;return Ml(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return fh(n,ru(n.a,Js,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return fh(n,ru(n.a,Cs,{email:t,password:e}))}))},t.ab=function(t){var e=this;return this.h.then((function(){return fh(e,t.ka(e.a))}))},t.Sc=function(t){return Xr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},t.Ab=function(){var t=this;return this.h.then((function(){var e=ph(t);if(e&&e.isAnonymous){var n=ti({providerId:null,isNewUser:!1});return ti({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return fh(t,t.a.Ab()).then((function(e){var n=e.user;return Ml(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return ph(this)&&ph(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&ph(this)&&Sl(ph(this))},t.Pc=function(t){var e=this;W(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&ph(this)&&Cl(ph(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),yh(this,this.h.then((function(){e.l||Y(e.s,t)&&t(vh(e))})))},t.removeAuthTokenListener=function(t){$(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(th("local"),t.a,this.ja),this.b&&(Oc(this.b,this),Gc(this.b.b)),Promise.resolve()},t.hc=function(t){return yh(this,function(t,e){return ru(t,ks,{identifier:e,continueUri:Lr()?fr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Oo(t)},t.xb=function(t,e){var n=this;return yh(this,Ne().then((function(){var t=new xi(e);if(!t.c)throw new k("argument-error",Li+" must be true when sending sign in link to email");return Bi(t)})).then((function(e){return n.a.xb(t,e)})).then((function(){})))},t.jd=function(t){return this.Sa(t).then((function(t){return t.data.email}))},t.ob=function(t,e){return yh(this,this.a.ob(t,e).then((function(){})))},t.Sa=function(t){return yh(this,this.a.Sa(t).then((function(t){return new ci(t)})))},t.kb=function(t){return yh(this,this.a.kb(t).then((function(){})))},t.wb=function(t,e){var n=this;return yh(this,Ne().then((function(){return void 0===e||vt(e)?{}:Bi(new xi(e))})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.Wc=function(t,e){return yh(this,Jc(this,t,e,I(this.ab,this)))},t.Vc=function(t,e){var n=this;return yh(this,Ne().then((function(){var r=e||fr(),i=Do(t,r);if(!(r=Oo(r)))throw new k("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new k("tenant-id-mismatch");return n.ab(i)})))},mh.prototype.render=function(){},mh.prototype.reset=function(){},mh.prototype.getResponse=function(){},mh.prototype.execute=function(){};var bh=null;function wh(t,e){return(e=Ih(e))&&t.a[e]||null}function Ih(t){return(t=void 0===t?1e12:t)?t.toString():null}function Th(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=le(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():hn(this.f,"click",this.i)}function Eh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Sh(){}function Ch(){}_h.prototype.render=function(t,e){return this.a[this.b.toString()]=new Th(t,e),this.b++},_h.prototype.reset=function(t){var e=wh(this,t);t=Ih(t),e&&t&&(e.delete(),delete this.a[t])},_h.prototype.getResponse=function(t){return(t=wh(this,t))?t.getResponse():null},_h.prototype.execute=function(t){(t=wh(this,t))&&t.execute()},Th.prototype.getResponse=function(){return Eh(this),this.b},Th.prototype.execute=function(){Eh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},Th.prototype.delete=function(){Eh(this),this.g=!0,clearTimeout(this.a),this.a=null,pn(this.f,"click",this.i)},Jr(Sh,"FACTOR_ID","phone"),Ch.prototype.g=function(){return bh||(bh=new _h),Ne(bh)},Ch.prototype.c=function(){};var kh=null;function Ah(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Nh=new bt(Et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Ph=new Hr(3e4,6e4);Ah.prototype.g=function(t){var e=this;return new Ie((function(n,r){var i=setTimeout((function(){r(new k("network-request-failed"))}),Ph.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new k("internal-error"));delete u[e.a]},Ne(Ha(At(Nh,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new k("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},Ah.prototype.c=function(){this.b--};var Rh=null;function xh(t,e,n,r,i,o,a){if(Jr(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,a?(kh||(kh=new Ch),a=kh):(Rh||(Rh=new Ah),a=Rh),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Lh])throw new k("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Mh],!u.document)throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!le(e)||!this.i&&le(e).hasChildNodes())throw new k("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new $a(t,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var c=this.a[Dh];this.a[Dh]=function(t){if(Fh(s,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=xr(c,u);"function"==typeof e&&e(t)}};var l=this.a[Oh];this.a[Oh]=function(){if(Fh(s,null),"function"==typeof l)l();else if("string"==typeof l){var t=xr(l,u);"function"==typeof t&&t()}}}var Dh="callback",Oh="expired-callback",Lh="sitekey",Mh="size";function Fh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Uh(t,e){return t.h.push(e),e.oa((function(){X(t.h,e)})),e}function qh(t){if(t.J)throw new k("internal-error","RecaptchaVerifier instance has been destroyed.")}function jh(t,e,n){var i=!1;try{this.b=n||r.default.app()}catch(t){throw new k("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new k("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}a=r.default.SDK_VERSION?Pr(r.default.SDK_VERSION,a):null,xh.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),a,D(N),i)}function Vh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new k("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Bh.length)throw new k("internal-error","Argument validator received an unsupported number of arguments.");n=Bh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new k("argument-error",t+" failed: "+r)}(t=xh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Uh(this,Ne().then((function(){if(Lr()&&!Tr())return br();throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,ru(t.s,js,{})})).then((function(e){t.a[Lh]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){qh(this);var t=this;return Uh(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=le(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ce&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Wt(a.name),'"'),a.type){o.push(' type="',Wt(a.type),'"');var s={};mt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ge(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):he(o,a)),2<r.length&&ve(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){qh(this);var t=this;return Uh(this,this.render().then((function(e){return new Ie((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){$(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){qh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){qh(this),this.J=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=le(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},S(jh,xh);var Bh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Kh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Hh(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Wh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:g}}function Gh(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function zh(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function Qh(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function Yh(t,e){return g(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Xh(t){return g(t)&&"string"==typeof t.uid}function $h(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Jh(t,e){for(var n in e){var r=e[n].name;t[r]=ef(r,t[n],e[n].j)}}function Zh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:T((function(t){return this[t]}),n),set:T((function(t,e,n,r){Vh(t,[n],[r],!0),this[e]=r}),r,n,e[n].lb),enumerable:!0})}}function tf(t,e,n,r){t[e]=ef(e,n,r)}function ef(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Vh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Jh(oh.prototype,{kb:{name:"applyActionCode",j:[Kh("code")]},Sa:{name:"checkActionCode",j:[Kh("code")]},ob:{name:"confirmPasswordReset",j:[Kh("code"),Kh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Kh("email"),Kh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Kh("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Kh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[$h(Wh(),Gh(),"nextOrObserver"),Gh("opt_error",!0),Gh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[$h(Wh(),Gh(),"nextOrObserver"),Gh("opt_error",!0),Gh("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Kh("email"),$h(Wh("opt_actionCodeSettings",!0),zh(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Kh("email"),Wh("actionCodeSettings")]},yb:{name:"setPersistence",j:[Kh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Qh()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Qh()]},Tc:{name:"signInWithCustomToken",j:[Kh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Kh("email"),Kh("password")]},Vc:{name:"signInWithEmailLink",j:[Kh("email"),Kh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Kh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[$h({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof ml)}},zh(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Kh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Kh("url"),Wh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Kh("code")]}}),Zh(oh.prototype,{lc:{name:"languageCode",lb:$h(Kh(),zh(),"languageCode")},ti:{name:"tenantId",lb:$h(Kh(),zh(),"tenantId")}}),oh.Persistence=Zu,oh.Persistence.LOCAL="local",oh.Persistence.SESSION="session",oh.Persistence.NONE="none",Jh(ml.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Hh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Hh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Qh()]},rb:{name:"linkWithCredential",j:[Qh()]},Dc:{name:"linkWithPhoneNumber",j:[Kh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Qh()]},ub:{name:"reauthenticateWithCredential",j:[Qh()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Kh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[$h(Wh("opt_actionCodeSettings",!0),zh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Kh(null,!0)]},cd:{name:"unlink",j:[Kh("provider")]},Cb:{name:"updateEmail",j:[Kh("email")]},Db:{name:"updatePassword",j:[Kh("password")]},ed:{name:"updatePhoneNumber",j:[Qh("phone")]},Eb:{name:"updateProfile",j:[Wh("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Kh("email"),$h(Wh("opt_actionCodeSettings",!0),zh(null,!0),"opt_actionCodeSettings",!0)]}}),Jh(_h.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jh(mh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jh(Ie.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Zh(Xc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Hh("appVerificationDisabledForTesting")}}),Jh($c.prototype,{confirm:{name:"confirm",j:[Kh("verificationCode")]}}),tf(lo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[mo,Ro,Mo,vo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[$h(Kh(),Wh(),"json")]),tf(xo,"credential",(function(t,e){return new Po(t,e)}),[Kh("email"),Kh("password")]),Jh(Po.prototype,{w:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(Io.prototype,{Ca:{name:"addScope",j:[Kh("scope")]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),tf(Io,"credential",To,[$h(Kh(),Wh(),"token")]),tf(xo,"credentialWithLink",Do,[Kh("email"),Kh("emailLink")]),Jh(Eo.prototype,{Ca:{name:"addScope",j:[Kh("scope")]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),tf(Eo,"credential",So,[$h(Kh(),Wh(),"token")]),Jh(Co.prototype,{Ca:{name:"addScope",j:[Kh("scope")]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),tf(Co,"credential",ko,[$h(Kh(),$h(Wh(),zh()),"idToken"),$h(Kh(),zh(),"accessToken",!0)]),Jh(Ao.prototype,{Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),tf(Ao,"credential",No,[$h(Kh(),Wh(),"token"),Kh("secret",!0)]),Jh(wo.prototype,{Ca:{name:"addScope",j:[Kh("scope")]},credential:{name:"credential",j:[$h(Kh(),$h(Wh(),zh()),"optionsOrIdToken"),$h(Kh(),zh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),Jh(go.prototype,{w:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(fo.prototype,{w:{name:"toJSON",j:[Kh(null,!0)]}}),tf(Uo,"credential",qo,[Kh("verificationId"),Kh("verificationCode")]),Jh(Uo.prototype,{gb:{name:"verifyPhoneNumber",j:[$h(Kh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Yh(t.session,uo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Yh(t.session,co)&&Xh(t.multiFactorHint):t.session&&t.multiFactorUid?Yh(t.session,co)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Jh(Lo.prototype,{w:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(k.prototype,{toJSON:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(Qo.prototype,{toJSON:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(zo.prototype,{toJSON:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(rl.prototype,{toJSON:{name:"toJSON",j:[Kh(null,!0)]}}),Jh(tl.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}]}}),Jh(cl.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}},Kh("displayName",!0)]},bd:{name:"unenroll",j:[$h({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Xh},Kh(),"multiFactorInfoIdentifier")]}}),Jh(jh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),tf(Ti,"parseLink",Ri,[Kh("link")]),tf(Sh,"assertion",(function(t){return new sl(t)}),[Qh("phone")]),function(){if(void 0===r.default||!r.default.INTERNAL||!r.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:hi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:li,VERIFY_AND_CHANGE_EMAIL:fi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:oh,AuthCredential:lo,Error:k};tf(t,"EmailAuthProvider",xo,[]),tf(t,"FacebookAuthProvider",Io,[]),tf(t,"GithubAuthProvider",Eo,[]),tf(t,"GoogleAuthProvider",Co,[]),tf(t,"TwitterAuthProvider",Ao,[]),tf(t,"OAuthProvider",wo,[Kh("providerId")]),tf(t,"SAMLAuthProvider",bo,[Kh("providerId")]),tf(t,"PhoneAuthProvider",Uo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof oh)}}]),tf(t,"RecaptchaVerifier",jh,[$h(Kh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Wh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.default.app.App)}}]),tf(t,"ActionCodeURL",Ti,[]),tf(t,"PhoneMultiFactorGenerator",Sh,[]),r.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new oh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:I((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:I(t.nc,t),addAuthTokenListener:I(t.cc,t),removeAuthTokenListener:I(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.default.registerVersion("@firebase/auth","0.16.7"),r.default.INTERNAL.extendNamespace({User:ml})}()}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n(899);var i=n(765),o=n(936),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var u,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},l=l||{},h=c||self;function f(){}function d(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:m).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function w(){return Date.now()}function I(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Pb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ka=function(){!this.j&&(this.j=!0,this.H(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++g)}(this)},T.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},S=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function C(t){return Array.prototype.concat.apply([],arguments)}function k(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function A(t){return/^[\s\xa0]*$/.test(t)}var N,P=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,e){return-1!=t.indexOf(e)}function x(t,e){return t<e?-1:t>e?1:0}t:{var D=h.navigator;if(D){var O=D.userAgent;if(O){N=O;break t}}N=""}function L(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function M(t){var e={};for(var n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function q(t){return q[" "](t),t}q[" "]=f;var j,V,B=R(N,"Opera"),K=R(N,"Trident")||R(N,"MSIE"),H=R(N,"Edge"),W=H||K,G=R(N,"Gecko")&&!(R(N.toLowerCase(),"webkit")&&!R(N,"Edge"))&&!(R(N,"Trident")||R(N,"MSIE"))&&!R(N,"Edge"),z=R(N.toLowerCase(),"webkit")&&!R(N,"Edge");function Q(){var t=h.document;return t?t.documentMode:void 0}t:{var Y="",X=(V=N,G?/rv:([^\);]+)(\)|;)/.exec(V):H?/Edge\/([\d\.]+)/.exec(V):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(V):z?/WebKit\/(\S+)/.exec(V):B?/(?:Version)[ \/]?(\S+)/.exec(V):void 0);if(X&&(Y=X?X[1]:""),K){var $=Q();if(null!=$&&$>parseFloat(Y)){j=String($);break t}}j=Y}var J,Z={};function tt(t){return function(t,e){var n=Z;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=P(String(j)).split("."),r=P(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=x(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||x(0==a[2].length,0==s[2].length)||x(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}h.document&&K?J=Q()||parseInt(j,10)||void 0:J=void 0;var et=J,nt=!K||9<=Number(et),rt=K&&!tt("9"),it=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{h.addEventListener("test",f,e),h.removeEventListener("test",f,e)}catch(t){}return t}();function ot(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function at(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(G){t:{try{q(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ot.prototype.b=function(){this.defaultPrevented=!0},I(at,ot);var st={2:"touch",3:"pen",4:"mouse"};at.prototype.b=function(){at.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ut="closure_listenable_"+(1e6*Math.random()|0),ct=0;function lt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++ct,this.Y=this.Z=!1}function ht(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ft(t){this.src=t,this.a={},this.b=0}function dt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=E(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ht(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}ft.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=pt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new lt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var vt="closure_lm_"+(1e6*Math.random()|0),gt={};function yt(t,e,n,r,i){if(r&&r.once)return _t(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);return null}return n=kt(n),t&&t[ut]?t.wa(e,n,p(r)?!!r.capture:!!r,i):mt(t,e,n,!1,r,i)}function mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i;if(a&&!nt)return null;var s=St(t);if(s||(t[vt]=s=new ft(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Et,e=nt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)it||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(It(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)_t(t,e[o],n,r,i);return null}return n=kt(n),t&&t[ut]?t.xa(e,n,p(r)?!!r.capture:!!r,i):mt(t,e,n,!0,r,i)}function bt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);else r=p(r)?!!r.capture:!!r,n=kt(n),t&&t[ut]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=pt(o=t.a[e],n,r,i))&&(ht(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=St(t))&&(e=t.a[e.toString()],t=-1,e&&(t=pt(e,n,r,i)),(n=-1<t?e[t]:null)&&wt(n))}function wt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ut])dt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(It(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=St(e))?(dt(n,t),0==n.b&&(n.src=null,e[vt]=null)):ht(t)}}}function It(t){return t in gt?gt[t]:gt[t]="on"+t}function Tt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&wt(t),n.call(r,e)}function Et(t,e){if(t.Y)return!0;if(!nt){if(!e)t:{e=["window","event"];for(var n=h,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Tt(t,e=new at(e,this))}return Tt(t,new at(e,this))}function St(t){return(t=t[vt])instanceof ft?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function kt(t){return"function"==typeof t?t:(t[Ct]||(t[Ct]=function(e){return t.handleEvent(e)}),t[Ct])}function At(){T.call(this),this.c=new ft(this),this.J=this,this.D=null}function Nt(t,e){var n,r=t.D;if(r)for(n=[];r;r=r.D)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new ot(e,t);else if(e instanceof ot)e.target=e.target||t;else{var i=e;U(e=new ot(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.a=n[o];i=Pt(a,r,!0,e)&&i}if(i=Pt(a=e.a=t,r,!0,e)&&i,i=Pt(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Pt(a=e.a=n[o],r,!1,e)&&i}function Pt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&dt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}I(At,T),At.prototype[ut]=!0,(u=At.prototype).addEventListener=function(t,e,n,r){yt(this,t,e,n,r)},u.removeEventListener=function(t,e,n,r){bt(this,t,e,n,r)},u.H=function(){if(At.X.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ht(n[r]);delete e.a[t],e.b--}}this.D=null},u.wa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},u.xa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Rt=h.JSON.stringify;function xt(){this.b=this.a=null}var Dt,Ot=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Mt}),(function(t){t.reset()}));function Lt(){var t=jt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Mt(){this.next=this.b=this.a=null}function Ft(t){h.setTimeout((function(){throw t}),0)}function Ut(t,e){Dt||function(){var t=h.Promise.resolve(void 0);Dt=function(){t.then(Vt)}}(),qt||(Dt(),qt=!0),jt.add(t,e)}xt.prototype.add=function(t,e){var n=Ot.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Mt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Mt.prototype.reset=function(){this.next=this.b=this.a=null};var qt=!1,jt=new xt;function Vt(){for(var t;t=Lt();){try{t.a.call(t.b)}catch(t){Ft(t)}var e=Ot;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}qt=!1}function Bt(t,e){At.call(this),this.b=t||1,this.a=e||h,this.f=_(this.eb,this),this.g=w()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Ht(t,e,n){if("function"==typeof t)n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function Wt(t){t.a=Ht((function(){t.a=null,t.c&&(t.c=!1,Wt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}I(Bt,At),(u=Bt.prototype).aa=!1,u.M=null,u.eb=function(){if(this.aa){var t=w()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Nt(this,"tick"),this.aa&&(Kt(this),this.start()))}},u.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=w())},u.H=function(){Bt.X.H.call(this),Kt(this),delete this.a};var Gt=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Wt(this)},e.prototype.H=function(){t.prototype.H.call(this),this.a&&(h.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function zt(t){T.call(this),this.b=t,this.a={}}I(zt,T);var Qt=[];function Yt(t,e,n,r){Array.isArray(n)||(n&&(Qt[0]=n.toString()),n=Qt);for(var i=0;i<n.length;i++){var o=yt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Xt(t){L(t.a,(function(t,e){this.a.hasOwnProperty(e)&&wt(t)}),t),t.a={}}function $t(){this.a=!0}function Jt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Rt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}zt.prototype.H=function(){zt.X.H.call(this),Xt(this)},zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$t.prototype.info=function(){};var Zt={},te=null;function ee(){return te=te||new At}function ne(t){ot.call(this,Zt.Ga,t)}function re(t){var e=ee();Nt(e,new ne(e,t))}function ie(t,e){ot.call(this,Zt.STAT_EVENT,t),this.stat=e}function oe(t){var e=ee();Nt(e,new ie(e,t))}function ae(t){ot.call(this,Zt.Ha,t)}function se(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return h.setTimeout((function(){t()}),e)}Zt.Ga="serverreachability",I(ne,ot),Zt.STAT_EVENT="statevent",I(ie,ot),Zt.Ha="timingevent",I(ae,ot);var ue={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},ce={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function le(){}function he(t){return t.b||(t.b=t.c())}function fe(){}le.prototype.b=null;var de,pe={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function ve(){ot.call(this,"d")}function ge(){ot.call(this,"c")}function ye(){}function me(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new zt(this),this.P=_e,t=W?125:void 0,this.R=new Bt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}I(ve,ot),I(ge,ot),I(ye,le),ye.prototype.a=function(){return new XMLHttpRequest},ye.prototype.c=function(){return{}},de=new ye;var _e=45e3,be={},we={};function Ie(t,e,n){t.G=1,t.i=He(Ue(e)),t.j=n,t.I=!0,Te(t,null)}function Te(t,e){t.u=w(),Ce(t),t.l=Ue(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),rn(n.b,"t",r),t.D=0,t.a=Jn(t.g,t.g.C?e:null),0<t.O&&(t.F=new Gt(_(t.Da,t,t.a),t.O)),Yt(t.J,t.a,"readystatechange",t.bb),e=t.B?M(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),re(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ee(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Se(t,n);if(i==we){4==e&&(t.h=4,oe(14),r=!1),Jt(t.c,t.f,null,"[Incomplete Response]");break}if(i==be){t.h=4,oe(15),Jt(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Jt(t.c,t.f,i,null),Re(t,i)}4==e&&0==n.length&&(t.h=1,oe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Hn(e),e.F=!0,oe(11))):(Jt(t.c,t.f,n,"[Invalid Chunked Response]"),Pe(t),Ne(t))}function Se(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?we:(n=Number(e.substring(n,r)),isNaN(n)?be:(r+=1)+n>e.length?we:(e=e.substr(r,n),t.D=r+n,e))}function Ce(t){t.T=w()+t.P,ke(t,t.P)}function ke(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=se(_(t.$a,t),e)}function Ae(t){t.o&&(h.clearTimeout(t.o),t.o=null)}function Ne(t){0==t.g.v||t.A||zn(t.g,t)}function Pe(t){Ae(t);var e=t.F;e&&"function"==typeof e.ka&&e.ka(),t.F=null,Kt(t.R),Xt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ka())}function Re(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||hn(n.b,t)))if(n.I=t.N,!t.C&&hn(n.b,t)&&3==n.v){try{var r=n.la.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Gn(n),Ln(n)}Kn(n),oe(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=se(_(n.Xa,n),6e3));if(1>=ln(n.b)&&n.fa){try{n.fa()}catch(t){}n.fa=void 0}}else Yn(n,11)}else if((t.C||n.a==t)&&Gn(n),!A(e))for(e=r=n.la.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var a=i[4];null!=a&&(n.qa=a,n.c.info("SVER="+n.qa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(R(l,"spdy")||R(l,"quic")||R(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(fn(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,Ke(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=w()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).ma=$n(u,u.C?u.ha:null,u.ga),d.C){dn(u.b,d);var p=d,v=u.D;v&&p.setTimeout(v),p.o&&(Ae(p),Ce(p)),u.a=d}else Bn(u);0<n.g.length&&Un(n)}else"stop"!=i[0]&&"close"!=i[0]||Yn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Yn(n,7):On(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);re(4)}catch(t){}}function xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)S(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(d(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function De(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof De)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Oe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Le(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Le(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Le(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(u=me.prototype).setTimeout=function(t){this.P=t},u.bb=function(t){t=t.target;var e=this.F;e&&3==Pn(t)?e.f():this.Da(t)},u.Da=function(t){try{if(t==this.a)t:{var e=Pn(this.a),n=this.a.va(),r=this.a.W();if(!(3>e||3==e&&!W&&!this.a.$())){this.A||4!=e||7==n||re(8==n||0>=r?3:2),Ae(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(a)){var u=a;break e}}u=null}if(!u){this.b=!1,this.h=3,oe(12),Pe(this),Ne(this);break t}Jt(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Re(this,u)}this.I?(Ee(this,e,o),W&&this.b&&3==e&&(Yt(this.J,this.R,"tick",this.ab),this.R.start())):(Jt(this.c,this.f,o,null),Re(this,o)),4==e&&Pe(this),this.b&&!this.A&&(4==e?zn(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,oe(12)):(this.h=0,oe(13)),Pe(this),Ne(this)}}}catch(t){}},u.ab=function(){if(this.a){var t=Pn(this.a),e=this.a.$();this.D<e.length&&(Ae(this),Ee(this,t,e),this.b&&4!=t&&Ce(this))}},u.cancel=function(){this.A=!0,Pe(this)},u.$a=function(){this.o=null;var t=w();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.G&&(re(3),oe(17)),Pe(this),this.h=2,Ne(this)):ke(this,this.T-t)},(u=De.prototype).K=function(){Oe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},u.L=function(){return Oe(this),this.a.concat()},u.get=function(t,e){return Le(this.b,t)?this.b[t]:e},u.set=function(t,e){Le(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},u.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Me=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Fe){this.a=void 0!==e?e:t.a,qe(this,t.f),this.j=t.j,je(this,t.c),Ve(this,t.h),this.g=t.g,e=t.b;var n=new Ze;n.c=e.c,e.a&&(n.a=new De(e.a),n.b=e.b),Be(this,n),this.i=t.i}else t&&(n=String(t).match(Me))?(this.a=!!e,qe(this,n[1]||"",!0),this.j=We(n[2]||""),je(this,n[3]||"",!0),Ve(this,n[4]),this.g=We(n[5]||"",!0),Be(this,n[6]||"",!0),this.i=We(n[7]||"")):(this.a=!!e,this.b=new Ze(null,this.a))}function Ue(t){return new Fe(t)}function qe(t,e,n){t.f=n?We(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function je(t,e,n){t.c=n?We(e,!0):e}function Ve(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Be(t,e,n){e instanceof Ze?(t.b=e,function(t,e){e&&!t.f&&(tn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(en(this,e),rn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Ge(e,$e)),t.b=new Ze(e,t.a))}function Ke(t,e,n){t.b.set(e,n)}function He(t){return Ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),t}function We(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ge(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Fe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ge(e,Qe,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Ge(e,Qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ge(n,"/"==n.charAt(0)?Xe:Ye,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ge(n,Je)),t.join("")};var Qe=/[#\/\?@]/g,Ye=/[#\?:]/g,Xe=/[#\?]/g,$e=/[#\?@]/g,Je=/#/g;function Ze(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function tn(t){t.a||(t.a=new De,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function en(t,e){tn(t),e=on(t,e),Le(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Le((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Oe(t)))}function nn(t,e){return tn(t),e=on(t,e),Le(t.a.b,e)}function rn(t,e,n){en(t,e),0<n.length&&(t.c=null,t.a.set(on(t,e),k(n)),t.b+=n.length)}function on(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(u=Ze.prototype).add=function(t,e){tn(this),this.c=null,t=on(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},u.forEach=function(t,e){tn(this),this.a.forEach((function(n,r){S(n,(function(n){t.call(e,n,r,this)}),this)}),this)},u.L=function(){tn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},u.K=function(t){tn(this);var e=[];if("string"==typeof t)nn(this,t)&&(e=C(e,this.a.get(on(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=C(e,t[n])}return e},u.set=function(t,e){return tn(this),this.c=null,nn(this,t=on(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},u.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},u.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var an=function(t,e){this.b=t,this.a=e};function sn(t){this.g=t||un,t=h.PerformanceNavigationTiming?0<(t=h.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(h.ja&&h.ja.za&&h.ja.za()&&h.ja.za().Qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var un=10;function cn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ln(t){return t.b?1:t.a?t.a.size:0}function hn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function fn(t,e){t.a?t.a.add(e):t.b=e}function dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function pn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=s(t.a.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return k(t.c)}function vn(){}function gn(){this.a=new vn}function yn(t,e,n){var r=n||"";try{xe(t,(function(t,n){var i=t;p(t)&&(i=Rt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function mn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}sn.prototype.cancel=function(){var t,e;if(this.c=pn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=s(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},vn.prototype.stringify=function(t){return h.JSON.stringify(t,void 0)},vn.prototype.parse=function(t){return h.JSON.parse(t,void 0)};var _n=h.JSON.parse;function bn(t){At.call(this),this.headers=new De,this.l=t||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=wn,this.F=this.G=!1}I(bn,At);var wn="",In=/^https?$/i,Tn=["POST","PUT"];function En(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),An(t)}function Cn(t){t.A||(t.A=!0,Nt(t,"complete"),Nt(t,"error"))}function kn(t){if(t.b&&void 0!==l&&(!t.u[1]||4!=Pn(t)||2!=t.W()))if(t.m&&4==Pn(t))Ht(t.Aa,0,t);else if(Nt(t,"readystatechange"),4==Pn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.C).match(Me)[1]||null;if(!o&&h.self&&h.self.location){var a=h.self.location.protocol;o=a.substr(0,a.length-1)}i=!In.test(o?o.toLowerCase():"")}e=i}if(e)Nt(t,"complete"),Nt(t,"success");else{t.h=6;try{var s=2<Pn(t)?t.a.statusText:""}catch(n){s=""}t.f=s+" ["+t.W()+"]",Cn(t)}}finally{An(t)}}}function An(t,e){if(t.a){Nn(t);var n=t.a,r=t.u[0]?f:null;t.a=null,t.u=null,e||Nt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Nn(t){t.a&&t.F&&(t.a.ontimeout=null),t.o&&(h.clearTimeout(t.o),t.o=null)}function Pn(t){return t.a?t.a.readyState:0}function Rn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return L(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ke(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Dn(t){this.qa=0,this.g=[],this.c=new $t,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=xn("failFast",!1,t),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=xn("baseRetryDelayMs",5e3,t),this.Sa=xn("retryDelaySeedMs",1e4,t),this.Na=xn("forwardChannelMaxRetries",2,t),this.na=xn("forwardChannelRequestTimeoutMs",2e4,t),this.Oa=t&&t.xmlHttpFactory||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new sn(t&&t.concurrentRequestLimit),this.la=new gn,this.ea=t&&t.fastHandshake||!1,this.Ja=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&t&&t.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function On(t){if(Mn(t),3==t.v){var e=t.R++,n=Ue(t.B);Ke(n,"SID",t.J),Ke(n,"RID",e),Ke(n,"TYPE","terminate"),jn(t,n),(e=new me(t,t.c,e,void 0)).G=2,e.i=He(Ue(n)),n=!1,h.navigator&&h.navigator.sendBeacon&&(n=h.navigator.sendBeacon(e.i.toString(),"")),!n&&h.Image&&((new Image).src=e.i,n=!0),n||(e.a=Jn(e.g,null),e.a.ba(e.i)),e.u=w(),Ce(e)}Xn(t)}function Ln(t){t.a&&(Hn(t),t.a.cancel(),t.a=null)}function Mn(t){Ln(t),t.j&&(h.clearTimeout(t.j),t.j=null),Gn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&h.clearTimeout(t.h),t.h=null)}function Fn(t,e){t.g.push(new an(t.Pa++,e)),3==t.v&&Un(t)}function Un(t){cn(t.b)||t.h||(t.h=!0,Ut(t.Ca,t),t.u=0)}function qn(t,e){var n;n=e?e.f:t.R++;var r=Ue(t.B);Ke(r,"SID",t.J),Ke(r,"RID",n),Ke(r,"AID",t.P),jn(t,r),t.i&&t.l&&Rn(r,t.i,t.l),n=new me(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Vn(t,n,1e3),n.setTimeout(Math.round(.5*t.na)+Math.round(.5*t.na*Math.random())),fn(t.b,n),Ie(n,r,e)}function jn(t,e){t.f&&xe({},(function(t,n){Ke(e,n,t)}))}function Vn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?_(t.f.Ka,t.f,t):null;t:for(var i=t.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{yn(l,a,"req"+c+"_")}catch(t){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Bn(t){t.a||t.j||(t.T=1,Ut(t.Ba,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=se(_(t.Ba,t),Qn(t,t.o)),t.o++,0))}function Hn(t){null!=t.s&&(h.clearTimeout(t.s),t.s=null)}function Wn(t){t.a=new me(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ue(t.ma);Ke(e,"RID","rpc"),Ke(e,"SID",t.J),Ke(e,"CI",t.G?"0":"1"),Ke(e,"AID",t.P),jn(t,e),Ke(e,"TYPE","xmlhttp"),t.i&&t.l&&Rn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ha,n.G=1,n.i=He(Ue(e)),n.j=null,n.I=!0,Te(n,t)}function Gn(t){null!=t.m&&(h.clearTimeout(t.m),t.m=null)}function zn(t,e){var n=null;if(t.a==e){Gn(t),Hn(t),t.a=null;var r=2}else{if(!hn(t.b,e))return;n=e.s,dn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=w()-e.u;var i=t.u;Nt(r=ee(),new ae(r,n,e,i)),Un(t)}else Bn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ln(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ma?0:t.Na)||(t.h=se(_(t.Ca,t,e),Qn(t,t.u)),t.u++,0)))}(t,e)||2==r&&Kn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Yn(t,5);break;case 4:Yn(t,10);break;case 3:Yn(t,6);break;default:Yn(t,2)}}function Qn(t,e){var n=t.Ia+Math.floor(Math.random()*t.Sa);return t.f||(n*=2),n*e}function Yn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=_(t.cb,t);n||(n=new Fe("//www.google.com/images/cleardot.gif"),h.location&&"http"==h.location.protocol||qe(n,"https"),He(n)),function(t,e){var n=new $t;if(h.Image){var r=new Image;r.onload=b(mn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(mn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(mn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(mn,n,r,"TestLoadImage: timeout",!1,e),h.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else oe(2);t.v=0,t.f&&t.f.sa(e),Xn(t),Mn(t)}function Xn(t){t.v=0,t.I=-1,t.f&&(0==pn(t.b).length&&0==t.g.length||(t.b.c.length=0,k(t.g),t.g.length=0),t.f.ra())}function $n(t,e,n){var r=function(t){return t instanceof Fe?Ue(t):new Fe(t,void 0)}(n);if(""!=r.c)e&&je(r,e+"."+r.c),Ve(r,r.h);else{var i=h.location;r=function(t,e,n,r){var i=new Fe(null,void 0);return t&&qe(i,t),e&&je(i,e),n&&Ve(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&L(t.V,(function(t,e){Ke(r,e,t)})),e=t.A,n=t.oa,e&&n&&Ke(r,e,n),Ke(r,"VER",t.ia),jn(t,r),r}function Jn(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new bn(t.Oa)).G=t.C,e}function Zn(){}function tr(){if(K&&!(10<=Number(et)))throw Error("Environmental error: no available transport.")}function er(t,e){At.call(this),this.a=new Dn(e),this.g=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!A(t)&&(this.a.i=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new ir(this)}function nr(t){ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function rr(){ge.call(this),this.status=1}function ir(t){this.a=t}function or(t){this.f=t}function ar(t){At.call(this),this.u=t,this.h=void 0,this.readyState=sr,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(u=bn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+t);e=e?e.toUpperCase():"GET",this.C=t,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():de.a(),this.u=this.l?he(this.l):he(de),this.a.onreadystatechange=_(this.Aa,this);try{this.B=!0,this.a.open(e,String(t),!0),this.B=!1}catch(t){return void Sn(this,t)}t=n||"";var i=new De(this.headers);r&&xe(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=En,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=h.FormData&&t instanceof h.FormData,!(0<=E(Tn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{Nn(this),0<this.s&&((this.F=function(t){return K&&tt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=_(this.ya,this)):this.o=Ht(this.ya,this.s,this)),this.m=!0,this.a.send(t),this.m=!1}catch(t){Sn(this,t)}},u.ya=function(){void 0!==l&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,Nt(this,"timeout"),this.abort(8))},u.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Nt(this,"complete"),Nt(this,"abort"),An(this))},u.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),An(this,!0)),bn.X.H.call(this)},u.Aa=function(){this.j||(this.B||this.m||this.g?kn(this):this.Za())},u.Za=function(){kn(this)},u.W=function(){try{return 2<Pn(this)?this.a.status:-1}catch(t){return-1}},u.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},u.Qa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),_n(e)}},u.va=function(){return this.h},u.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(u=Dn.prototype).ia=8,u.v=1,u.Ca=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new me(this,this.c,t,void 0),r=this.l;if(this.O&&(r?U(r=M(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Vn(this,n,e),Ke(i=Ue(this.B),"RID",t),Ke(i,"CVER",22),this.A&&Ke(i,"X-HTTP-Session-Id",this.A),jn(this,i),this.i&&r&&Rn(i,this.i,r),fn(this.b,n),this.Ja&&Ke(i,"TYPE","init"),this.ea?(Ke(i,"$req",e),Ke(i,"SID","null"),n.U=!0,Ie(n,i,null)):Ie(n,i,e),this.v=2}}else 3==this.v&&(t?qn(this,t):0==this.g.length||cn(this.b)||qn(this))},u.Ba=function(){if(this.j=null,Wn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=se(_(this.Ya,this),t)}},u.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,oe(10),Ln(this),Wn(this))},u.Xa=function(){null!=this.m&&(this.m=null,Ln(this),Kn(this),oe(19))},u.cb=function(t){t?(this.c.info("Successfully pinged google.com"),oe(2)):(this.c.info("Failed to ping google.com"),oe(1))},(u=Zn.prototype).ua=function(){},u.ta=function(){},u.sa=function(){},u.ra=function(){},u.Ka=function(){},tr.prototype.a=function(t,e){return new er(t,e)},I(er,At),er.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var t=this.a,e=this.g,n=this.b||void 0;oe(0),t.ga=e,t.V=n||{},t.G=t.S,t.B=$n(t,null,t.ga),Un(t)},er.prototype.close=function(){On(this.a)},er.prototype.l=function(t){if("string"==typeof t){var e={};e.__data__=t,Fn(this.a,e)}else this.m?((e={}).__data__=Rt(t),Fn(this.a,e)):Fn(this.a,t)},er.prototype.H=function(){this.a.f=null,delete this.f,On(this.a),delete this.a,er.X.H.call(this)},I(nr,ve),I(rr,ge),I(ir,Zn),ir.prototype.ua=function(){Nt(this.a,"a")},ir.prototype.ta=function(t){Nt(this.a,new nr(t))},ir.prototype.sa=function(t){Nt(this.a,new rr(t))},ir.prototype.ra=function(){Nt(this.a,"b")},I(or,le),or.prototype.a=function(){return new ar(this.f)},or.prototype.c=function(t){return function(){return t}}({}),I(ar,At);var sr=0;function ur(t){t.f.read().then(t.Ta.bind(t)).catch(t.ca.bind(t))}function cr(t){t.readyState=4,t.g=null,t.f=null,t.m=null,lr(t)}function lr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(u=ar.prototype).open=function(t,e){if(this.readyState!=sr)throw this.abort(),Error("Error reopening a connection");this.s=t,this.o=e,this.readyState=1,lr(this)},u.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.o,e)).then(this.Wa.bind(this),this.ca.bind(this))},u.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,cr(this)),this.readyState=sr},u.Wa=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,lr(this)),this.a&&(this.readyState=3,lr(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==h.ReadableStream&&"body"in t?(this.responseText="",this.f=t.body.getReader(),this.m=new TextDecoder,ur(this)):t.text().then(this.Va.bind(this),this.ca.bind(this)))))},u.Ta=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.responseText+=e),t.done?cr(this):lr(this),3==this.readyState&&ur(this)}},u.Va=function(t){this.a&&(this.responseText=t,cr(this))},u.Ua=function(){this.a&&cr(this)},u.ca=function(){this.a&&cr(this)},u.setRequestHeader=function(t,e){this.l.append(t,e)},u.getResponseHeader=function(t){return this.b&&this.b.get(t.toLowerCase())||""},u.getAllResponseHeaders=function(){if(!this.b)return"";for(var t=[],e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ar.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),tr.prototype.createWebChannel=tr.prototype.a,er.prototype.send=er.prototype.l,er.prototype.open=er.prototype.h,er.prototype.close=er.prototype.close,ue.NO_ERROR=0,ue.TIMEOUT=8,ue.HTTP_ERROR=6,ce.COMPLETE="complete",fe.EventType=pe,pe.OPEN="a",pe.CLOSE="b",pe.ERROR="c",pe.MESSAGE="d",At.prototype.listen=At.prototype.wa,bn.prototype.listenOnce=bn.prototype.xa,bn.prototype.getLastError=bn.prototype.Ra,bn.prototype.getLastErrorCode=bn.prototype.va,bn.prototype.getStatus=bn.prototype.W,bn.prototype.getResponseJson=bn.prototype.Qa,bn.prototype.getResponseText=bn.prototype.$,bn.prototype.send=bn.prototype.ba;var hr=ue,fr=ce,dr=Zt,pr=10,vr=11,gr=or,yr=fe,mr=bn,_r=n(163),br=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();br.o=-1;var wr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,_r.__extends)(e,t),e}(Error),Tr=new o.Logger("@firebase/firestore");function Er(){return Tr.logLevel}function Sr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Tr.logLevel<=o.LogLevel.DEBUG){var r=e.map(Ar);Tr.debug.apply(Tr,(0,_r.__spreadArray)(["Firestore (8.6.8): "+t],r))}}function Cr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Tr.logLevel<=o.LogLevel.ERROR){var r=e.map(Ar);Tr.error.apply(Tr,(0,_r.__spreadArray)(["Firestore (8.6.8): "+t],r))}}function kr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Tr.logLevel<=o.LogLevel.WARN){var r=e.map(Ar);Tr.warn.apply(Tr,(0,_r.__spreadArray)(["Firestore (8.6.8): "+t],r))}}function Ar(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Nr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.8) INTERNAL ASSERTION FAILED: "+t;throw Cr(e),new Error(e)}function Pr(t,e){t||Nr()}function Rr(t,e){return t}function xr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Dr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=xr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Or(t,e){return t<e?-1:t>e?1:0}function Lr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Mr(t){return t+"\0"}var Fr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ir(wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ir(wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ir(wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Or(this.nanoseconds,t.nanoseconds):Or(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Ur=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Fr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function qr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Vr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Br=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Nr(),void 0===n?n=t.length-e:n>t.length-e&&Nr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Kr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new Ir(wr.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Br),Hr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Wr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Hr.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ir(wr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ir(wr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ir(wr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ir(wr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Br),Gr=function(){function t(t){this.fields=t,t.sort(Wr.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Lr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),zr=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Or(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();zr.EMPTY_BYTE_STRING=new zr("");var Qr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yr(t){if(Pr(!!t),"string"==typeof t){var e=0,n=Qr.exec(t);if(Pr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Xr(t.seconds),nanos:Xr(t.nanos)}}function Xr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $r(t){return"string"==typeof t?zr.fromBase64String(t):zr.fromUint8Array(t)}function Jr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Zr(t){var e=t.mapValue.fields.__previous_value__;return Jr(e)?Zr(e):e}function ti(t){var e=Yr(t.mapValue.fields.__local_write_time__.timestampValue);return new Fr(e.seconds,e.nanos)}function ei(t){return null==t}function ni(t){return 0===t&&1/t==-1/0}function ri(t){return"number"==typeof t&&Number.isInteger(t)&&!ni(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ii=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Kr.fromString(e))},t.fromName=function(e){return new t(Kr.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Kr.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Kr.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Kr(e.slice()))},t}();function oi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Jr(t)?4:10:Nr()}function ai(t,e){var n=oi(t);if(n!==oi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ti(t).isEqual(ti(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Yr(t.timestampValue),r=Yr(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return $r(t.bytesValue).isEqual($r(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Xr(t.geoPointValue.latitude)===Xr(e.geoPointValue.latitude)&&Xr(t.geoPointValue.longitude)===Xr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Xr(t.integerValue)===Xr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Xr(t.doubleValue),r=Xr(e.doubleValue);return n===r?ni(n)===ni(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Lr(t.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(qr(n)!==qr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ai(n[i],r[i])))return!1;return!0}(t,e);default:return Nr()}}function si(t,e){return void 0!==(t.values||[]).find((function(t){return ai(t,e)}))}function ui(t,e){var n=oi(t),r=oi(e);if(n!==r)return Or(n,r);switch(n){case 0:return 0;case 1:return Or(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Xr(t.integerValue||t.doubleValue),r=Xr(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ci(t.timestampValue,e.timestampValue);case 4:return ci(ti(t),ti(e));case 5:return Or(t.stringValue,e.stringValue);case 6:return function(t,e){var n=$r(t),r=$r(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Or(n[i],r[i]);if(0!==o)return o}return Or(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Or(Xr(t.latitude),Xr(e.latitude));return 0!==n?n:Or(Xr(t.longitude),Xr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ui(n[i],r[i]);if(o)return o}return Or(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=Or(r[a],o[a]);if(0!==s)return s;var u=ui(n[r[a]],i[o[a]]);if(0!==u)return u}return Or(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Nr()}}function ci(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Or(t,e);var n=Yr(t),r=Yr(e),i=Or(n.seconds,r.seconds);return 0!==i?i:Or(n.nanos,r.nanos)}function li(t){return hi(t)}function hi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Yr(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?$r(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,ii.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=hi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+hi(t.fields[o])}return e+"}"}(t.mapValue):Nr();var e,n}function fi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function di(t){return!!t&&"integerValue"in t}function pi(t){return!!t&&"arrayValue"in t}function vi(t){return!!t&&"nullValue"in t}function gi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function yi(t){return!!t&&"mapValue"in t}function mi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},Yr(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return jr(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=mi(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=mi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var _i=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!yi(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=mi(e)},t.prototype.setAll=function(t){var e=this,n=Wr.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var a=e.getFieldsMap(n);e.applyChanges(a,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=mi(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());yi(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return ai(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];yi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){jr(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(mi(this.value))},t}();function bi(t){var e=[];return jr(t.fields,(function(t,n){var r=new Wr([t]);if(yi(n)){var i=bi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new Gr(e)}var wi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Ur.min(),_i.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,_i.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,_i.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=_i.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=_i.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ii=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function Ti(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new Ii(t,e,n,r,i,o,a)}function Ei(t){var e=Rr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+li(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ei(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Fi(e.startAt)),e.endAt&&(n+="|ub:",n+=Fi(e.endAt)),e.h=n}return e.h}function Si(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!qi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ai(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vi(t.startAt,e.startAt)&&Vi(t.endAt,e.endAt)}function Ci(t){return ii.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ki=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,_r.__extends)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Ai(t,n,r):"array-contains"===n?new xi(t,r):"in"===n?new Di(t,r):"not-in"===n?new Oi(t,r):"array-contains-any"===n?new Li(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Ni(t,n):new Pi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(ui(e,this.value)):null!==e&&oi(this.value)===oi(e)&&this.m(ui(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Nr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Ai=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ii.fromName(r.referenceValue),i}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){var e=ii.comparator(t.key,this.key);return this.m(e)},e}(ki),Ni=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ri(0,n),r}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ki),Pi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ri(0,n),r}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ki);function Ri(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ii.fromName(t.referenceValue)}))}var xi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return pi(e)&&si(e.arrayValue,this.value)},e}(ki),Di=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&si(this.value.arrayValue,e)},e}(ki),Oi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){if(si(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!si(this.value.arrayValue,e)},e}(ki),Li=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,_r.__extends)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!pi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return si(e.value.arrayValue,t)}))},e}(ki),Mi=function(t,e){this.position=t,this.before=e};function Fi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return li(t)})).join(",")}var Ui=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function qi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ji(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?ii.comparator(ii.fromName(a.referenceValue),n.key):ui(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Vi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ai(t.position[n],e.position[n]))return!1;return!0}var Bi=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function Ki(t,e,n,r,i,o,a,s){return new Bi(t,e,n,r,i,o,a,s)}function Hi(t){return new Bi(t)}function Wi(t){return!ei(t.limit)&&"F"===t.limitType}function Gi(t){return!ei(t.limit)&&"L"===t.limitType}function zi(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Qi(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Yi(t){return null!==t.collectionGroup}function Xi(t){var e=Rr(t);if(null===e.p){e.p=[];var n=Qi(e),r=zi(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ui(n)),e.p.push(new Ui(Wr.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Ui(Wr.keyField(),u))}}}return e.p}function $i(t){var e=Rr(t);if(!e.T)if("F"===e.limitType)e.T=Ti(e.path,e.collectionGroup,Xi(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Xi(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Ui(o.field,a))}var s=e.endAt?new Mi(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Mi(e.startAt.position,!e.startAt.before):null;e.T=Ti(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function Ji(t,e,n){return new Bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zi(t,e){return Si($i(t),$i(e))&&t.limitType===e.limitType}function to(t){return Ei($i(t))+"|lt:"+t.limitType}function eo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+li(e.value);var e})).join(", ")+"]"),ei(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Fi(t.startAt)),t.endAt&&(e+=", endAt: "+Fi(t.endAt)),"Target("+e+")"}($i(t))+"; limitType="+t.limitType+")"}function no(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ii.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ji(t.startAt,Xi(t),e)||t.endAt&&ji(t.endAt,Xi(t),e))}(t,e)}function ro(t){return function(e,n){for(var r=!1,i=0,o=Xi(t);i<o.length;i++){var a=o[i],s=io(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function io(t,e,n){var r=t.field.isKeyField()?ii.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?ui(r,i):Nr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Nr()}}function oo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ni(e)?"-0":e}}function ao(t){return{integerValue:""+t}}function so(t,e){return ri(e)?ao(e):oo(t,e)}var uo=function(){this._=void 0};function co(t,e,n){return t instanceof fo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof po?vo(t,e):t instanceof go?yo(t,e):function(t,e){var n=ho(t,e),r=_o(n)+_o(t.A);return di(n)&&di(t.A)?ao(r):oo(t.R,r)}(t,e)}function lo(t,e,n){return t instanceof po?vo(t,e):t instanceof go?yo(t,e):n}function ho(t,e){return t instanceof mo?di(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e}(uo),po=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,_r.__extends)(e,t),e}(uo);function vo(t,e){for(var n=bo(e),r=function(t){n.some((function(e){return ai(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var go=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,_r.__extends)(e,t),e}(uo);function yo(t,e){for(var n=bo(e),r=function(t){n=n.filter((function(e){return!ai(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var mo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return(0,_r.__extends)(e,t),e}(uo);function _o(t){return Xr(t.integerValue||t.doubleValue)}function bo(t){return pi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var wo=function(t,e){this.field=t,this.transform=e},Io=function(t,e){this.version=t,this.transformResults=e},To=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Eo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var So=function(){};function Co(t,e,n){t instanceof Ro?function(t,e,n){var r=t.value.clone(),i=Oo(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof xo?function(t,e,n){if(Eo(t.precondition,e)){var r=Oo(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Do(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ko(t,e,n){t instanceof Ro?function(t,e,n){if(Eo(t.precondition,e)){var r=t.value.clone(),i=Lo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Po(e),r).setHasLocalMutations()}}(t,e,n):t instanceof xo?function(t,e,n){if(Eo(t.precondition,e)){var r=Lo(t.fieldTransforms,n,e),i=e.data;i.setAll(Do(t)),i.setAll(r),e.convertToFoundDocument(Po(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Eo(t.precondition,e)&&e.convertToNoDocument(Ur.min())}(t,e)}function Ao(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=ho(o.transform,a||null);null!=s&&(null==n&&(n=_i.empty()),n.set(o.field,s))}return n||null}function No(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Lr(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof po&&e instanceof po||t instanceof go&&e instanceof go?Lr(t.elements,e.elements,ai):t instanceof mo&&e instanceof mo?ai(t.A,e.A):t instanceof fo&&e instanceof fo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Po(t){return t.isFoundDocument()?t.version:Ur.min()}var Ro=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return(0,_r.__extends)(e,t),e}(So),xo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return(0,_r.__extends)(e,t),e}(So);function Do(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Oo(t,e,n){var r=new Map;Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,lo(a,s,n[i]))}return r}function Lo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,co(s,u,e))}return r}var Mo,Fo,Uo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return(0,_r.__extends)(e,t),e}(So),qo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return(0,_r.__extends)(e,t),e}(So),jo=function(t){this.count=t};function Vo(t){switch(t){case wr.OK:return Nr();case wr.CANCELLED:case wr.UNKNOWN:case wr.DEADLINE_EXCEEDED:case wr.RESOURCE_EXHAUSTED:case wr.INTERNAL:case wr.UNAVAILABLE:case wr.UNAUTHENTICATED:return!1;case wr.INVALID_ARGUMENT:case wr.NOT_FOUND:case wr.ALREADY_EXISTS:case wr.PERMISSION_DENIED:case wr.FAILED_PRECONDITION:case wr.ABORTED:case wr.OUT_OF_RANGE:case wr.UNIMPLEMENTED:case wr.DATA_LOSS:return!0;default:return Nr()}}function Bo(t){if(void 0===t)return Cr("GRPC error has no .code"),wr.UNKNOWN;switch(t){case Mo.OK:return wr.OK;case Mo.CANCELLED:return wr.CANCELLED;case Mo.UNKNOWN:return wr.UNKNOWN;case Mo.DEADLINE_EXCEEDED:return wr.DEADLINE_EXCEEDED;case Mo.RESOURCE_EXHAUSTED:return wr.RESOURCE_EXHAUSTED;case Mo.INTERNAL:return wr.INTERNAL;case Mo.UNAVAILABLE:return wr.UNAVAILABLE;case Mo.UNAUTHENTICATED:return wr.UNAUTHENTICATED;case Mo.INVALID_ARGUMENT:return wr.INVALID_ARGUMENT;case Mo.NOT_FOUND:return wr.NOT_FOUND;case Mo.ALREADY_EXISTS:return wr.ALREADY_EXISTS;case Mo.PERMISSION_DENIED:return wr.PERMISSION_DENIED;case Mo.FAILED_PRECONDITION:return wr.FAILED_PRECONDITION;case Mo.ABORTED:return wr.ABORTED;case Mo.OUT_OF_RANGE:return wr.OUT_OF_RANGE;case Mo.UNIMPLEMENTED:return wr.UNIMPLEMENTED;case Mo.DATA_LOSS:return wr.DATA_LOSS;default:return Nr()}}(Fo=Mo||(Mo={}))[Fo.OK=0]="OK",Fo[Fo.CANCELLED=1]="CANCELLED",Fo[Fo.UNKNOWN=2]="UNKNOWN",Fo[Fo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fo[Fo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fo[Fo.NOT_FOUND=5]="NOT_FOUND",Fo[Fo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fo[Fo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fo[Fo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fo[Fo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fo[Fo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fo[Fo.ABORTED=10]="ABORTED",Fo[Fo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fo[Fo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fo[Fo.INTERNAL=13]="INTERNAL",Fo[Fo.UNAVAILABLE=14]="UNAVAILABLE",Fo[Fo.DATA_LOSS=15]="DATA_LOSS";var Ko=function(){function t(t,e){this.comparator=t,this.root=e||Wo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Ho(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Ho(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Ho(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Ho(this.root,t,this.comparator,!0)},t}(),Ho=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Wo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Nr();if(this.right.isRed())throw Nr();var t=this.left.check();if(t!==this.right.check())throw Nr();return t+(this.isRed()?0:1)},t}();Wo.EMPTY=null,Wo.RED=!0,Wo.BLACK=!1,Wo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Wo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Go=function(){function t(t){this.comparator=t,this.data=new Ko(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new zo(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new zo(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),zo=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Qo=new Ko(ii.comparator);function Yo(){return Qo}var Xo=new Ko(ii.comparator);function $o(){return Xo}var Jo=new Ko(ii.comparator);function Zo(){return Jo}var ta=new Go(ii.comparator);function ea(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ta,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var na=new Go(Or);function ra(){return na}var ia=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,oa.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Ur.min(),r,ra(),Yo(),ea())},t}(),oa=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(zr.EMPTY_BYTE_STRING,n,ea(),ea(),ea())},t}(),aa=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},sa=function(t,e){this.targetId=t,this.V=e},ua=function(t,e,n,r){void 0===n&&(n=zr.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ca=function(){function t(){this.S=0,this.D=fa(),this.C=zr.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=ea(),e=ea(),n=ea();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Nr()}})),new oa(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=fa()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),la=function(){function t(t){this.W=t,this.G=new Map,this.H=Yo(),this.J=ha(),this.Y=new Go(Or)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Nr()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ci(i))if(0===n){var o=new ii(i.path);this.tt(e,o,wi.newNoDocument(o,Ur.min()))}else Pr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Ci(o.target)){var a=new ii(o.target.path);null!==e.H.get(a)||e.at(i,a)||e.tt(i,a,wi.newNoDocument(a,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=ea();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new ia(t,n,this.Y,this.H,r);return this.H=Yo(),this.J=ha(),this.Y=new Go(Or),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new ca,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Go(Or),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new ca),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ha(){return new Ko(ii.comparator)}function fa(){return new Ko(ii.comparator)}var da={asc:"ASCENDING",desc:"DESCENDING"},pa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},va=function(t,e){this.databaseId=t,this.I=e};function ga(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ya(t,e){return t.I?e.toBase64():e.toUint8Array()}function ma(t,e){return ga(t,e.toTimestamp())}function _a(t){return Pr(!!t),Ur.fromTimestamp(function(t){var e=Yr(t);return new Fr(e.seconds,e.nanos)}(t))}function ba(t,e){return function(t){return new Kr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function wa(t){var e=Kr.fromString(t);return Pr(Wa(e)),e}function Ia(t,e){return ba(t.databaseId,e.path)}function Ta(t,e){var n=wa(e);if(n.get(1)!==t.databaseId.projectId)throw new Ir(wr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ir(wr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ii(ka(n))}function Ea(t,e){return ba(t.databaseId,e)}function Sa(t){var e=wa(t);return 4===e.length?Kr.emptyPath():ka(e)}function Ca(t){return new Kr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ka(t){return Pr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Aa(t,e,n){return{name:Ia(t,e),fields:n.value.mapValue.fields}}function Na(t,e,n){var r=Ta(t,e.name),i=_a(e.updateTime),o=new _i({mapValue:{fields:e.fields}}),a=wi.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Pa(t,e){var n;if(e instanceof Ro)n={update:Aa(t,e.key,e.value)};else if(e instanceof Uo)n={delete:Ia(t,e.key)};else if(e instanceof xo)n={update:Aa(t,e.key,e.data),updateMask:Ha(e.fieldMask)};else{if(!(e instanceof qo))return Nr();n={verify:Ia(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof fo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof po)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof go)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof mo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Nr()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ma(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Nr()}(t,e.precondition)),n}function Ra(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?To.updateTime(_a(t.updateTime)):void 0!==t.exists?To.exists(t.exists):To.none()}(e.currentDocument):To.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Pr("REQUEST_TIME"===e.setToServerValue),n=new fo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new po(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new go(i)}else"increment"in e?n=new mo(t,e.increment):Nr();var o=Wr.fromServerFormat(e.fieldPath);return new wo(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Ta(t,e.update.name),o=new _i({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Gr(e.map((function(t){return Wr.fromServerFormat(t)})))}(e.updateMask);return new xo(i,o,a,n,r)}return new Ro(i,o,n,r)}if(e.delete){var s=Ta(t,e.delete);return new Uo(s,n)}if(e.verify){var u=Ta(t,e.verify);return new qo(u,n)}return Nr()}function xa(t,e){return{documents:[Ea(t,e.path)]}}function Da(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ea(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ea(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(gi(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NAN"}};if(vi(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(gi(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NOT_NAN"}};if(vi(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ja(t.field),op:qa(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:ja(t.field),direction:Ua(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||ei(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ma(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ma(e.endAt)),n}function Oa(t){var e=Sa(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Pr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=La(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Ui(Va(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ei(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Fa(n.startAt));var l=null;return n.endAt&&(l=Fa(n.endAt)),Ki(e,i,s,a,u,"F",c,l)}function La(t){return t?void 0!==t.unaryFilter?[Ka(t)]:void 0!==t.fieldFilter?[Ba(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return La(t)})).reduce((function(t,e){return t.concat(e)})):Nr():[]}function Ma(t){return{before:t.before,values:t.position}}function Fa(t){var e=!!t.before,n=t.values||[];return new Mi(n,e)}function Ua(t){return da[t]}function qa(t){return pa[t]}function ja(t){return{fieldPath:t.canonicalString()}}function Va(t){return Wr.fromServerFormat(t.fieldPath)}function Ba(t){return ki.create(Va(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Nr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ka(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Va(t.unaryFilter.field);return ki.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Va(t.unaryFilter.field);return ki.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Va(t.unaryFilter.field);return ki.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Va(t.unaryFilter.field);return ki.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Nr()}}function Ha(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Wa(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ga(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Qa(e)),e=za(t.get(n),e);return Qa(e)}function za(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Qa(t){return t+""}function Ya(t){var e=t.length;if(Pr(e>=2),2===e)return Pr(""===t.charAt(0)&&""===t.charAt(1)),Kr.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("",o);switch((a<0||a>n)&&Nr(),t.charAt(a+1)){case"":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:Nr()}o=a+2}return new Kr(r)}var Xa=function(t,e){this.seconds=t,this.nanoseconds=e},$a=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};$a.store="owner",$a.key="owner";var Ja=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ja.store="mutationQueues",Ja.keyPath="userId";var Za=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Za.store="mutations",Za.keyPath="batchId",Za.userMutationsIndex="userMutationsIndex",Za.userMutationsKeyPath=["userId","batchId"];var ts=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ga(e)]},t.key=function(t,e,n){return[t,Ga(e),n]},t}();ts.store="documentMutations",ts.PLACEHOLDER=new ts;var es=function(t,e){this.path=t,this.readTime=e},ns=function(t,e){this.path=t,this.version=e},rs=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};rs.store="remoteDocuments",rs.readTimeIndex="readTimeIndex",rs.readTimeIndexPath="readTime",rs.collectionReadTimeIndex="collectionReadTimeIndex",rs.collectionReadTimeIndexPath=["parentPath","readTime"];var is=function(t){this.byteSize=t};is.store="remoteDocumentGlobal",is.key="remoteDocumentGlobalKey";var os=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};os.store="targets",os.keyPath="targetId",os.queryTargetsIndexName="queryTargetsIndex",os.queryTargetsKeyPath=["canonicalId","targetId"];var as=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};as.store="targetDocuments",as.keyPath=["targetId","path"],as.documentTargetsIndex="documentTargetsIndex",as.documentTargetsKeyPath=["path","targetId"];var ss=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ss.key="targetGlobalKey",ss.store="targetGlobal";var us=function(t,e){this.collectionId=t,this.parent=e};us.store="collectionParents",us.keyPath=["collectionId","parent"];var cs=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};cs.store="clientMetadata",cs.keyPath="clientId";var ls=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ls.store="bundles",ls.keyPath="bundleId";var hs=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};hs.store="namedQueries",hs.keyPath="name";var fs=(0,_r.__spreadArray)((0,_r.__spreadArray)([],(0,_r.__spreadArray)((0,_r.__spreadArray)([],(0,_r.__spreadArray)((0,_r.__spreadArray)([],(0,_r.__spreadArray)((0,_r.__spreadArray)([],[Ja.store,Za.store,ts.store,rs.store,os.store,$a.store,ss.store,as.store]),[cs.store])),[is.store])),[us.store])),[ls.store,hs.store]),ds="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ps=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),vs=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},gs=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Nr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),ys=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new vs,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new bs(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Ss(e.target.error);n.ft.reject(new bs(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new bs(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Is(e)},t}(),ms=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t((0,i.getUA)())&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Sr("SimpleDb","Removing database:",t),Ts(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=(0,i.getUA)(),n=t._t(e),r=0<n&&n<10,o=t.Et(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new bs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Ir(wr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new bs(t,n))},i.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Sr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,c,l;return(0,_r.__generator)(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.At(t)];case 2:return s.db=h.sent(),e=ys.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),gs.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,Sr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),_s=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ts(this.Pt.delete())},t}(),bs=function(t){function e(e,n){var r=this;return(r=t.call(this,wr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,_r.__extends)(e,t),e}(Ir);function ws(t){return"IndexedDbTransactionError"===t.name}var Is=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ts(n)},t.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),Ts(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ts(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Sr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),Ts(this.store.delete(t))},t.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),Ts(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){Sr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new gs((function(n,r){e.onerror=function(t){var e=Ss(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new gs((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new _s(i),a=e(i.primaryKey,i.value,o);if(a instanceof gs){var s=a.catch((function(t){return o.done(),gs.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return gs.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ts(t){return new gs((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Ss(t.target.error);n(e)}}))}var Es=!1;function Ss(t){var e=ms._t((0,i.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ir("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Es||(Es=!0,setTimeout((function(){throw r}),0)),r}}return t}var Cs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return(0,_r.__extends)(e,t),e}(ps);function ks(t,e){var n=Rr(t);return ms.It(n.Mt,e)}var As=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Co(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&ko(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&ko(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Ur.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ea())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Lr(this.mutations,t.mutations,(function(t,e){return No(t,e)}))&&Lr(this.baseMutations,t.baseMutations,(function(t,e){return No(t,e)}))},t}(),Ns=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Pr(e.mutations.length===r.length);for(var i=Zo(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),Ps=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Ur.min()),void 0===o&&(o=Ur.min()),void 0===a&&(a=zr.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Rs=function(t){this.Lt=t};function xs(t,e){if(e.document)return Na(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ii.fromSegments(e.noDocument.path),r=Fs(e.noDocument.readTime),i=wi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=ii.fromSegments(e.unknownDocument.path);return r=Fs(e.unknownDocument.version),wi.newUnknownDocument(o,r)}return Nr()}function Ds(t,e,n){var r=Os(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Ia(t,e.key),fields:e.data.value.mapValue.fields,updateTime:ga(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new rs(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=Ms(e.version);return a=e.hasCommittedMutations,new rs(null,new es(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=Ms(e.version);return new rs(new ns(c,l),null,null,!0,r,i)}return Nr()}function Os(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ls(t){var e=new Fr(t[0],t[1]);return Ur.fromTimestamp(e)}function Ms(t){var e=t.toTimestamp();return new Xa(e.seconds,e.nanoseconds)}function Fs(t){var e=new Fr(t.seconds,t.nanoseconds);return Ur.fromTimestamp(e)}function Us(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Ra(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return Ra(t.Lt,e)})),s=Fr.fromMillis(e.localWriteTimeMs);return new As(e.batchId,s,n,a)}function qs(t){var e,n,r=Fs(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Fs(t.lastLimboFreeSnapshotVersion):Ur.min();return void 0!==t.query.documents?(Pr(1===(n=t.query).documents.length),e=$i(Hi(Sa(n.documents[0])))):e=function(t){return $i(Oa(t))}(t.query),new Ps(e,t.targetId,0,t.lastListenSequenceNumber,r,i,zr.fromBase64String(t.resumeToken))}function js(t,e){var n,r=Ms(e.snapshotVersion),i=Ms(e.lastLimboFreeSnapshotVersion);n=Ci(e.target)?xa(t.Lt,e.target):Da(t.Lt,e.target);var o=e.resumeToken.toBase64();return new os(e.targetId,Ei(e.target),r,o,e.sequenceNumber,i,n)}function Vs(t){var e=Oa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ji(e,e.limit,"L"):e}var Bs=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Ks(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Fs(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Ks(t).put({bundleId:(n=e).id,createTime:Ms(_a(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Hs(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Vs(e.bundledQuery),readTime:Fs(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Hs(t).put(function(t){return{name:t.name,readTime:Ms(_a(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ks(t){return ks(t,ls.store)}function Hs(t){return ks(t,hs.store)}var Ws=function(){function t(){this.Bt=new Gs}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),gs.resolve()},t.prototype.getCollectionParents=function(t,e){return gs.resolve(this.Bt.getEntries(e))},t}(),Gs=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Go(Kr.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Go(Kr.comparator)).toArray()},t}(),zs=function(){function t(){this.qt=new Gs}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Ga(i)};return Qs(t).put(o)}return gs.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Mr(e),""],!1,!0);return Qs(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ya(o.parent))}return n}))},t}();function Qs(t){return ks(t,us.store)}var Ys={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xs=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function $s(t,e,n){var r=t.store(Za.store),i=t.store(ts.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){Pr(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=ts.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return gs.waitFor(o).next((function(){return c}))}function Js(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Nr();e=t.noDocument}return JSON.stringify(e).length}Xs.DEFAULT_COLLECTION_PERCENTILE=10,Xs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xs.DEFAULT=new Xs(41943040,Xs.DEFAULT_COLLECTION_PERCENTILE,Xs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xs.DISABLED=new Xs(-1,0,0);var Zs=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return Pr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return eu(t).$t({index:Za.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=nu(t),a=eu(t);return a.add({}).next((function(s){Pr("number"==typeof s);for(var u=new As(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Pa(t.Lt,e)})),i=n.mutations.map((function(e){return Pa(t.Lt,e)}));return new Za(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Go((function(t,e){return Or(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=ts.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,ts.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[s]=u.keys()})),gs.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return eu(t).get(e).next((function(t){return t?(Pr(t.userId===n.userId),Us(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?gs.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return eu(t).$t({index:Za.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Pr(e.batchId>=r),o=Us(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return eu(t).$t({index:Za.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return eu(t).Nt(Za.userMutationsIndex,n).next((function(t){return t.map((function(t){return Us(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ts.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return nu(t).$t({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=Ya(u);if(s===n.userId&&e.path.isEqual(l))return eu(t).get(c).next((function(t){if(!t)throw Nr();Pr(t.userId===n.userId),o.push(Us(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Go(Or),i=[];return e.forEach((function(e){var o=ts.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=nu(t).$t({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=Ya(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),gs.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=ts.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Go(Or);return nu(t).$t({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],l=Ya(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(eu(t).get(e).next((function(t){if(null===t)throw Nr();Pr(t.userId===n.userId),r.push(Us(n.R,t))})))})),gs.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return $s(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),gs.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return gs.resolve();var r=IDBKeyRange.lowerBound(ts.prefixForUser(e.userId)),i=[];return nu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Ya(t[1]);i.push(o)}else r.done()})).next((function(){Pr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return tu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return ru(t).get(this.userId).next((function(t){return t||new Ja(e.userId,-1,"")}))},t}();function tu(t,e,n){var r=ts.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return nu(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function eu(t){return ks(t,Za.store)}function nu(t){return ks(t,ts.store)}function ru(t){return ks(t,Ja.store)}var iu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),ou=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new iu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Ur.fromTimestamp(new Fr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return au(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Pr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return au(t).$t((function(a,s){var u=qs(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return gs.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return au(t).$t((function(t,n){var r=qs(n);e(r)}))},t.prototype.Xt=function(t){return su(t).get(ss.key).next((function(t){return Pr(null!==t),t}))},t.prototype.Zt=function(t,e){return su(t).put(ss.key,e)},t.prototype.te=function(t,e){return au(t).put(js(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Ei(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return au(t).$t({range:r,index:os.queryTargetsIndexName},(function(t,n,r){var o=qs(n);Si(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=uu(t);return e.forEach((function(e){var a=Ga(e.path);i.push(o.put(new as(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),gs.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=uu(t);return gs.forEach(e,(function(e){var o=Ga(e.path);return gs.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=uu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=uu(t),i=ea();return r.$t({range:n,kt:!0},(function(t,e,n){var r=Ya(t[1]),o=new ii(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Ga(e.path),r=IDBKeyRange.bound([n],[Mr(n)],!1,!0),i=0;return uu(t).$t({index:as.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return au(t).get(e).next((function(t){return t?qs(t):null}))},t}();function au(t){return ks(t,os.store)}function su(t){return ks(t,ss.store)}function uu(t){return ks(t,as.store)}function cu(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){if(t.code!==wr.FAILED_PRECONDITION||t.message!==ds)throw t;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function lu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Or(n,i);return 0===a?Or(r,o):a}var hu=function(){function t(t){this.ne=t,this.buffer=new Go(lu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();lu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),fu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return ws(e=n.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,cu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),du=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return gs.resolve(br.o);var r=new hu(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),gs.resolve(Ys)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Ys):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,a,s,u,c,l=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>l.params.maximumSequenceNumbersToCollect?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),r=l.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),l.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),l.removeTargets(t,n,e)})).next((function(e){return i=e,u=Date.now(),l.removeOrphanedDocuments(t,n)})).next((function(t){return c=Date.now(),Er()<=o.LogLevel.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms"),gs.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),pu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new du(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return vu(t,n)},t.prototype.removeReference=function(t,e,n){return vu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return vu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return ru(t).Ot((function(r){return tu(t,r,e).next((function(t){return t&&(n=!0),gs.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),uu(t).delete([0,Ga(a.path)])}))}));i.push(u)}})).next((function(){return gs.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return vu(t,e)},t.prototype.we=function(t,e){var n,r=uu(t),i=br.o;return r.$t({index:as.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==br.o&&e(new ii(Ya(n)),i),i=s,n=a):i=br.o})).next((function(){i!==br.o&&e(new ii(Ya(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function vu(t,e){return uu(t).put(function(t,e){return new as(0,Ga(t.path),e)}(e,t.currentSequenceNumber))}var gu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){jr(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Vr(this.inner)},t}(),yu=function(){function t(){this.changes=new gu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Ur.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:wi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?gs.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),mu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return wu(t).put(Iu(e),n)},t.prototype.removeEntry=function(t,e){var n=wu(t),r=Iu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return wu(t).get(Iu(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return wu(t).get(Iu(e)).next((function(t){return{document:n.ye(e,t),size:Js(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Yo();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Yo(),i=new Ko(ii.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Js(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return gs.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return wu(t).$t({range:r},(function(t,e,r){for(var a=ii.fromSegments(t);o&&ii.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Yo(),o=e.path.length+1,a={};if(n.isEqual(Ur.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=Os(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=rs.collectionReadTimeIndex}return wu(t).$t(a,(function(t,n,a){if(t.length===o){var s=xs(r.R,n);e.path.isPrefixOf(s.key.path)?no(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new _u(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return bu(t).get(is.key).next((function(t){return Pr(!!t),t}))},t.prototype.me=function(t,e){return bu(t).put(is.key,e)},t.prototype.ye=function(t,e){if(e){var n=xs(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Ur.min()))return n}return wi.newInvalidDocument(t)},t}(),_u=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new gu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,_r.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Go((function(t,e){return Or(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=Ds(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Js(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var l=Ds(e.Ie.R,wi.newNoDocument(o,Ur.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),gs.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(yu);function bu(t){return ks(t,is.store)}function wu(t){return ks(t,rs.store)}function Iu(t){return t.path.toArray()}var Tu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Pr(n<r&&n>=0&&r<=11);var o=new ys("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore($a.store)}(t),function(t){t.createObjectStore(Ja.store,{keyPath:Ja.keyPath}),t.createObjectStore(Za.store,{keyPath:Za.keyPath,autoIncrement:!0}).createIndex(Za.userMutationsIndex,Za.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ts.store)}(t),Eu(t),function(t){t.createObjectStore(rs.store)}(t));var a=gs.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(as.store),t.deleteObjectStore(os.store),t.deleteObjectStore(ss.store)}(t),Eu(t)),a=a.next((function(){return function(t){var e=t.store(ss.store),n=new ss(0,0,Ur.min().toTimestamp(),0);return e.put(ss.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(Za.store).Nt().next((function(n){t.deleteObjectStore(Za.store),t.createObjectStore(Za.store,{keyPath:Za.keyPath,autoIncrement:!0}).createIndex(Za.userMutationsIndex,Za.userMutationsKeyPath,{unique:!0});var r=e.store(Za.store),i=n.map((function(t){return r.put(t)}));return gs.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(cs.store,{keyPath:cs.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(is.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(rs.store);e.createIndex(rs.readTimeIndex,rs.readTimeIndexPath,{unique:!1}),e.createIndex(rs.collectionReadTimeIndex,rs.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(ls.store,{keyPath:ls.keyPath})}(t),function(t){t.createObjectStore(hs.store,{keyPath:hs.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(rs.store).$t((function(t,n){e+=Js(n)})).next((function(){var n=new is(e);return t.store(is.store).put(is.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Ja.store),r=t.store(Za.store);return n.Nt().next((function(n){return gs.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Za.userMutationsIndex,i).next((function(r){return gs.forEach(r,(function(r){Pr(r.userId===n.userId);var i=Us(e.R,r);return $s(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(as.store),n=t.store(rs.store);return t.store(ss.store).get(ss.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new Kr(n),a=function(t){return[0,Ga(t)]}(o);r.push(e.get(a).next((function(n){return n?gs.resolve():function(n){return e.put(new as(0,Ga(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return gs.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(us.store,{keyPath:us.keyPath});var n=e.store(us.store),r=new Gs,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Ga(i)})}};return e.store(rs.store).$t({kt:!0},(function(t,e){var n=new Kr(t);return i(n.popLast())})).next((function(){return e.store(ts.store).$t({kt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Ya(n));return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(os.store);return n.$t((function(t,r){var i=qs(r),o=js(e.R,i);return n.put(o)}))},t}();function Eu(t){t.createObjectStore(as.store,{keyPath:as.keyPath}).createIndex(as.documentTargetsIndex,as.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(os.store,{keyPath:os.keyPath}).createIndex(os.queryTargetsIndexName,os.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ss.store)}var Su="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Cu=function(){function t(e,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Ir(wr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pu(this,i),this.Le=n+"main",this.R=new Rs(u),this.Be=new ms(this.Le,11,new Tu(this.R)),this.qe=new ou(this.referenceDelegate,this.R),this.Ut=new zs,this.Ue=function(t,e){return new mu(t,e)}(this.R,this.Ut),this.Qe=new Bs,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===l&&Cr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ir(wr.FAILED_PRECONDITION,Su);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new br(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return(0,_r.__awaiter)(e,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return(0,_r.__awaiter)(e,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Au(e).put(new cs(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(ws(e))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return ku(t).get($a.key).next((function(t){return gs.resolve(e.tn(t))}))},t.prototype.en=function(t){return Au(t).delete(this.clientId)},t.prototype.nn=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=ks(t,cs.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return gs.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)r=n[e],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?gs.resolve(!0):ku(t).get($a.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Ir(wr.FAILED_PRECONDITION,Su);return!1}}return!(!e.networkEnabled||!e.inForeground)||Au(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[$a.store,cs.store],(function(e){var n=new Cs(e,br.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Au(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Zs.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Sr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,fs,(function(o){return i=new Cs(o,r.Ne?r.Ne.next():br.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Cr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Ir(wr.FAILED_PRECONDITION,ds);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return ku(t).get($a.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ir(wr.FAILED_PRECONDITION,Su)}))},t.prototype.Ze=function(t){var e=new $a(this.clientId,this.allowTabSynchronization,Date.now());return ku(t).put($a.key,e)},t.yt=function(){return ms.yt()},t.prototype.Xe=function(t){var e=this,n=ku(t);return n.get($a.key).next((function(t){return e.tn(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete($a.key)):gs.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Cr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Cr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Cr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function ku(t){return ks(t,$a.store)}function Au(t){return ks(t,cs.store)}function Nu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Pu=function(t,e){this.progress=t,this.wn=e},Ru=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return ii.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Yi(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new ii(e)).next((function(t){var e=$o();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=$o();return this.Ut.getCollectionParents(t,i).next((function(a){return gs.forEach(a,(function(a){var s=function(t,e){return new Bi(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=wi.newInvalidDocument(c),r=r.insert(c,l)),ko(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){no(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=ea(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof xo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),xu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ea(),i=ea(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Du=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Ur.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(a){var s=i.Cn(e,a);return(Wi(e)||Gi(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Er()<=o.LogLevel.DEBUG&&Sr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),eo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Go(ro(t));return e.forEach((function(e,r){no(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Er()<=o.LogLevel.DEBUG&&Sr("QueryEngine","Using full collection scan to execute query:",eo(e)),this.Sn.getDocumentsMatchingQuery(t,e,Ur.min())},t}(),Ou=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Ko(Or),this.kn=new gu((function(t){return Ei(t)}),Si),this.$n=Ur.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Ru(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();function Lu(t,e,n,r){return new Ou(t,e,n,r)}function Mu(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return n=Rr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new Ru(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=ea(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Fu(t,e){var n=Rr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=gs.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Pr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Uu(t){var e=Rr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function qu(t,e){var n=Rr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Pr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=Yo();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(ju(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Ur.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return gs.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.Fn=i,t}))}function ju(t,e,n,r,i){var o=ea();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Yo();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(Ur.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):Sr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Vu(t,e){var n=Rr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Bu(t,e){var n=Rr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,gs.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Ps(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function Ku(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:r=Rr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!ws(a=s.sent()))throw a;return Sr("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function Hu(t,e,n){var r=Rr(t),i=Ur.min(),o=ea();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Rr(t),i=r.kn.get(n);return void 0!==i?gs.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,$i(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Ur.min(),n?o:ea())})).next((function(t){return{documents:t,Bn:o}}))}))}function Wu(t,e){var n=Rr(t),r=Rr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Gu(t){var e=Rr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Rr(t),i=Yo(),o=Os(n),a=wu(e),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:rs.readTimeIndex,range:s},(function(t,e){var n=xs(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Ls(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function zu(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){return[2,(e=Rr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=wu(t),n=Ur.min();return e.$t({index:rs.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Ls(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function Qu(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,c,l,h,f,d;return(0,_r.__generator)(this,(function(p){switch(p.label){case 0:for(i=Rr(t),o=ea(),a=Yo(),s=Zo(),u=0,c=n;u<c.length;u++)l=c[u],h=e.qn(l.metadata.name),l.document&&(o=o.add(h)),a=a.insert(h,e.Un(l)),s=s.insert(h,e.Qn(l.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,Bu(i,function(t){return $i(Hi(Kr.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return ju(t,f,a,Ur.min(),s).next((function(e){return f.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function Yu(t,e,n){return void 0===n&&(n=ea()),(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Bu(t,$i(Vs(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Rr(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=_a(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var a=r.withResumeToken(zr.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(t,e)}))}))]}}))}))}var Xu=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return gs.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:_a(n.createTime)}),gs.resolve()},t.prototype.getNamedQuery=function(t,e){return gs.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Vs(t.bundledQuery),readTime:_a(t.readTime)}}(e)),gs.resolve()},t}(),$u=function(){function t(){this.Wn=new Go(Ju.Gn),this.zn=new Go(Ju.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Ju(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Ju(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new ii(new Kr([])),r=new Ju(n,t),i=new Ju(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new ii(new Kr([])),n=new Ju(e,t),r=new Ju(e,t+1),i=ea();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Ju(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Ju=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return ii.comparator(t.key,e.key)||Or(t.ns,e.ns)},t.Hn=function(t,e){return Or(t.ns,e.ns)||ii.comparator(t.key,e.key)},t}(),Zu=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Go(Ju.Gn)}return t.prototype.checkEmpty=function(t){return gs.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new As(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new Ju(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return gs.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return gs.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return gs.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return gs.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return gs.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Ju(e,0),i=new Ju(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),gs.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Go(Or);return e.forEach((function(t){var e=new Ju(t,0),i=new Ju(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),gs.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;ii.isDocumentKey(i)||(i=i.child(""));var o=new Ju(new ii(i),0),a=new Go(Or);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),gs.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Pr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return gs.forEach(e.mutations,(function(i){var o=new Ju(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Ju(e,0),r=this.rs.firstAfterOrEqual(n);return gs.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,gs.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),tc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ko(ii.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return gs.resolve(n?n.document.clone():wi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Yo();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():wi.newInvalidDocument(t))})),gs.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Yo(),i=new ii(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||no(e,c)&&(r=r.insert(c.key,c.clone()))}return gs.resolve(r)},t.prototype.fs=function(t,e){return gs.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new ec(this)},t.prototype.getSize=function(t){return gs.resolve(this.size)},t}(),ec=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return(0,_r.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),gs.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(yu),nc=function(){function t(t){this.persistence=t,this.ds=new gu((function(t){return Ei(t)}),Si),this.lastRemoteSnapshotVersion=Ur.min(),this.highestTargetId=0,this.ws=0,this._s=new $u,this.targetCount=0,this.ys=iu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),gs.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return gs.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return gs.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),gs.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),gs.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new iu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,gs.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),gs.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,gs.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),gs.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return gs.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return gs.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),gs.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),gs.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),gs.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return gs.resolve(n)},t.prototype.containsKey=function(t,e){return gs.resolve(this._s.containsKey(e))},t}(),rc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new br(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new nc(this),this.Ut=new Ws,this.Ue=function(t,e){return new tc(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Rs(e),this.Qe=new Xu(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Zu(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new ic(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return gs.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),ic=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return(0,_r.__extends)(e,t),e}(ps),oc=function(){function t(t){this.persistence=t,this.As=new $u,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Nr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),gs.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),gs.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),gs.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return gs.forEach(this.vs,(function(r){var i=ii.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return gs.or([function(){return gs.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),ac=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function sc(t,e){return"firestore_clients_"+t+"_"+e}function uc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function cc(t,e){return"firestore_targets_"+t+"_"+e}ac.UNAUTHENTICATED=new ac(null),ac.GOOGLE_CREDENTIALS=new ac("google-credentials-uid"),ac.FIRST_PARTY=new ac("first-party-uid");var lc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Ir(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(Cr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),hc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ir(i.error.code,i.error.message)),o?new t(e,i.state,r):(Cr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),fc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=ra(),a=0;i&&a<r.activeTargetIds.length;++a)i=ri(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Cr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),dc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Cr("SharedClientState","Failed to parse online state: "+e),null)},t}(),pc=function(){function t(){this.activeTargetIds=ra()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),vc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Ko(Or),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=sc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new pc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,l,h=this;return(0,_r.__generator)(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(sc(this.persistenceKey,r)))&&(o=fc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(cc(this.persistenceKey,t));if(n){var r=hc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(cc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Sr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Cr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){var t,e,r,i,o,a;return(0,_r.__generator)(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=br.o;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Cr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==br.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new lc(this.currentUser,t,e,n),i=uc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=uc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=cc(this.persistenceKey,t),i=new hc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return fc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return lc.Vs(new ac(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return hc.Vs(r,e)},t.prototype.js=function(t){return dc.Vs(t)},t.prototype.ii=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=ra();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),gc=function(){function t(){this.li=new pc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new pc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),yc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),mc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),_c={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},bc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),wc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return(0,_r.__extends)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var a=new mr;a.listenOnce(fr.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case hr.NO_ERROR:var e=a.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case hr.TIMEOUT:Sr("Connection",'RPC "'+t+'" timed out'),o(new Ir(wr.DEADLINE_EXCEEDED,"Request time out"));break;case hr.HTTP_ERROR:var n=a.getStatus();if(Sr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(wr).indexOf(e)>=0?e:wr.UNKNOWN}(r.status);o(new Ir(s,r.message))}else o(new Ir(wr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ir(wr.UNAVAILABLE,"Connection failed."));break;default:Nr()}}finally{Sr("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new tr,o=ee(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new gr({})),this.Fi(a.initMessageHeaders,e),(0,i.isMobileCordova)()||(0,i.isReactNative)()||(0,i.isElectron)()||(0,i.isIE)()||(0,i.isUWP)()||(0,i.isBrowserExtension)()||(a.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Sr("Connection","Creating WebChannel: "+s,a);var u=r.createWebChannel(s,a),c=!1,l=!1,h=new bc({Ei:function(t){l?Sr("Connection","Not sending because WebChannel is closed:",t):(c||(Sr("Connection","Opening WebChannel transport."),u.open(),c=!0),Sr("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,yr.EventType.OPEN,(function(){l||Sr("Connection","WebChannel transport opened.")})),f(u,yr.EventType.CLOSE,(function(){l||(l=!0,Sr("Connection","WebChannel transport closed"),h.Vi())})),f(u,yr.EventType.ERROR,(function(t){l||(l=!0,kr("Connection","WebChannel transport errored:",t),h.Vi(new Ir(wr.UNAVAILABLE,"The operation could not be completed")))})),f(u,yr.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];Pr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Sr("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Mo[t];if(void 0!==e)return Bo(e)}(o),s=i.message;void 0===a&&(a=wr.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new Ir(a,s)),u.close()}else Sr("Connection","WebChannel received:",n),h.Si(n)}})),f(o,dr.STAT_EVENT,(function(t){t.stat===pr?Sr("Connection","Detected buffering proxy"):t.stat===vr&&Sr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Sr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return Sr("RestConnection","Received: ",t),t}),(function(e){throw kr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.8",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=_c[t];return this.Di+"/v1/"+e+":"+n},t}());function Ic(){return"undefined"!=typeof window?window:null}function Tc(){return"undefined"!=typeof document?document:null}function Ec(t){return new va(t,!0)}var Sc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Cc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Sc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===wr.RESOURCE_EXHAUSTED?(Cr(e.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===wr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Ir(wr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return(0,_r.__awaiter)(t,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),kc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return(0,_r.__extends)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Nr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Pr(void 0===e||"string"==typeof e),zr.fromBase64String(e||"")):(Pr(void 0===e||e instanceof Uint8Array),zr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?wr.UNKNOWN:Bo(t.code);return new Ir(e,t.message||"")}(s);n=new ua(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Ta(t,r.document.name),o=_a(r.document.updateTime);var s=new _i({mapValue:{fields:r.document.fields}}),u=(a=wi.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new aa(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Ta(t,r.document),o=r.readTime?_a(r.readTime):Ur.min(),s=wi.newNoDocument(i,o),a=r.removedTargetIds||[],n=new aa([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Ta(t,r.document),o=r.removedTargetIds||[],n=new aa([],o,i,null);else{if(!("filter"in e))return Nr();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new jo(r),o=l.targetId,n=new sa(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Ur.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ur.min():e.readTime?_a(e.readTime):Ur.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Ca(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ci(r)?{documents:xa(t,r)}:{query:Da(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=ya(t,e.resumeToken):e.snapshotVersion.compareTo(Ur.min())>0&&(n.readTime=ga(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Nr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Ca(this.R),e.removeTarget=t,this.cr(e)},e}(Cc),Ac=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return(0,_r.__extends)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Pr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?_a(t.updateTime):_a(e);return n.isEqual(Ur.min())&&(n=_a(e)),new Io(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=_a(t.commitTime);return this.listener.Tr(n,e)}return Pr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Ca(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Pa(e.R,t)}))};this.cr(n)},e}(Cc),Nc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return(0,_r.__extends)(e,t),e.prototype.br=function(){if(this.Rr)throw new Ir(wr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===wr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ir(wr.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===wr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ir(wr.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Pc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Cr(e),this.Vr=!1):Sr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Rc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return(0,_r.__awaiter)(o,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return jc(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return(e=Rr(t)).Or.add(4),[4,Dc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,xc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Pc(n,r)};function xc(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:if(!jc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Dc(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Oc(t,e){var n=Rr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),qc(n)?Uc(n):el(n).er()&&Mc(n,e))}function Lc(t,e){var n=Rr(t),r=el(n);n.$r.delete(e),r.er()&&Fc(n,e),0===n.$r.size&&(r.er()?r.ir():jc(n)&&n.Br.set("Unknown"))}function Mc(t,e){t.qr.U(e.targetId),el(t).mr(e)}function Fc(t,e){t.qr.U(e),el(t).yr(e)}function Uc(t){t.qr=new la({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),el(t).start(),t.Br.Sr()}function qc(t){return jc(t)&&!el(t).tr()&&t.$r.size>0}function jc(t){return 0===Rr(t).Or.size}function Vc(t){t.qr=void 0}function Bc(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){return t.$r.forEach((function(e,n){Mc(t,e)})),[2]}))}))}function Kc(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(n){return Vc(t),qc(t)?(t.Br.Nr(e),Uc(t)):t.Br.set("Unknown"),[2]}))}))}function Hc(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:if(t.Br.set("Online"),!(e instanceof ua&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.$r.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Wc(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof aa?t.qr.X(e):e instanceof sa?t.qr.rt(e):t.qr.et(e),n.isEqual(Ur.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Uu(t.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(zr.EMPTY_BYTE_STRING,n.snapshotVersion)),Fc(t,e);var r=new Ps(n.target,e,1,n.sequenceNumber);Mc(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,Wc(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Wc(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r=this;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:if(!ws(e))throw e;return t.Or.add(1),[4,Dc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Uu(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return(0,_r.__awaiter)(r,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,xc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Gc(t,e){return e().catch((function(n){return Wc(t,n,e)}))}function zc(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:e=Rr(t),n=nl(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return jc(t)&&t.kr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Vu(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=nl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,Wc(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return Qc(e)&&Yc(e),[2]}}))}))}function Qc(t){return jc(t)&&!nl(t).tr()&&t.kr.length>0}function Yc(t){nl(t).start()}function Xc(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){return nl(t).Ar(),[2]}))}))}function $c(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return(0,_r.__generator)(this,(function(o){for(e=nl(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Jc(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Ns.from(r,e,n),[4,Gc(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,zc(t)];case 2:return o.sent(),[2]}}))}))}function Zc(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e&&nl(t).pr?[4,function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return Vo(r=e.code)&&r!==wr.ABORTED?(n=t.kr.shift(),nl(t).sr(),[4,Gc(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,zc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Qc(t)&&Yc(t),[2]}}))}))}function tl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return n=Rr(t),e?(n.Or.delete(2),[4,xc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Dc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function el(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Rr(t);return r.br(),new kc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Bc.bind(null,t),Ri:Kc.bind(null,t),_r:Hc.bind(null,t)}),t.Mr.push((function(n){return(0,_r.__awaiter)(e,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),qc(t)?Uc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Vc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function nl(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=Rr(t);return r.br(),new Ac(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Xc.bind(null,t),Ri:Zc.bind(null,t),Ir:$c.bind(null,t),Tr:Jc.bind(null,t)}),t.Mr.push((function(n){return(0,_r.__awaiter)(e,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,zc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(Sr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qr}var rl=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new vs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ir(wr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function il(t,e){if(Cr("AsyncQueue",e+": "+t),ws(t))return new Ir(wr.UNAVAILABLE,e+": "+t);throw t}var ol=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ii.comparator(e.key,n.key)}:function(t,e){return ii.comparator(t.key,e.key)},this.keyedMap=$o(),this.sortedSet=new Ko(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),al=function(){function t(){this.Kr=new Ko(ii.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Nr():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),sl=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,ol.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Zi(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ul=function(){this.Wr=void 0,this.listeners=[]},cl=function(){this.queries=new gu((function(t){return to(t)}),Zi),this.onlineState="Unknown",this.Gr=new Set};function ll(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:if(n=Rr(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new ul),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=il(s,"Initialization of query '"+eo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&pl(n),[2]}}))}))}function hl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,_r.__generator)(this,(function(s){return n=Rr(t),r=e.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function fl(t,e){for(var n=Rr(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(a)&&(r=!0);u.Wr=a}}r&&pl(n)}function dl(t,e,n){var r=Rr(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function pl(t){t.Gr.forEach((function(t){t.next()}))}var vl=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new sl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=sl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),gl=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),yl=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Ta(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Na(this.R,t.document,!1):wi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return _a(t)},t}(),ml=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=_l(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new yl(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],l=(e.get(c)||ea()).add(a);e.set(c,l)}}return e},t.prototype.complete=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Qu(this.localStore,new yl(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Yu(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Pu(Object.assign({},this.progress),t))]}}))}))},t}();function _l(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var bl=function(t){this.key=t},wl=function(t){this.key=t},Il=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ea(),this.mutatedKeys=ea(),this.lo=ro(t),this.fo=new ol(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new al,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Wi(this.query)&&i.size===this.query.limit?i.last():null,c=Gi(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=no(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(a=a.add(h),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Wi(this.query)||Gi(this.query))for(;a.size>this.query.limit;){var l=Wi(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new sl(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new al,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ea(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new wl(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new bl(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ea();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return sl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Tl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},El=function(t){this.key=t,this.bo=!1},Sl=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new gu((function(t){return to(t)}),Zi),this.Vo=new Map,this.So=new Set,this.Do=new Ko(ii.comparator),this.Co=new Map,this.No=new $u,this.xo={},this.Fo=new Map,this.ko=iu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Cl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return n=eh(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Bu(n.localStore,$i(e))];case 2:return a=u.sent(),s=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,kl(n,e,r,"current"===s)];case 3:i=u.sent(),n.isPrimaryClient&&Oc(n.remoteStore,a),u.label=4;case 4:return[2,i]}}))}))}function kl(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,c;return(0,_r.__generator)(this,(function(l){switch(l.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,Hu(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(jl(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,Hu(t.localStore,e,!0)];case 1:return i=l.sent(),o=new Il(e,i.Bn),a=o._o(i.documents),s=oa.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(a,t.isPrimaryClient,s),jl(t,n,u.To),c=new Tl(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Al(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return n=Rr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Zi(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Ku(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Lc(n.remoteStore,r.targetId),Ul(n,r.targetId)})).catch(cu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Ul(n,r.targetId),[4,Ku(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Nl(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:r=nh(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Rr(t),i=Fr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ea());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=Ao(c,n.get(c.key));null!=l&&a.push(new xo(c.key,l,bi(l.value.mapValue),To.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ko(Or)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Kl(r,i.changes)];case 3:return s.sent(),[4,zc(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=il(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function Pl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:n=Rr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,qu(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Pr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Pr(r.bo):t.removedDocuments.size>0&&(Pr(r.bo),r.bo=!1))})),[4,Kl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,cu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Rl(t,e,n){var r=Rr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Rr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&pl(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function xl(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:return(r=Rr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new Ko(ii.comparator)).insert(o,wi.newNoDocument(o,Ur.min())),s=ea().add(o),u=new ia(Ur.min(),new Map,new Go(Or),a,s),[4,Pl(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Bl(r),[3,4];case 2:return[4,Ku(r.localStore,e,!1).then((function(){return Ul(r,e,n)})).catch(cu)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Dl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:n=Rr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Fu(n.localStore,e)];case 2:return i=o.sent(),Fl(n,r,null),Ml(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Kl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,cu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ol(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:r=Rr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Pr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Fl(r,e,n),Ml(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Kl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,cu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ll(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:jc((n=Rr(t)).remoteStore)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Rr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=il(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function Ml(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function Fl(t,e,n){var r=Rr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Ul(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||ql(t,e)}))}function ql(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Lc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Bl(t))}function jl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof bl?(t.No.addReference(o.key,e),Vl(t,o)):o instanceof wl?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||ql(t,o.key)):Nr()}}function Vl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Sr("SyncEngine","New document in limbo: "+n),t.So.add(r),Bl(t))}function Bl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new ii(Kr.fromString(e)),r=t.ko.next();t.Co.set(r,new El(n)),t.Do=t.Do.insert(n,r),Oc(t.remoteStore,new Ps($i(Hi(n.path)),r,2,br.o))}}function Kl(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return r=Rr(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){a.push(r.Oo(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=xu.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return(0,_r.__generator)(this,(function(h){switch(h.label){case 0:n=Rr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return gs.forEach(e,(function(e){return gs.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return gs.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!ws(r=h.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.Fn.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(s,l));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function Hl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return(n=Rr(t)).currentUser.isEqual(e)?[3,3]:(Sr("SyncEngine","User change. New user:",e.toKey()),[4,Mu(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new Ir(wr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Kl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Wl(t,e){var n=Rr(t),r=n.Co.get(e);if(r&&r.bo)return ea().add(r.key);var i=ea(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Gl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Hu((n=Rr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&jl(n,e.targetId,i.To),i)]}}))}))}function zl(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){return[2,Gu((e=Rr(t)).localStore).then((function(t){return Kl(e,t)}))]}))}))}function Ql(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=Rr(t),r=Rr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):gs.resolve(null)}))}))}((i=Rr(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,zc(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Fl(i,e,r||null),Ml(i,e),function(t,e){Rr(Rr(t)._n).Gt(e)}(i.localStore,e)):Nr(),a.label=4;case 4:return[4,Kl(i,o)];case 5:return a.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function Yl(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return(0,_r.__generator)(this,(function(l){switch(l.label){case 0:return eh(n=Rr(t)),nh(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Xl(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,tl(n.remoteStore,!0)];case 2:for(l.sent(),o=0,a=i;o<a.length;o++)s=a[o],Oc(n.remoteStore,s);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Ul(n,e),Ku(n.localStore,e,!0)})),Lc(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,Xl(n,u)];case 5:return l.sent(),function(t){var e=Rr(t);e.Co.forEach((function(t,n){Lc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Ko(ii.comparator)}(n),n.$o=!1,[4,tl(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function Xl(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p,v;return(0,_r.__generator)(this,(function(g){switch(g.label){case 0:n=Rr(t),r=[],i=[],o=0,a=e,g.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(c=n.Vo.get(s))&&0!==c.length?[4,Bu(n.localStore,$i(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),l=0,h=c,g.label=3;case 3:return l<h.length?(f=h[l],d=n.Po.get(f),[4,Gl(n,d)]):[3,6];case 4:(p=g.sent()).snapshot&&i.push(p.snapshot),g.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,Wu(n.localStore,s)];case 8:return v=g.sent(),[4,Bu(n.localStore,v)];case 9:return u=g.sent(),[4,kl(n,$l(v),s,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function $l(t){return Ki(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Jl(t){var e=Rr(t);return Rr(Rr(e.localStore).persistence).fn()}function Zl(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return(i=Rr(t)).$o?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Gu(i.localStore)];case 3:return o=s.sent(),a=ia.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Kl(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,Ku(i.localStore,e,!0)];case 6:return s.sent(),Ul(i,e,r),[3,8];case 7:Nr(),s.label=8;case 8:return[2]}}))}))}function th(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f;return(0,_r.__generator)(this,(function(d){switch(d.label){case 0:if(!(r=eh(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(Sr("SyncEngine","Adding an already active target "+a),[3,5]):[4,Wu(r.localStore,a)]):[3,6];case 2:return s=d.sent(),[4,Bu(r.localStore,s)];case 3:return u=d.sent(),[4,kl(r,$l(s),u.targetId,!1)];case 4:d.sent(),Oc(r.remoteStore,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Ku(r.localStore,t,!1).then((function(){Lc(r.remoteStore,t),Ul(r,t)})).catch(cu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,d.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function eh(t){var e=Rr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xl.bind(null,e),e.vo._r=fl.bind(null,e.eventManager),e.vo.Mo=dl.bind(null,e.eventManager),e}function nh(t){var e=Rr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Dl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ol.bind(null,e),e}function rh(t,e,n){var r=Rr(t);(function(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=Rr(t),r=_a(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Qe.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(_l(r)),i=new ml(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=c.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return s=c.sent(),[4,Kl(t,s.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Qe.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(s.progress),[3,15];case 14:return kr("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var ih=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return this.R=Ec(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return Lu(this.persistence,new Du,t.initialUser,this.R)},t.prototype.qo=function(t){return new rc(oc.bs,this.R)},t.prototype.Bo=function(t){return new gc},t.prototype.terminate=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),oh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,_r.__extends)(e,t),e.prototype.initialize=function(e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,zu(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,nh(this.Ko.syncEngine)];case 4:return n.sent(),[4,zc(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return Lu(this.persistence,new Du,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new fu(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Nu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Xs.withCacheSize(this.cacheSizeBytes):Xs.DEFAULT;return new Cu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Ic(),Tc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new gc},e}(ih),ah=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,_r.__extends)(e,t),e.prototype.initialize=function(e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof vc?(this.sharedClientState.syncEngine={ui:Ql.bind(null,n),ai:Zl.bind(null,n),hi:th.bind(null,n),fn:Jl.bind(null,n),ci:zl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return(0,_r.__awaiter)(r,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Yl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Ic();if(!vc.yt(e))throw new Ir(wr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Nu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new vc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(oh),sh=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Rl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Hl.bind(null,this.syncEngine),[4,tl(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new cl},t.prototype.createDatastore=function(t){var e,n=Ec(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new wc(e));return function(t,e,n){return new Nc(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Rl(a.syncEngine,t,0)},o=mc.yt()?new mc:new yc,new Rc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new Sl(t,e,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e=Rr(t),Sr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Dc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function uh(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r;return(0,_r.__generator)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var ch=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),lh=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new vs,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new gl(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),hh=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Ir(wr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return n=Rr(t),r=Ca(n.R)+"/documents",i={documents:e.map((function(t){return Ia(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=Ta(t,e.found.name),r=_a(e.found.updateTime),i=new _i({mapValue:{fields:e.found.fields}});return wi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);var n=Ta(t,e.missing),r=_a(e.readTime);return wi.newNoDocument(n,r)}(t,e):Nr()}(n.R,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());Pr(!!e),s.push(e)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Uo(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=ii.fromPath(n);e.mutations.push(new qo(r,e.precondition(r)))})),[4,function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return n=Rr(t),r=Ca(n.R)+"/documents",i={writes:e.map((function(t){return Pa(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Nr();e=Ur.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(wr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?To.updateTime(e):To.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Ur.min()))throw new Ir(wr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return To.updateTime(e)}return To.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),fh=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Sc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return(0,_r.__awaiter)(t,void 0,void 0,(function(){var t,e,n=this;return(0,_r.__generator)(this,(function(r){return t=new hh(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!ei(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Vo(e)}return!1},t}(),dh=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=ac.UNAUTHENTICATED,this.clientId=Dr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return(0,_r.__awaiter)(r,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return Sr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ir(wr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new vs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return(0,_r.__awaiter)(t,void 0,void 0,(function(){var t,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=il(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function ph(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i=this;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return(0,_r.__awaiter)(i,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Mu(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function vh(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,gh(t)];case 1:return n=i.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return(n=Rr(t)).asyncQueue.verifyOperationInProgress(),Sr("RemoteStore","RemoteStore received new credentials"),r=jc(n),n.Or.add(3),[4,Dc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,xc(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function gh(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,ph(t,new ih)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function yh(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,vh(t,new sh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function mh(t){return gh(t).then((function(t){return t.persistence}))}function _h(t){return gh(t).then((function(t){return t.localStore}))}function bh(t){return yh(t).then((function(t){return t.remoteStore}))}function wh(t){return yh(t).then((function(t){return t.syncEngine}))}function Ih(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,yh(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Cl.bind(null,e.syncEngine),n.onUnlisten=Al.bind(null,e.syncEngine),n)]}}))}))}function Th(t,e,n){var r=this;void 0===n&&(n={});var i=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(r,void 0,void 0,(function(){var r;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new ch({next:function(o){e.enqueueAndForget((function(){return hl(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Ir(wr.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Ir(wr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new vl(Hi(n.path),o,{includeMetadataChanges:!0,so:!0});return ll(t,a)},[4,Ih(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Eh(t,e,n){var r=this;void 0===n&&(n={});var i=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(r,void 0,void 0,(function(){var r;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new ch({next:function(n){e.enqueueAndForget((function(){return hl(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Ir(wr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new vl(n,o,{includeMetadataChanges:!0,so:!0});return ll(t,a)},[4,Ih(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Sh=function(t,e,n,r,i,o,a,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},Ch=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),kh=new Map,Ah=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Nh=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(ac.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ph=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Rh=function(){function t(t){var e=this;this.currentUser=ac.UNAUTHENTICATED,this.oc=new vs,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Sr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Sr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Pr("string"==typeof n.accessToken),new Ah(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new ac(t)},t}(),xh=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=ac.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Dh=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new xh(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(ac.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Oh(t,e,n){if(!n)throw new Ir(wr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Lh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(wr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Mh(t,e,n,r){if(!0===e&&!0===r)throw new Ir(wr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Fh(t){if(!ii.isDocumentKey(t))throw new Ir(wr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Uh(t){if(ii.isDocumentKey(t))throw new Ir(wr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function qh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Nr()}function jh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ir(wr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=qh(t);throw new Ir(wr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Vh(t,e){if(e<=0)throw new Ir(wr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Bh=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(wr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ir(wr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Mh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Kh=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Bh({}),this._settingsFrozen=!1,t instanceof Ch?(this._databaseId=t,this._credentials=new Nh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ir(wr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ch(t.options.projectId)}(t),this._credentials=new Rh(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Ir(wr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Ir(wr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Bh(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Nh;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Dh(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ir(wr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=kh.get(this))&&(Sr("ComponentProvider","Removing Datastore"),kh.delete(this),t.terminate()),Promise.resolve();var t},t}(),Hh=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Gh(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Wh=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Gh=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Hi(r))||this)._path=r,i.type="collection",i}return(0,_r.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Hh(this.firestore,null,new ii(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Wh);function zh(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=(0,i.getModularInstance)(t),Oh("collection","path",e),t instanceof Kh)return Uh(n=Kr.fromString.apply(Kr,(0,_r.__spreadArray)([e],r))),new Gh(t,null,n);if(!(t instanceof Hh||t instanceof Gh))throw new Ir(wr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Uh(n=Kr.fromString.apply(Kr,(0,_r.__spreadArray)([t.path],r)).child(Kr.fromString(e))),new Gh(t.firestore,null,n)}function Qh(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=(0,i.getModularInstance)(t),1===arguments.length&&(e=Dr.u()),Oh("doc","path",e),t instanceof Kh)return Fh(n=Kr.fromString.apply(Kr,(0,_r.__spreadArray)([e],r))),new Hh(t,null,new ii(n));if(!(t instanceof Hh||t instanceof Gh))throw new Ir(wr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Fh(n=t._path.child(Kr.fromString.apply(Kr,(0,_r.__spreadArray)([e],r)))),new Hh(t.firestore,t instanceof Gh?t.converter:null,new ii(n))}function Yh(t,e){return t=(0,i.getModularInstance)(t),e=(0,i.getModularInstance)(e),(t instanceof Hh||t instanceof Gh)&&(e instanceof Hh||e instanceof Gh)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Xh(t,e){return t=(0,i.getModularInstance)(t),e=(0,i.getModularInstance)(e),t instanceof Wh&&e instanceof Wh&&t.firestore===e.firestore&&Zi(t._query,e._query)&&t.converter===e.converter}var $h=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Sc(this,"async_queue_retry"),this.Tc=function(){var e=Tc();e&&Sr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Tc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Tc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise((function(t){})):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.Rc()}))},t.prototype.Rc=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!ws(t=n.sent()))throw t;return Sr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.Rc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ac=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Cr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=rl.createAndSchedule(this,t,e,n,(function(t){return r.bc(t)}));return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Nr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()}))},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Jh(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Zh=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new vs,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),tf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new $h,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return(0,_r.__extends)(e,t),e.prototype._terminate=function(){return this._firestoreClient||nf(this),this._firestoreClient.terminate()},e}(Kh);function ef(t){return t._firestoreClient||nf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function nf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Sh(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new dh(t._credentials,t._queue,r)}function rf(t,e,n){var r=this,i=new vs;return t.asyncQueue.enqueue((function(){return(0,_r.__awaiter)(r,void 0,void 0,(function(){var r;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,ph(t,n)];case 1:return o.sent(),[4,vh(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===wr.FAILED_PRECONDITION||t.code===wr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function of(t){if(t._initialized||t._terminated)throw new Ir(wr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var af=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ir(wr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wr(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),sf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(zr.fromBase64String(e))}catch(e){throw new Ir(wr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(zr.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),uf=function(t){this._methodName=t},cf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ir(wr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ir(wr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Or(this._lat,t._lat)||Or(this._long,t._long)},t}(),lf=/^__.*__$/,hf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new xo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ro(t,this.data,e,this.fieldTransforms)},t}(),ff=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new xo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function df(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Nr()}}var pf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Of(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(df(this.Cc)&&lf.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),vf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Ec(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new pf({Cc:t,methodName:e,Bc:n,path:Wr.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function gf(t){var e=t._freezeSettings(),n=Ec(t._databaseId);return new vf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function yf(t,e,n,r,i,o){void 0===o&&(o={});var a=t.qc(o.merge||o.mergeFields?2:0,e,n,i);Pf("Data must be an object, but it was:",a,r);var s,u,c=Af(r,a);if(o.merge)s=new Gr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=Rf(e,f[h],n);if(!a.contains(d))throw new Ir(wr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Lf(l,d)||l.push(d)}s=new Gr(l),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new hf(new _i(c),s,u)}var mf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+"() can only appear at the top level of your update data"):t.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(uf);function _f(t,e,n){return new pf({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var bf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype._toFieldTransform=function(t){return new wo(t.path,new fo)},e.prototype.isEqual=function(t){return t instanceof e},e}(uf),wf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return(0,_r.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=_f(this,t,!0),n=this.Uc.map((function(t){return kf(t,e)})),r=new po(n);return new wo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(uf),If=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return(0,_r.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=_f(this,t,!0),n=this.Uc.map((function(t){return kf(t,e)})),r=new go(n);return new wo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(uf),Tf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return(0,_r.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=new mo(t.R,so(t.R,this.Qc));return new wo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(uf);function Ef(t,e,n,r){var o=t.qc(1,e,n);Pf("Data must be an object, but it was:",o,r);var a=[],s=_i.empty();jr(r,(function(t,r){var u=Df(e,t,n);r=(0,i.getModularInstance)(r);var c=o.$c(u);if(r instanceof mf)a.push(u);else{var l=kf(r,c);null!=l&&(a.push(u),s.set(u,l))}}));var u=new Gr(a);return new ff(s,u,o.fieldTransforms)}function Sf(t,e,n,r,o,a){var s=t.qc(1,e,n),u=[Rf(e,r,n)],c=[o];if(a.length%2!=0)throw new Ir(wr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var l=0;l<a.length;l+=2)u.push(Rf(e,a[l])),c.push(a[l+1]);for(var h=[],f=_i.empty(),d=u.length-1;d>=0;--d)if(!Lf(h,u[d])){var p=u[d],v=c[d];v=(0,i.getModularInstance)(v);var g=s.$c(p);if(v instanceof mf)h.push(p);else{var y=kf(v,g);null!=y&&(h.push(p),f.set(p,y))}}var m=new Gr(h);return new ff(f,m,s.fieldTransforms)}function Cf(t,e,n,r){return void 0===r&&(r=!1),kf(n,t.qc(r?4:3,e))}function kf(t,e){if(Nf(t=(0,i.getModularInstance)(t)))return Pf("Unsupported field value:",e,t),Af(t,e);if(t instanceof uf)return function(t,e){if(!df(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=kf(o[i],e.Oc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,i.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return so(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Fr.fromDate(t);return{timestampValue:ga(e.R,n)}}if(t instanceof Fr)return n=new Fr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ga(e.R,n)};if(t instanceof cf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof sf)return{bytesValue:ya(e.R,t._byteString)};if(t instanceof Hh){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ba(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+qh(t))}(t,e)}function Af(t,e){var n={};return Vr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jr(t,(function(t,r){var i=kf(r,e.xc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Nf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Fr||t instanceof cf||t instanceof sf||t instanceof Hh||t instanceof uf)}function Pf(t,e,n){if(!Nf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=qh(n);throw"an object"===r?e.Mc(t+" a custom object"):e.Mc(t+" "+r)}}function Rf(t,e,n){if((e=(0,i.getModularInstance)(e))instanceof af)return e._internalPath;if("string"==typeof e)return Df(t,e);throw Of("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var xf=new RegExp("[~\\*/\\[\\]]");function Df(t,e,n){if(e.search(xf)>=0)throw Of("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(af.bind.apply(af,(0,_r.__spreadArray)([void 0],e.split(".")))))._internalPath}catch(r){throw Of("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Of(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new Ir(wr.INVALID_ARGUMENT,(s+=". ")+t+u)}function Lf(t,e){return t.some((function(t){return t.isEqual(e)}))}var Mf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Hh(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Ff(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Uf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Ff=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Mf);function Uf(t,e){return"string"==typeof e?Df(t,e):e instanceof af?e._internalPath:e._delegate._internalPath}var qf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),jf=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return(0,_r.__extends)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Vf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Uf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Mf),Vf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(jf),Bf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new qf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Vf(n._firestore,n._userDataWriter,r.key,r,new qf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ir(wr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new Vf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new qf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Vf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new qf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Kf(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Kf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr()}}function Hf(t,e){return t instanceof jf&&e instanceof jf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Bf&&e instanceof Bf&&t._firestore===e._firestore&&Xh(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Wf(t){if(Gi(t)&&0===t.explicitOrderBy.length)throw new Ir(wr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gf=function(){};function zf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Qf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Kc=e,i.jc=n,i.Wc=r,i.type="where",i}return(0,_r.__extends)(e,t),e.prototype._apply=function(t){var e=gf(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Ir(wr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ed(a,o);for(var u=[],c=0,l=a;c<l.length;c++){var h=l[c];u.push(td(r,t,h))}s={arrayValue:{values:u}}}else s=td(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ed(a,o),s=Cf(n,"where",a,"in"===o||"not-in"===o);var f=ki.create(i,o,s);return function(t,e){if(e.g()){var n=Qi(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=zi(t);null!==r&&nd(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Ir(wr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(wr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Kc,this.jc,this.Wc);return new Wh(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Gf),Yf=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kc=e,r.Gc=n,r.type="orderBy",r}return(0,_r.__extends)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ui(e,n);return function(t,e){if(null===zi(t)){var n=Qi(t);null!==n&&nd(0,n,e.field)}}(t,r),r}(t._query,this.Kc,this.Gc);return new Wh(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Bi(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Gf),Xf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return(0,_r.__extends)(e,t),e.prototype._apply=function(t){return new Wh(t.firestore,t.converter,Ji(t._query,this.zc,this.Hc))},e}(Gf),$f=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return(0,_r.__extends)(e,t),e.prototype._apply=function(t){var e=Zf(t,this.type,this.Jc,this.Yc);return new Wh(t.firestore,t.converter,function(t,e){return new Bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Gf),Jf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return(0,_r.__extends)(e,t),e.prototype._apply=function(t){var e=Zf(t,this.type,this.Jc,this.Yc);return new Wh(t.firestore,t.converter,function(t,e){return new Bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Gf);function Zf(t,e,n,r){if(n[0]=(0,i.getModularInstance)(n[0]),n[0]instanceof Mf)return function(t,e,n,r,i){if(!r)throw new Ir(wr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Xi(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(fi(e,r.key));else{var c=r.data.field(u.field);if(Jr(c))throw new Ir(wr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Mi(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var o=gf(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new Ir(wr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Yi(t)&&-1!==c.indexOf("/"))throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(Kr.fromString(c));if(!ii.isDocumentKey(l))throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new ii(l);s.push(fi(e,h))}else{var f=Cf(n,r,c);s.push(f)}}return new Mi(s,o)}(t._query,t.firestore._databaseId,o,e,n,r)}function td(t,e,n){if("string"==typeof(n=(0,i.getModularInstance)(n))){if(""===n)throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yi(e)&&-1!==n.indexOf("/"))throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Kr.fromString(n));if(!ii.isDocumentKey(r))throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return fi(t,new ii(r))}if(n instanceof Hh)return fi(t,n._key);throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+qh(n)+".")}function ed(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(wr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ir(wr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function nd(t,e,n){if(!n.isEqual(e))throw new Ir(wr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var rd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),oi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Xr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes($r(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Nr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return jr(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new cf(Xr(t.latitude),Xr(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Zr(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ti(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Yr(t);return new Fr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Kr.fromString(t);Pr(Wa(n));var r=new Ch(n.get(1),n.get(3)),i=new ii(n.popFirst(5));return r.isEqual(e)||Cr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function id(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var od=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,_r.__extends)(e,t),e.prototype.convertBytes=function(t){return new sf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Hh(this.firestore,null,e)},e}(rd),ad=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=gf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=sd(t,this._firestore),i=id(r.converter,e,n),o=yf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,To.none())),this},t.prototype.update=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];this._verifyNotCommitted();var a,s=sd(t,this._firestore);return a="string"==typeof(e=(0,i.getModularInstance)(e))||e instanceof af?Sf(this._dataReader,"WriteBatch.update",s._key,e,n,r):Ef(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(a.toMutation(s._key,To.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=sd(t,this._firestore);return this._mutations=this._mutations.concat(new Uo(e._key,To.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Ir(wr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function sd(t,e){if((t=(0,i.getModularInstance)(t)).firestore!==e)throw new Ir(wr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ud=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,_r.__extends)(e,t),e.prototype.convertBytes=function(t){return new sf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Hh(this.firestore,null,e)},e}(rd);function cd(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];t=jh(t,Hh);var a=jh(t.firestore,tf),s=gf(a);return hd(a,[("string"==typeof(e=(0,i.getModularInstance)(e))||e instanceof af?Sf(s,"updateDoc",t._key,e,n,r):Ef(s,"updateDoc",t._key,e)).toMutation(t._key,To.exists(!0))])}function ld(t){for(var e,n,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];t=(0,i.getModularInstance)(t);var s={includeMetadataChanges:!1},u=0;"object"!=typeof o[u]||Jh(o[u])||(s=o[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Jh(o[u])){var d=o[u];o[u]=null===(e=d.next)||void 0===e?void 0:e.bind(d),o[u+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),o[u+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof Hh)l=jh(t.firestore,tf),h=Hi(t._key.path),c={next:function(e){o[u]&&o[u](fd(l,t,e))},error:o[u+1],complete:o[u+2]};else{var p=jh(t,Wh);l=jh(p.firestore,tf),h=p._query;var v=new ud(l);c={next:function(t){o[u]&&o[u](new Bf(l,v,p,t))},error:o[u+1],complete:o[u+2]},Wf(t._query)}return function(t,e,n,r){var i=this,o=new ch(r),a=new vl(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(i,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e=ll,[4,Ih(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(i,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e=hl,[4,Ih(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(ef(l),h,f,c)}function hd(t,e){return function(t,e){var n=this,r=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return n=Nl,[4,wh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(ef(t),e)}function fd(t,e,n){var r=n.docs.get(e._key),i=new ud(t);return new jf(t,i,e._key,r,new qf(n.hasPendingWrites,n.fromCache),e.converter)}var dd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return(0,_r.__extends)(e,t),e.prototype.get=function(e){var n=this,r=sd(e,this._firestore),i=new ud(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new jf(n._firestore,i,r._key,t._document,new qf(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=gf(t)}return t.prototype.get=function(t){var e=this,n=sd(t,this._firestore),r=new od(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Nr();var i=t[0];if(i.isFoundDocument())return new Mf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Mf(e._firestore,r,n._key,null,n.converter);throw Nr()}))},t.prototype.set=function(t,e,n){var r=sd(t,this._firestore),i=id(r.converter,e,n),o=yf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var a,s=sd(t,this._firestore);return a="string"==typeof(e=(0,i.getModularInstance)(e))||e instanceof af?Sf(this._dataReader,"Transaction.update",s._key,e,n,r):Ef(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,a),this},t.prototype.delete=function(t){var e=sd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function pd(){if("undefined"==typeof Uint8Array)throw new Ir(wr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function vd(){if("undefined"==typeof atob)throw new Ir(wr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var gd=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return vd(),new t(sf.fromBase64String(e))},t.fromUint8Array=function(e){return pd(),new t(sf.fromUint8Array(e))},t.prototype.toBase64=function(){return vd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return pd(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),yd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){of(t=jh(t,tf));var n=ef(t),r=t._freezeSettings(),i=new sh;return rf(n,i,new oh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){of(t=jh(t,tf));var e=ef(t),n=t._freezeSettings(),r=new sh;return rf(e,r,new ah(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Ir(wr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new vs;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return ms.yt()?(e=t+"main",[4,ms.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Nu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),md=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ch||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||kr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var o=(t=jh(t,Kh))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var a=(0,i.createMockUserToken)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Ir(wr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Ph(new Ah(a,new ac(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,mh(t)];case 1:return e=r.sent(),[4,bh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Rr(t);return e.Or.delete(0),xc(e)}(n))]}}))}))}))}(ef(jh(this._delegate,tf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,mh(t)];case 1:return e=r.sent(),[4,bh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return(e=Rr(t)).Or.add(0),[4,Dc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(ef(jh(this._delegate,tf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Mh("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(e,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return e=Ll,[4,wh(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(ef(jh(this._delegate,tf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new ch(e);return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Rr(t).Gr.add(e),e.next()},[4,Ih(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Rr(t).Gr.delete(e)},[4,Ih(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(ef(t=jh(t,tf)),Jh(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Ir(wr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new xd(this,zh(this._delegate,t))}catch(t){throw Ed(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Td(this,Qh(this._delegate,t))}catch(t){throw Ed(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Nd(this,function(t,e){if(t=jh(t,Kh),Oh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ir(wr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Wh(t,null,function(t){return new Bi(Kr.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Ed(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,function(t){return yh(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new fh(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(ef(t),(function(n){return e(new dd(t,n))}))}(this._delegate,(function(n){return t(new bd(e,n))}))},t.prototype.batch=function(){var t=this;return ef(this._delegate),new wd(new ad(this._delegate,(function(e){return hd(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Ir(wr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Ir(wr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),_d=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,_r.__extends)(e,t),e.prototype.convertBytes=function(t){return new gd(new sf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Td.tu(e,this.firestore,null)},e}(rd),bd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new _d(t)}return t.prototype.get=function(t){var e=this,n=Dd(t);return this._delegate.get(n).then((function(t){return new kd(e._firestore,new jf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Dd(t);return n?(Lh("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Dd(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,(0,_r.__spreadArray)([a,e,n],i)),this},t.prototype.delete=function(t){var e=Dd(t);return this._delegate.delete(e),this},t}(),wd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Dd(t);return n?(Lh("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Dd(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,(0,_r.__spreadArray)([a,e,n],i)),this},t.prototype.delete=function(t){var e=Dd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Id=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Vf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Ad(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new _d(e),n),i.set(n,o)),o},t}();Id.nu=new WeakMap;var Td=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new _d(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Ir(wr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Hh(n._delegate,r,new ii(e)))},t.tu=function(e,n,r){return new t(n,new Hh(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new xd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new xd(this.firestore,zh(this._delegate,t))}catch(t){throw Ed(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=(0,i.getModularInstance)(t))instanceof Hh&&Yh(this._delegate,t)},t.prototype.set=function(t,e){e=Lh("DocumentReference.set",e);try{return function(t,e,n){t=jh(t,Hh);var r=jh(t.firestore,tf),i=id(t.converter,e,n);return hd(r,[yf(gf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,To.none())])}(this._delegate,t,e)}catch(t){throw Ed(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?cd(this._delegate,t):cd.apply(void 0,(0,_r.__spreadArray)([this._delegate,t,e],n))}catch(t){throw Ed(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return hd(jh((t=this._delegate).firestore,tf),[new Uo(t._key,To.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Sd(e),i=Cd(e,(function(e){return new kd(t.firestore,new jf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return ld(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=jh(t,Hh);var e=jh(t.firestore,tf),n=ef(e),r=new ud(e);return function(t,e){var n=this,r=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Ir(wr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=il(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,_h(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new jf(e,r,t._key,n,new qf(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=jh(t,Hh);var e=jh(t.firestore,tf);return Th(ef(e),t._key,{source:"server"}).then((function(n){return fd(e,t,n)}))}(this._delegate):function(t){t=jh(t,Hh);var e=jh(t.firestore,tf);return Th(ef(e),t._key).then((function(n){return fd(e,t,n)}))}(this._delegate)).then((function(t){return new kd(e.firestore,new jf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Id.eu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Ed(t,e,n){return t.message=t.message.replace(e,n),t}function Sd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Jh(r))return r}return{}}function Cd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Jh(t[0])?t[0]:Jh(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var kd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Td(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Hf(this._delegate,t._delegate)},t}(),Ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,_r.__extends)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(kd),Nd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new _d(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,zf(this._delegate,function(t,e,n){var r=e,i=Uf("where",t);return new Qf(i,r,n)}(e,n,r)))}catch(e){throw Ed(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,zf(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Uf("orderBy",t);return new Yf(r,n)}(e,n)))}catch(e){throw Ed(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,zf(this._delegate,function(t){return Vh("limit",t),new Xf("limit",t,"F")}(e)))}catch(e){throw Ed(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,zf(this._delegate,function(t){return Vh("limitToLast",t),new Xf("limitToLast",t,"L")}(e)))}catch(e){throw Ed(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $f("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Ed(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $f("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Ed(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jf("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Ed(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jf("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Ed(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Xh(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=jh(t,Wh);var e=jh(t.firestore,tf),n=ef(e),r=new ud(e);return function(t,e){var n=this,r=new vs;return t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Hu(t,e,!0)];case 1:return s=u.sent(),r=new Il(e,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=il(a,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,_h(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Bf(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=jh(t,Wh);var e=jh(t.firestore,tf),n=ef(e),r=new ud(e);return Eh(n,t._query,{source:"server"}).then((function(n){return new Bf(e,r,t,n)}))}(this._delegate):function(t){t=jh(t,Wh);var e=jh(t.firestore,tf),n=ef(e),r=new ud(e);return Wf(t._query),Eh(n,t._query).then((function(n){return new Bf(e,r,t,n)}))}(this._delegate)).then((function(t){return new Rd(e.firestore,new Bf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Sd(e),i=Cd(e,(function(e){return new Rd(t.firestore,new Bf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return ld(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Id.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Pd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Ad(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Rd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Nd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Ad(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Pd(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Ad(n._firestore,r))}))},t.prototype.isEqual=function(t){return Hf(this._delegate,t._delegate)},t}(),xd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return(0,_r.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Td(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Td(this.firestore,void 0===t?Qh(this._delegate):Qh(this._delegate,t))}catch(t){throw Ed(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=jh(t.firestore,tf),r=Qh(t),i=id(t.converter,e);return hd(n,[yf(gf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,To.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Td(e.firestore,t)}))},e.prototype.isEqual=function(t){return Yh(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Id.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(Nd);function Dd(t){return jh(t,Hh)}var Od=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(af.bind.apply(af,(0,_r.__spreadArray)([void 0],t)))}return t.documentId=function(){return new t(Wr.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=(0,i.getModularInstance)(t))instanceof af&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Ld=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new bf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new mf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wf("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new If("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Tf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();var Md,Fd,Ud=n(444),qd={Firestore:md,GeoPoint:cf,Timestamp:Fr,Blob:gd,Transaction:bd,WriteBatch:wd,DocumentReference:Td,DocumentSnapshot:kd,Query:Nd,QueryDocumentSnapshot:Ad,QuerySnapshot:Rd,CollectionReference:xd,FieldPath:Od,FieldValue:Ld,setLogLevel:function(t){var e;e=t,Tr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Ud.Component("firestore",(function(t){return function(t,e){return new md(t,new tf(t,e),new yd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},qd)))})(Md=r.default),Md.registerVersion("@firebase/firestore","2.3.7"),(Fd=md).prototype.loadBundle=function(t){return function(t,e){var n=ef(t=jh(t,tf)),r=new Zh;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new lh(t,e)}(function(t,e){if(t instanceof Uint8Array)return uh(t,e);if(t instanceof ArrayBuffer)return uh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,Ec(e));t.asyncQueue.enqueueAndForget((function(){return(0,_r.__awaiter)(i,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return e=rh,[4,wh(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)},Fd.prototype.namedQuery=function(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=Rr(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Qe.getNamedQuery(t,e)}))},[4,_h(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(ef(e=jh(e,tf)),n).then((function(t){return t?new Wh(e,null,t.query):null}))).then((function(t){return t?new Nd(r,t):null}))};var jd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Vd=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return(0,_r.__extends)(e,t),e}(Error),Bd=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Kd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Hd,Wd,Gd,zd=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Kd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Kd(t,(function(t){return e.decode(t)})):t},t}(),Qd=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new zd,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new Bd(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=a.sent())&&(n["X-Firebase-AppCheck"]=r),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=a.sent(),[3,5];case 4:return a.sent(),[2,{status:0,json:null}];case 5:o=null,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,i.json()];case 7:return o=a.sent(),[3,9];case 8:return a.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f,d;return(0,_r.__generator)(this,(function(p){switch(p.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=p.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Vd("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(s),c=u.timer,l=u.promise,[4,Promise.race([Yd(c,this.postJSON(r,i,o)),l,Yd(c,this.cancelAllRequests)])];case 2:if(!(h=p.sent()))throw new Vd("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!jd[s])return new Vd("internal","internal");r=jd[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new Vd(r,i,o)}(h.status,h.json,this.serializer))throw f;if(!h.json)throw new Vd("internal","Response is not valid JSON object.");if(void 0===(d=h.json.data)&&(d=h.json.result),void 0===d)throw new Vd("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function Yd(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}Hd=r.default,Wd=fetch.bind(self),Gd={Functions:Qd},Hd.INTERNAL.registerComponent(new Ud.Component("functions",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new Qd(r,i,a,o,n,Wd)}),"PUBLIC").setServiceProps(Gd).setMultipleInstances(!0)),r.default.registerVersion("@firebase/functions","0.6.12");var Xd,$d=n(15),Jd="w:0.4.29",Zd=((Xd={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Xd["not-registered"]="Firebase Installation is not registered.",Xd["installation-not-found"]="Firebase Installation not found.",Xd["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Xd["app-offline"]="Could not process request. Application offline.",Xd["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Xd),tp=new i.ErrorFactory("installations","Installations",Zd);function ep(t){return t instanceof i.FirebaseError&&t.code.includes("request-failed")}function np(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function rp(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function ip(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,tp.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function op(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function ap(t,e){var n=e.refreshToken,r=op(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function sp(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function up(t,e){var n=e.fid;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return e=np(t),r=op(t),i={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:Jd},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,sp((function(){return fetch(e,o)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(s=u.sent()).fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:rp(s.authToken)}];case 3:return[4,ip("Create Installation",a)];case 4:throw u.sent()}}))}))}function cp(t){return new Promise((function(e){setTimeout(e,t)}))}var lp=/^[cdef][\w-]{21}$/;function hp(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,(0,_r.__spreadArray)([],(0,_r.__read)(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return lp.test(e)?e:""}catch(t){return""}}function fp(t){return t.appName+"!"+t.appId}var dp=new Map;function pp(t,e){var n=fp(t);vp(n,e),function(t,e){var n=yp();n&&n.postMessage({key:t,fid:e}),mp()}(n,e)}function vp(t,e){var n,r,i=dp.get(t);if(i)try{for(var o=(0,_r.__values)(i),a=o.next();!a.done;a=o.next())(0,a.value)(e)}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var gp=null;function yp(){return!gp&&"BroadcastChannel"in self&&((gp=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){vp(t.data.key,t.data.fid)}),gp}function mp(){0===dp.size&&gp&&(gp.close(),gp=null)}var _p,bp="firebase-installations-store",wp=null;function Ip(){return wp||(wp=(0,$d.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(bp)}}))),wp}function Tp(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return n=fp(t),[4,Ip()];case 1:return r=s.sent(),i=r.transaction(bp,"readwrite"),[4,(o=i.objectStore(bp)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||pp(t,e.fid),[2,e]}}))}))}function Ep(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return e=fp(t),[4,Ip()];case 1:return n=i.sent(),[4,(r=n.transaction(bp,"readwrite")).objectStore(bp).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Sp(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return n=fp(t),[4,Ip()];case 1:return r=u.sent(),i=r.transaction(bp,"readwrite"),[4,(o=i.objectStore(bp)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||pp(t,s.fid),[2,s]}}))}))}function Cp(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Sp(t,(function(n){var r=function(t){return Np(t||{fid:hp(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(tp.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,up(t,e)];case 1:return n=i.sent(),[2,Tp(t,n)];case 2:return ep(r=i.sent())&&409===r.customData.serverCode?[4,Ep(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Tp(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:kp(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function kp(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Ap(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,cp(100)];case 3:return o.sent(),[4,Ap(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,Cp(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function Ap(t){return Sp(t,(function(t){if(!t)throw tp.create("installation-not-found");return Np(t)}))}function Np(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Pp(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:return t=function(t,e){var n=e.fid;return np(t)+"/"+n+"/authTokens:generate"}(n,e),i=ap(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:Jd}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,sp((function(){return fetch(t,s)}))];case 1:return(u=c.sent()).ok?[4,u.json()]:[3,3];case 2:return[2,rp(c.sent())];case 3:return[4,ip("Generate Auth Token",u)];case 4:throw c.sent()}}))}))}function Rp(t,e){return void 0===e&&(e=!1),(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Sp(t.appConfig,(function(r){if(!Dp(r))throw tp.create("not-registered");var i,o=r.authToken;if(!e&&(2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i)))return r;if(1===o.requestStatus)return n=function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,xp(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,cp(100)];case 3:return i.sent(),[4,xp(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,Rp(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw tp.create("app-offline");var a=function(t){var e={requestStatus:1,requestTime:Date.now()};return(0,_r.__assign)((0,_r.__assign)({},t),{authToken:e})}(r);return n=function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,Pp(t,e)];case 1:return n=o.sent(),i=(0,_r.__assign)((0,_r.__assign)({},e),{authToken:n}),[4,Tp(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!ep(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,Ep(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=(0,_r.__assign)((0,_r.__assign)({},e),{authToken:{requestStatus:0}}),[4,Tp(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,a),a}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function xp(t){return Sp(t,(function(t){if(!Dp(t))throw tp.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?(0,_r.__assign)((0,_r.__assign)({},t),{authToken:{requestStatus:0}}):t}))}function Dp(t){return void 0!==t&&2===t.registrationStatus}function Op(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Cp(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Lp(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return np(t)+"/"+n}(t,e),r=ap(t,e),i={method:"DELETE",headers:r},[4,sp((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,ip("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function Mp(t){return tp.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new Ud.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Mp("App Configuration");if(!t.name)throw Mp("App Name");try{for(var r=(0,_r.__values)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw Mp(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Cp(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):Rp(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Op(t.appConfig)];case 1:return n.sent(),[4,Rp(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Sp(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw tp.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw tp.create("app-offline");case 3:return[4,Lp(e,n)];case 4:return r.sent(),[4,Ep(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){yp();var n=fp(t),r=dp.get(n);r||(r=new Set,dp.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=fp(t),r=dp.get(n);r&&(r.delete(e),0===r.size&&dp.delete(n),mp())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.29")}(r.default);var Fp,Up=((_p={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',_p["only-available-in-window"]="This method is available in a Window context.",_p["only-available-in-sw"]="This method is available in a service worker context.",_p["permission-default"]="The notification permission was not granted and dismissed instead.",_p["permission-blocked"]="The notification permission was not granted and blocked instead.",_p["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",_p["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",_p["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",_p["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",_p["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",_p["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",_p["token-update-no-token"]="FCM returned no token when updating the user to push.",_p["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",_p["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",_p["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",_p["invalid-vapid-key"]="The public VAPID key must be a string.",_p["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",_p),qp=new i.ErrorFactory("messaging","Messaging",Up),jp="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";function Vp(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,(0,_r.__spreadArray)([],(0,_r.__read)(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Bp(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(Fp||(Fp={}));var Kp="fcm_token_details_db",Hp="fcm_token_object_Store";function Wp(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes(Kp))return[2,null];r.label=2;case 2:return e=null,[4,(0,$d.openDb)(Kp,5,(function(r){return(0,_r.__awaiter)(n,void 0,void 0,(function(){var n,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains(Hp)?[4,(n=r.transaction.objectStore(Hp)).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,n.clear()];case 2:if(s.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:Vp(o.vapidKey)}}}else(3===r.oldVersion||4===r.oldVersion)&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:Vp(o.auth),p256dh:Vp(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:Vp(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,(0,$d.deleteDb)(Kp)];case 4:return r.sent(),[4,(0,$d.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,(0,$d.deleteDb)("undefined")];case 6:return r.sent(),[2,Gp(e)?e:null]}}))}))}function Gp(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var zp="firebase-messaging-store",Qp=null;function Yp(){return Qp||(Qp=(0,$d.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(zp)}}))),Qp}function Xp(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return e=Zp(t),[4,Yp()];case 1:return[4,i.sent().transaction(zp).objectStore(zp).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,Wp(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,$p(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function $p(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return n=Zp(t),[4,Yp()];case 1:return r=o.sent(),[4,(i=r.transaction(zp,"readwrite")).objectStore(zp).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function Jp(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return e=Zp(t),[4,Yp()];case 1:return n=i.sent(),[4,(r=n.transaction(zp,"readwrite")).objectStore(zp).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Zp(t){return t.appConfig.appId}function tv(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return[4,iv(t)];case 1:n=u.sent(),r=ov(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(rv(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),qp.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,qp.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw qp.create("token-subscribe-no-token");return[2,o.token]}}))}))}function ev(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return[4,iv(t)];case 1:n=u.sent(),r=ov(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(rv(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),qp.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,qp.create("token-update-failed",{errorInfo:s});if(!o.token)throw qp.create("token-update-no-token");return[2,o.token]}}))}))}function nv(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return[4,iv(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(rv(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,qp.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),qp.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function rv(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function iv(t){var e=t.appConfig,n=t.installations;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function ov(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==jp&&(o.web.applicationPubKey=i),o}function av(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw qp.create("permission-blocked");return[4,lv(e,n)];case 1:return r=s.sent(),[4,Xp(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:Vp(r.getKey("auth")),p256dh:Vp(r.getKey("p256dh"))},i?[3,3]:[2,cv(t,o)];case 3:if(u=i.subscriptionOptions,l=(c=o).vapidKey===u.vapidKey,h=c.endpoint===u.endpoint,f=c.auth===u.auth,d=c.p256dh===u.p256dh,l&&h&&f&&d)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,nv(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,cv(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,uv({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,l,h,f,d}))}))}function sv(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Xp(t)];case 1:return(n=i.sent())?[4,nv(t,n.token)]:[3,4];case 2:return i.sent(),[4,Jp(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function uv(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,ev(e,t)];case 1:return r=a.sent(),i=(0,_r.__assign)((0,_r.__assign)({},t),{token:r,createTime:Date.now()}),[4,$p(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,sv(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function cv(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,tv(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,$p(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function lv(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Bp(e)})]}}))}))}function hv(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function fv(t){return new Promise((function(e){setTimeout(e,t)}))}var dv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw qp.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,Xp(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:jp,r.label=2;case 2:return[2,av(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return sv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw qp.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw qp.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw qp.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw qp.create("only-available-in-window")},t.prototype.onMessage=function(){throw qp.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw qp.create("only-available-in-window")},t.prototype.onPush=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,yv()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,gv(n,e)]:(r=!1,e.notification?[4,mv(pv(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,fv(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,sv(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,Xp(this.firebaseDependencies)];case 3:return r=i.sent(),[4,sv(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,av(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:jp)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;return i||(hv(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,vv(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,fv(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=Fp.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function pv(t){var e,n=(0,_r.__assign)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function vv(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return[4,yv()];case 1:e=u.sent();try{for(n=(0,_r.__values)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){a={error:t}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function gv(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Fp.PUSH_RECEIVED;try{for(var i=(0,_r.__values)(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function yv(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function mv(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var _v=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Fp.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),hv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw qp.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,av(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=jp),[2]}))}))},t.prototype.updateSwReg=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw qp.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),qp.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,sv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?qp.create("permission-blocked"):qp.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw qp.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw qp.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw qp.create("invalid-sw-registration");if(this.swRegistration)throw qp.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw qp.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw qp.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Fp.NOTIFICATION_CLICKED:return"notification_open";case Fp.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function bv(t){return qp.create("missing-app-config-values",{valueName:t})}var wv={isSupported:Iv};function Iv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}r.default.INTERNAL.registerComponent(new Ud.Component("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw bv("App Configuration Object");if(!t.name)throw bv("App Name");var r=t.options;try{for(var i=(0,_r.__values)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw bv(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Iv())throw qp.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new dv(n):new _v(n)}),"PUBLIC").setServiceProps(wv));var Tv="firebasestorage.googleapis.com",Ev=function(t){function e(n,r){var i=t.call(this,Sv(n),"Firebase Storage: "+r+" ("+Sv(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return(0,_r.__extends)(e,t),e.prototype._codeEquals=function(t){return Sv(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(i.FirebaseError);function Sv(t){return"storage/"+t}function Cv(){return new Ev("unknown","An unknown error occurred, please check the error payload for server response.")}function kv(){return new Ev("canceled","User canceled the upload/download.")}function Av(){return new Ev("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Nv(t){return new Ev("invalid-argument",t)}function Pv(){return new Ev("app-deleted","The Firebase app was deleted.")}function Rv(t){return new Ev("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function xv(t,e){return new Ev("invalid-format","String does not match format '"+t+"': "+e)}function Dv(t){throw new Ev("internal-error","Internal error: "+t)}var Ov={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Lv=function(t,e){this.data=t,this.contentType=e||null};function Mv(t,e){switch(t){case Ov.RAW:return new Lv(Fv(e));case Ov.BASE64:case Ov.BASE64URL:return new Lv(Uv(t,e));case Ov.DATA_URL:return new Lv((n=new jv(e)).base64?Uv(Ov.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw xv(Ov.DATA_URL,"Malformed data URL.")}return Fv(e)}(n.rest),new jv(e).contentType)}var n;throw Cv()}function Fv(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function Uv(t,e){switch(t){case Ov.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw xv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Ov.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw xv(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw xv(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var qv,jv=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw xv(Ov.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},Vv={STATE_CHANGED:"state_changed"},Bv={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Kv(t){switch(t){case"running":case"pausing":case"canceling":return Bv.RUNNING;case"paused":return Bv.PAUSED;case"success":return Bv.SUCCESS;case"canceled":return Bv.CANCELED;case"error":default:return Bv.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(qv||(qv={}));var Hv=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=qv.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=qv.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=qv.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw Dv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Dv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Dv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Dv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Wv=function(){function t(){}return t.prototype.createXhrIo=function(){return new Hv},t}(),Gv=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new Ev("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)",o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===Tv?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var l=u[c],h=l.regex.exec(e);if(h){var f=h[l.indices.bucket],d=h[l.indices.path];d||(d=""),r=new t(f,d),l.postModify(r);break}}if(null==r)throw function(t){return new Ev("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),zv=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function Qv(t){return"string"==typeof t||t instanceof String}function Yv(t){return Xv()&&t instanceof Blob}function Xv(){return"undefined"!=typeof Blob}function $v(t,e,n,r){if(r<e)throw Nv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw Nv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function Jv(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null==n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function Zv(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}var tg=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());!function(t){return void 0!==t}(s)?i():i(s)}catch(t){o(t)}else null!==a?((r=Cv()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?Pv():kv()):o(r=new Ev("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new eg(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function h(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new eg(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===qv.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new eg(a,n))}else{var s=n.getErrorCode()===qv.ABORT;e(!1,new eg(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)l.call.apply(l,(0,_r.__spreadArray)([null,t],e));else{var r;u()||a?l.call.apply(l,(0,_r.__spreadArray)([null,t],e)):(i<64&&(i*=2),1===s?(s=2,r=0):r=1e3*(i+Math.random()),h(r))}}var d=!1;function p(t){d||(d=!0,c||(null!==o?(t||(s=2),clearTimeout(o),h(0)):t||(s=1)))}return h(0),setTimeout((function(){a=!0,p(!0)}),r),p}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),eg=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function ng(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function rg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ng();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Xv())return new Blob(t);throw new Ev("unsupported-environment","This browser doesn't seem to support creating Blobs")}var ig=function(){function t(t,e){var n=0,r="";Yv(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Yv(this.data_)){var r=(i=this.data_,o=e,a=n,i.webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Xv()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(rg.apply(null,r))}var i=e.map((function(t){return Qv(t)?Mv(Ov.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function og(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function ag(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function sg(t,e){return e}var ug=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||sg},cg=null;function lg(){if(cg)return cg;var t=[];t.push(new ug("bucket")),t.push(new ug("generation")),t.push(new ug("metageneration")),t.push(new ug("name","fullPath",!0));var e=new ug("name");e.xform=function(t,e){return function(t){return!Qv(t)||t.length<2?t:ag(t)}(e)},t.push(e);var n=new ug("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new ug("timeCreated")),t.push(new ug("updated")),t.push(new ug("md5Hash",null,!0)),t.push(new ug("cacheControl",null,!0)),t.push(new ug("contentDisposition",null,!0)),t.push(new ug("contentEncoding",null,!0)),t.push(new ug("contentLanguage",null,!0)),t.push(new ug("contentType",null,!0)),t.push(new ug("metadata","customMetadata",!0)),cg=t}function hg(t,e,n){var r=og(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Gv(n,r);return e._makeStorageReference(i)}})}(r,t),r}(t,r,n)}function fg(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var dg=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function pg(t){if(!t)throw Cv()}function vg(t,e){return function(n,r){var i=hg(t,r,e);return pg(null!==i),i}}function gg(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new Ev("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Ev("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new Ev("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new Ev("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function yg(t){var e=gg(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new Ev("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function mg(t,e,n){var r=Jv(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new dg(r,"GET",vg(t,n),i);return o.errorHandler=yg(e),o}function _g(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Jv(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new dg(a,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=og(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new Gv(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var l=c[u];s=t._makeStorageReference(new Gv(e,l.name)),r.items.push(s)}return r}(t,e,r)}(t,e,r);return pg(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=gg(e),u}function bg(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var wg=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function Ig(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){pg(!1)}return pg(!!n&&-1!==(e||["active"]).indexOf(n)),n}var Tg=262144;var Eg=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}};function Sg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Cg=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=lg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=bg(e,r,i),s={name:a.fullPath},u=Jv(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=fg(a,n),h=t.maxUploadRetryTime,f=new dg(u,"POST",(function(t){var e;Ig(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){pg(!1)}return pg(Qv(e)),e}),h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=gg(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new dg(n,"POST",(function(t){var e=Ig(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){pg(!1)}n||pg(!1);var i=Number(n);return pg(!isNaN(i)),new wg(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=gg(e),o}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=Tg*this._chunkMultiplier,n=new wg(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=function(t,e,n,r,i,o,a,s){var u=new wg(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Ev("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f=h+l,d={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},p=r.slice(h,f);if(null===p)throw Av();var v=e.maxUploadRetryTime,g=new dg(n,"POST",(function(t,n){var i,a=Ig(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?vg(e,o)(t,n):null,new wg(s,c,"final"===a,i)}),v);return g.headers=d,g.body=p.uploadData(),g.progressCallback=s||null,g.errorHandler=gg(t),g}(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){Tg*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=mg(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=bg(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+fg(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=ig.getBlob(c,r,l);if(null===h)throw Av();var f={name:u.fullPath},d=Jv(o,t.host),p=t.maxUploadRetryTime,v=new dg(d,"POST",vg(t,n),p);return v.urlParams=f,v.headers=a,v.body=h.uploadData(),v.errorHandler=gg(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=kv(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Kv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new Eg(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(Kv(this._state)){case Bv.SUCCESS:Sg(this._resolve.bind(null,this.snapshot))();break;case Bv.CANCELED:case Bv.ERROR:Sg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(Kv(this._state)){case Bv.RUNNING:case Bv.PAUSED:t.next&&Sg(t.next.bind(t,this.snapshot))();break;case Bv.SUCCESS:t.complete&&Sg(t.complete.bind(t))();break;case Bv.CANCELED:case Bv.ERROR:t.error&&Sg(t.error.bind(t,this._error))();break;default:t.error&&Sg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),kg=function(){function t(t,e){this._service=t,this._location=e instanceof Gv?e:Gv.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new Gv(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return ag(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new Gv(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw Rv(t)},t}();function Ag(t){var e={prefixes:[],items:[]};return Ng(t,e).then((function(){return e}))}function Ng(t,e,n){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Pg(t,{pageToken:n})];case 1:return r=a.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,Ng(t,e,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Pg(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return null!=e&&"number"==typeof e.maxResults&&$v("options.maxResults",1,1e3,e.maxResults),n=e||{},r=_g(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function Rg(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=Jv(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new dg(r,"GET",function(t,e){return function(n,r){var i=hg(t,r,e);return pg(null!==i),function(t,e,n){var r=og(e);if(null===r)return null;if(!Qv(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return Jv("/b/"+o(r)+"/o/"+o(i),n)+Zv({alt:"media",token:e})}))[0]}(i,r,t.host)}}(t,n),i);return o.errorHandler=yg(e),o}(t.storage,t._location,lg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new Ev("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function xg(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Gv(t._location.bucket,n);return new kg(t.storage,r)}function Dg(t){return/^[A-Za-z]+:\/\//.test(t)}function Og(t,e){if(t instanceof Fg){var n=t;if(null==n._bucket)throw new Ev("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new kg(n,n._bucket);return null!=e?Og(r,e):r}if(void 0!==e){if(e.includes(".."))throw Nv('`path` param cannot contain ".."');return xg(t,e)}return t}function Lg(t,e){if(e&&Dg(e)){if(t instanceof Fg)return new kg(t,e);throw Nv("To use ref(service, url), the first argument must be a Storage instance.")}return Og(t,e)}function Mg(t,e){var n=null==e?void 0:e.storageBucket;return null==n?null:Gv.makeFromBucketSpec(n,t)}var Fg=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=Tv,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Gv.makeFromBucketSpec(i,this._host):Mg(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=Gv.makeFromBucketSpec(this._url,t):this._bucket=Mg(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){$v("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){$v("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new kg(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new zv(Pv());var i=function(t,e,n,r,i,o){var a=Zv(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new tg(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=i.sent(),n=e[0],r=e[1],[2,this._makeRequest(t,n,r)]}}))}))},t}();function Ug(t,e){return Lg(t=(0,i.getModularInstance)(t),e)}var qg=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),jg=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new qg(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new qg(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new qg(t,i,i._ref))}:{next:e.next?function(t){return e.next(new qg(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),Vg=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new Bg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new Bg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),Bg=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return xg(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new jg(function(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Cg(t,new ig(e),n)}(t=(0,i.getModularInstance)(t),e,n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=Ov.RAW),this._throwIfRoot("putString");var r=Mv(e,t),i=(0,_r.__assign)({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new jg(new Cg(this._delegate,new ig(r.data,!0),i),this)},t.prototype.listAll=function(){var t=this;return function(t){return Ag(t=(0,i.getModularInstance)(t))}(this._delegate).then((function(e){return new Vg(e,t.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return Pg(t=(0,i.getModularInstance)(t),e)}(this._delegate,t||void 0).then((function(t){return new Vg(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=mg(t.storage,t._location,lg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,i.getModularInstance)(t))}(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=Jv(e.fullServerUrl(),t.host),o=fg(n,r),a=t.maxOperationRetryTime,s=new dg(i,"PATCH",vg(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=yg(e),s}(t.storage,t._location,e,lg()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}(t=(0,i.getModularInstance)(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return Rg(t=(0,i.getModularInstance)(t))}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=Jv(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new dg(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=yg(e),i}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,i.getModularInstance)(t))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw Rv(t)},t}(),Kg=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(Dg(t))throw Nv("ref() expected a child path but got a URL, use refFromURL instead.");return new Bg(Ug(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!Dg(t))throw Nv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Gv.makeFromUrl(t,this._delegate.host)}catch(t){throw Nv("refFromUrl() expected a valid full URL but got an invalid one.")}return new Bg(Ug(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){!function(t,e,n){t.host="http://"+e+":"+n}(this._delegate,t,e)},t}();function Hg(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new Kg(i,new Fg(i,o,a,new Wv,n,r.default.SDK_VERSION))}!function(t){var e={TaskState:Bv,TaskEvent:Vv,StringFormat:Ov,Storage:Fg,Reference:Bg};t.INTERNAL.registerComponent(new Ud.Component("storage",Hg,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.5")}(r.default);var Wg,Gg,zg,Qg="0.4.15",Yg=Qg,Xg="FB-PERF-TRACE-MEASURE",$g="_wt_",Jg="_fcp",Zg="_fid",ty="@firebase/performance/config",ey="@firebase/performance/configexpire",ny="Performance",ry=((Wg={})["trace started"]="Trace {$traceName} was started before.",Wg["trace stopped"]="Trace {$traceName} is not running.",Wg["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",Wg["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",Wg["no window"]="Window is not available.",Wg["no app id"]="App id is not available.",Wg["no project id"]="Project id is not available.",Wg["no api key"]="Api key is not available.",Wg["invalid cc log"]="Attempted to queue invalid cc event",Wg["FB not default"]="Performance can only start when Firebase app instance is the default one.",Wg["RC response not ok"]="RC response is not ok",Wg["invalid attribute name"]="Attribute name {$attributeName} is invalid.",Wg["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",Wg["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",Wg["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",Wg),iy=new i.ErrorFactory("performance",ny,ry),oy=new o.Logger(ny);oy.logLevel=o.LogLevel.INFO;var ay,sy=function(){function t(t){if(this.window=t,!t)throw iy.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,i.isIndexedDBAvailable)()||(oy.info("IndexedDB is not supported by current browswer"),!1):(oy.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===Gg&&(Gg=new t(zg)),Gg},t}();function uy(t,e){var n=t.length-e.length;if(n<0||n>1)throw iy.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var cy,ly,hy=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=uy("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=uy("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw iy.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw iy.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw iy.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===ay&&(ay=new t),ay},t}();function fy(){return cy}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(ly||(ly={}));var dy=["firebase_","google_","ga_"],py=new RegExp("^[a-zA-Z]\\w*$");function vy(){var t=sy.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function gy(){switch(sy.getInstance().document.visibilityState){case"visible":return ly.VISIBLE;case"hidden":return ly.HIDDEN;default:return ly.UNKNOWN}}function yy(){var t=sy.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var my="Could not fetch config, will use default configs";function _y(t){if(!t)return t;var e=hy.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=true,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=by(e.tracesSamplingRate),e.logNetworkAfterSampling=by(e.networkRequestsSamplingRate),t}function by(t){return Math.random()<=t}var wy,Iy=1;function Ty(){return Iy=2,wy=wy||function(){var t=sy.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=hy.getInstance().installationsService.getId()).then((function(t){cy=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=sy.getInstance().localStorage;if(t){var e=t.getItem(ey);if(e&&Number(e)>Date.now()){var n=t.getItem(ty);if(n)try{return JSON.parse(n)}catch(t){return}}}}();return e?(_y(e),Promise.resolve()):function(t){return(e=hy.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+hy.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+hy.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:hy.getInstance().getAppId(),app_version:Yg,sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw iy.create("RC response not ok")}))})).catch((function(){oy.info(my)}));var e}(t).then(_y).then((function(t){return function(t){var e=sy.getInstance().localStorage;t&&e&&(e.setItem(ty,JSON.stringify(t)),e.setItem(ey,String(Date.now()+60*hy.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return Ey()}),(function(){return Ey()}))}function Ey(){Iy=3}var Sy,Cy=1e4,ky=3,Ay=[],Ny=!1;function Py(t){setTimeout((function(){var t,e;if(0!==ky)return Ay.length?(e=(t=Ay.splice(0,1e3)).map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=hy.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||oy.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=Cy;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(Ay=(0,_r.__spreadArray)((0,_r.__spreadArray)([],e),Ay),oy.info("Retry transport request later.")),ky=3,Py(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:hy.getInstance().logSource,log_event:e},t).catch((function(){Ay=(0,_r.__spreadArray)((0,_r.__spreadArray)([],t),Ay),ky--,oy.info("Tries left: "+ky+"."),Py(Cy)}))):Py(Cy)}),t)}function Ry(t){if(!t.eventTime||!t.message)throw iy.create("invalid cc log");Ay=(0,_r.__spreadArray)((0,_r.__spreadArray)([],Ay),[t])}function xy(t,e){Sy||(Sy=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Ry({message:t.apply(void 0,e),eventTime:Date.now()})}}(Ly)),Sy(t,e)}function Dy(t){var e=hy.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&sy.getInstance().requiredApisAvailable()&&(t.isAuto&&gy()!==ly.VISIBLE||(3===Iy?Oy(t):Ty().then((function(){return Oy(t)}),(function(){return Oy(t)}))))}function Oy(t){if(fy()){var e=hy.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return xy(t,1)}),0)}}function Ly(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:My(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:My(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function My(){return{google_app_id:hy.getInstance().getAppId(),app_instance_id:fy(),web_app_info:{sdk_version:Yg,page_url:sy.getInstance().getUrl(),service_worker_status:vy(),visibility_state:gy(),effective_connection_type:yy()},application_process_state:0}}var Fy=["_fp",Jg,Zg],Uy=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=sy.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw iy.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw iy.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Dy(this)},t.prototype.record=function(t,e,n){if(t<=0)throw iy.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw iy.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=(0,_r.__assign)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Dy(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,o=this.name,0===i.length||i.length>100||!(o&&o.startsWith($g)&&Fy.indexOf(i)>-1)&&i.startsWith("_"))throw iy.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&oy.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||dy.some((function(t){return n.startsWith(t)}))||!n.match(py)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw iy.create("invalid attribute name",{attributeName:t});if(!i)throw iy.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return(0,_r.__assign)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=sy.getInstance().getUrl();if(i){var o=new t($g+i,!0),a=Math.floor(1e3*sy.getInstance().getTimeOrigin());if(o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(Jg,Math.floor(1e3*u.startTime)),r&&o.putMetric(Zg,Math.floor(1e3*r))}Dy(o)}},t.createUserTimingTrace=function(e){Dy(new t(e,!1,e))},t}();function qy(t){var e=t;if(e&&void 0!==e.responseStart){var n=sy.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=hy.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return xy(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function jy(){fy()&&(setTimeout((function(){return function(){var t=sy.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){Uy.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),Uy.createOobTrace(e,n,t))}))}else Uy.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=sy.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)qy(n[e]);t.setupObserver("resource",qy)}()}),0),setTimeout((function(){return function(){for(var t=sy.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)Vy(n[e]);t.setupObserver("measure",Vy)}()}),0))}function Vy(t){var e=t.name;e.substring(0,Xg.length)!==Xg&&Uy.createUserTimingTrace(e)}var By=function(){function t(t){this.app=t,sy.getInstance().requiredApisAvailable()&&(0,i.validateIndexedDBOpenable)().then((function(t){t&&(Ny||(Py(5500),Ny=!0),Ty().then(jy,jy))})).catch((function(t){oy.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new Uy(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return hy.getInstance().instrumentationEnabled},set:function(t){hy.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return hy.getInstance().dataCollectionEnabled},set:function(t){hy.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new Ud.Component("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw iy.create("FB not default");if("undefined"==typeof window)throw iy.create("no window");return function(t){zg=t}(window),hy.getInstance().firebaseAppInstance=t,hy.getInstance().installationsService=e,new By(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance",Qg)}(r.default);var Ky,Hy,Wy="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(Ky||(Ky={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(Hy||(Hy={}));var Gy,zy=new o.Logger("@firebase/analytics");function Qy(t,e,n,r,i,o){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var a,s,u,c;return(0,_r.__generator)(this,(function(l){switch(l.label){case 0:a=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=l.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return c=l.sent(),zy.error(c),[3,8];case 8:return t(Ky.CONFIG,i,o),[2]}}))}))}function Yy(t,e,n,r,i){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,h,f;return(0,_r.__generator)(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=d.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=a;c<l.length&&(h=l[c],"break"!==u(h));c++);d.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return d.sent(),t(Ky.EVENT,r,i||{}),[3,5];case 4:return f=d.sent(),zy.error(f),[3,5];case 5:return[2]}}))}))}var Xy=((Gy={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Gy["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Gy["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Gy["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Gy["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Gy["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Gy["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Gy["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Gy["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Gy),$y=new i.ErrorFactory("analytics","Analytics",Xy),Jy=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Zy(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function tm(t){var e;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:Zy(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=c.sent()).status||304===a.status)return[3,6];s="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(s=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw $y.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function em(t,e,n,r){var o=e.throttleEndTimeMillis,a=e.backoffCount;return void 0===r&&(r=Jy),(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,s,u,c,l,h,f;return(0,_r.__generator)(this,(function(d){switch(d.label){case 0:e=t.appId,s=t.measurementId,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,nm(n,o)];case 2:return d.sent(),[3,4];case 3:if(u=d.sent(),s)return zy.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+u.message+"]"),[2,{appId:e,measurementId:s}];throw u;case 4:return d.trys.push([4,6,,7]),[4,tm(t)];case 5:return c=d.sent(),r.deleteThrottleMetadata(e),[2,c];case 6:if(!function(t){if(!(t instanceof i.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l=d.sent())){if(r.deleteThrottleMetadata(e),s)return zy.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:e,measurementId:s}];throw l}return h=503===Number(l.customData.httpStatus)?(0,i.calculateBackoffMillis)(a,r.intervalMillis,30):(0,i.calculateBackoffMillis)(a,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:a+1},r.setThrottleMetadata(e,f),zy.debug("Calling attemptFetch again in "+h+" millis"),[2,em(t,f,n,r)];case 7:return[2]}}))}))}function nm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r($y.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var rm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();var im,om,am={},sm=[],um={},cm="dataLayer",lm="gtag",hm=!1;function fm(t){if(hm)throw $y.create("already-initialized");t.dataLayerName&&(cm=t.dataLayerName),t.gtagName&&(lm=t.gtagName)}function dm(t,e){!function(){var t=[];if((0,i.isBrowserExtension)()&&t.push("This is a browser extension environment."),(0,i.areCookiesEnabled)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=$y.create("invalid-analytics-context",{errorInfo:e});zy.warn(n.message)}}();var n=t.options.appId;if(!n)throw $y.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw $y.create("no-api-key");zy.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=am[n])throw $y.create("already-exists",{id:n});if(!hm){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(cm);var r=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var s;return(0,_r.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==Ky.EVENT?[3,2]:[4,Yy(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==Ky.CONFIG?[3,4]:[4,Qy(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(Ky.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),zy.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(am,sm,um,cm,lm),o=r.wrappedGtag,a=r.gtagCore;om=o,im=a,hm=!0}return am[n]=function(t,e,n,r,o,a){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var s,u,c,l,h,f,d;return(0,_r.__generator)(this,(function(p){switch(p.label){case 0:return(s=function(t,e,n){return void 0===e&&(e=Jy),(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u=this;return(0,_r.__generator)(this,(function(c){if(n=t.options,r=n.appId,i=n.apiKey,o=n.measurementId,!r)throw $y.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw $y.create("no-api-key")}return a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new rm,setTimeout((function(){return(0,_r.__awaiter)(u,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){return s.abort(),[2]}))}))}),6e4),[2,em({appId:r,apiKey:i,measurementId:o},a,s,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&zy.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return zy.error(t)})),e.push(s),u=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,_r.__generator)(this,(function(e){switch(e.label){case 0:return(0,i.isIndexedDBAvailable)()?[3,1]:(zy.warn($y.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,i.validateIndexedDBOpenable)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),zy.warn($y.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([s,u])];case 1:return c=p.sent(),l=c[0],h=c[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(Wy))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=Wy+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(a,l.measurementId),o("js",new Date),(d={}).origin="firebase",d.update=!0,f=d,null!=h&&(f.firebase_id=h),o(Ky.CONFIG,l.measurementId,f),[2,l.measurementId]}}))}))}(t,sm,um,e,im,cm),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(Ky.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=(0,_r.__assign)((0,_r.__assign)({},r),{send_to:o}),t(Ky.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(om,am[n],t,e,r).catch((function(t){return zy.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Ky.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Ky.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(om,am[n],t,e).catch((function(t){return zy.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Ky.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Ky.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(om,am[n],t,e).catch((function(t){return zy.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u;return(0,_r.__generator)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return t(Ky.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(Ky.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(om,am[n],t,e).catch((function(t){return zy.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(am[n],t).catch((function(t){return zy.error(t)}))},INTERNAL:{delete:function(){return delete am[n],Promise.resolve()}}}}var pm="analytics";function vm(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:if((0,i.isBrowserExtension)())return[2,!1];if(!(0,i.areCookiesEnabled)())return[2,!1];if(!(0,i.isIndexedDBAvailable)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,i.validateIndexedDBOpenable)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new Ud.Component(pm,(function(t){return dm(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:fm,EventName:Hy,isSupported:vm})),t.INTERNAL.registerComponent(new Ud.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider(pm).getImmediate().logEvent}}catch(t){throw $y.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.13")}(r.default);var gm,ym=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),mm=((gm={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",gm["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",gm["registration-api-key"]="Undefined API key. Check Firebase app initialization.",gm["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",gm["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",gm["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",gm["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",gm["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",gm["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",gm["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',gm["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',gm["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",gm["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",gm),_m=new i.ErrorFactory("remoteconfig","Remote Config",mm),bm=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,v,g,y,m,_;return(0,_r.__generator)(this,(function(b){switch(b.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=b.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:a,body:JSON.stringify(s)},c=fetch(o,u),l=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),b.label=2;case 2:return b.trys.push([2,5,,6]),[4,Promise.race([c,l])];case 3:return b.sent(),[4,c];case 4:return h=b.sent(),[3,6];case 5:throw f=b.sent(),d="fetch-client-network","AbortError"===f.name&&(d="fetch-timeout"),_m.create(d,{originalErrorMessage:f.message});case 6:if(p=h.status,v=h.headers.get("ETag")||void 0,200!==h.status)return[3,11];m=void 0,b.label=7;case 7:return b.trys.push([7,9,,10]),[4,h.json()];case 8:return m=b.sent(),[3,10];case 9:throw _=b.sent(),_m.create("fetch-client-parse",{originalErrorMessage:_.message});case 10:g=m.entries,y=m.state,b.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===y?p=500:"NO_CHANGE"===y?p=304:"NO_TEMPLATE"!==y&&"EMPTY_CONFIG"!==y||(g={}),304!==p&&200!==p)throw _m.create("fetch-status",{httpStatus:p});return[2,{status:p,eTag:v,config:g}]}var w}))}))},t}(),wm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),Im=["1","true","t","yes","y","on"],Tm=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&Im.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),Em=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=o.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=o.LogLevel.SILENT;break;default:this._logger.logLevel=o.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r=this;return(0,_r.__generator)(this,(function(o){switch(o.label){case 0:t=new wm,setTimeout((function(){return(0,_r.__awaiter)(r,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return o.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return o.sent(),[3,6];case 4:return e=o.sent(),n=function(t,e){return t instanceof i.FirebaseError&&-1!==t.code.indexOf("fetch-throttle")}(e)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw o.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){return(0,_r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys((0,_r.__assign)((0,_r.__assign)({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Tm("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Tm("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Tm("static"))},t}();function Sm(t,e){var n=t.target.error||void 0;return _m.create(e,{originalErrorMessage:n&&n.message})}var Cm="app_namespace_store",km=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Sm(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(Cm,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Cm],"readonly").objectStore(Cm),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(Sm(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(_m.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,_r.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([Cm],"readwrite").objectStore(Cm),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(Sm(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(_m.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,_r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Cm],"readwrite").objectStore(Cm),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(Sm(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(t){i(_m.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),Am=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return(0,_r.__generator)(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function Nm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(_m.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Pm,Rm=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,_r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return(0,_r.__awaiter)(this,void 0,void 0,(function(){var e,o,a;return(0,_r.__generator)(this,(function(s){switch(s.label){case 0:return[4,Nm(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof i.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(o=s.sent()))throw o;return a={throttleEndTimeMillis:Date.now()+(0,i.calculateBackoffMillis)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(a)];case 6:return s.sent(),[2,this.attemptFetch(t,a)];case 7:return[2]}}))}))},t}(),xm="@firebase/remote-config";(Pm=r.default).INTERNAL.registerComponent(new Ud.Component("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw _m.create("registration-window");var a=r.options,s=a.projectId,u=a.apiKey,c=a.appId;if(!s)throw _m.create("registration-project-id");if(!u)throw _m.create("registration-api-key");if(!c)throw _m.create("registration-app-id");n=n||"firebase";var l=new km(c,r.name,n),h=new Am(l),f=new o.Logger(xm);f.logLevel=o.LogLevel.ERROR;var d=new bm(i,Pm.SDK_VERSION,n,s,u,c),p=new Rm(d,l),v=new ym(p,l,h,f),g=new Em(r,v,h,l,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),Pm.registerVersion(xm,"0.1.40"),n(342);var Dm="8.6.8";r.default.registerVersion("firebase",Dm,"app"),r.default.SDK_VERSION=Dm,console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),r.default.registerVersion("firebase","8.6.8")},15:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new d(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},163:(t,e,n)=>{"use strict";n.r(e),n.d(e,{__extends:()=>i,__assign:()=>o,__rest:()=>a,__decorate:()=>s,__param:()=>u,__metadata:()=>c,__awaiter:()=>l,__generator:()=>h,__createBinding:()=>f,__exportStar:()=>d,__values:()=>p,__read:()=>v,__spread:()=>g,__spreadArrays:()=>y,__spreadArray:()=>m,__await:()=>_,__asyncGenerator:()=>b,__asyncDelegator:()=>w,__asyncValues:()=>I,__makeTemplateObject:()=>T,__importStar:()=>S,__importDefault:()=>C,__classPrivateFieldGet:()=>k,__classPrivateFieldSet:()=>A});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var f=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function d(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||f(e,t,n)}function p(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof _?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:_(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=p(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&f(e,t,n);return E(e,t),e}function C(t){return t&&t.__esModule?t:{default:t}}function k(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function A(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{const{default:t}=n(59);t.initializeApp({apiKey:"AIzaSyDS0-IJar13_e77IoYAAAIE5YyRGDfmUH0",authDomain:"second-6266e.firebaseapp.com",projectId:"second-6266e",storageBucket:"second-6266e.appspot.com",messagingSenderId:"884343805455",appId:"1:884343805455:web:bf0c472390ea6ef35ff57a"});const e=t.auth(),r=t.firestore(),i=document.getElementById("signup-form"),o=document.getElementById("log-out"),a=document.querySelector("#user"),s=document.querySelector("#signin-form"),u=document.querySelector(".rooms"),c=document.querySelector("#rooms"),l=document.querySelectorAll(".logged-out"),h=document.querySelector(".logged-in");document.querySelector("#input-list");const f=t=>{if(t){const e=`Hello ${t.email}`;a.innerHTML=e,h.style.display="block",l.forEach((t=>{t.style.display="none"}))}else a.innerHTML="",h.style.display="none",l.forEach((t=>{t.style.display="block"}))};i.addEventListener("submit",(t=>{t.preventDefault();const n=i["signup-email"].value,o=i["signup-password"].value;e.createUserWithEmailAndPassword(n,o).then((t=>r.collection("users").doc(t.user.uid).set({name:t.user.email,list_one:[],list_two:[],list_three:[],list_four:[],rooms_joined:[]}).then((()=>{a.innerHTML=`Hello ${t.user.email}`,i.reset(),c.style.display="block"}))))})),o.addEventListener("click",(function(n){n.preventDefault(),r.collection("users").doc(t.auth().currentUser.uid).get().then((n=>{console.log("DOC DATA DOC DATA",n.data().rooms_joined),r.collection("rooms").doc(n.data().rooms_joined).get().then((e=>{e.data().users.forEach((n=>{n===t.auth().currentUser.uid&&(console.log("UHM USER LIKE:",n),console.log("DOCREF",e.ref),e.ref.update({users:t.firestore.FieldValue.arrayRemove(n)}))}))})).then((()=>{console.log("signed out sonasokdfn"),e.signOut().then((()=>{console.log("booyah")}))}))})),a.innerHTML="Signed Out",c.style.display="none"})),s.addEventListener("submit",(t=>{t.preventDefault();const n=s["signin-email"].value,r=s["signin-password"].value;e.signInWithEmailAndPassword(n,r).then((t=>{a.innerHTML="Hello "+t.user.email,s.reset(),c.style.display="block"}))})),e.onAuthStateChanged((t=>{console.log(t),t?(console.log("USERUSER",t),c.style.display="block",r.collection("rooms").onSnapshot((t=>{d(t.docs)})),f(t)):(d([]),f())}));const d=t=>{if(t.length){let e="";t.forEach((t=>{const n=t.data();console.log(t.id);const r=`<li><button data-id="btn" class="room-select" id="${t.id}">${n.Name}</button>${n.Count} Students</li>`;e+=r})),u.innerHTML=e}else u.innerHTML="<h5>Log in to view rooms</h5>"},p=document.querySelector("#create-room");function v(t){let e=document.querySelector("#user-list");console.log("HAR"),t.onSnapshot((t=>{let n="";t.data().user_names.forEach((t=>{n+=`<li> ${t} </li>`,console.log(t)})),e.innerHTML=n}))}p.addEventListener("submit",(t=>{t.preventDefault(),r.collection("rooms").add({Name:p["room-name"].value,Count:p["room-count"].value,active_count:0,user_names:[],users:[],words:[]}).then((()=>{p.reset()})).catch((t=>{console.error(t)}))})),document.body.addEventListener("click",(function(e){let n,i;if("btn"==e.target.dataset.id)return n=e.target.id,i=r.collection("rooms").doc(n),r.runTransaction((t=>t.get(i).then((e=>{if(console.log(e.data()),e.data().active_count<e.data().Count){let n=e.data().active_count+1;t.update(i,{active_count:n})}})))).then((()=>(document.querySelector("#play-box").style.display="grid",v(i),i.update({users:t.firestore.FieldValue.arrayUnion(t.auth().currentUser.uid),user_names:t.firestore.FieldValue.arrayUnion(t.auth().currentUser.email)}).then((()=>{i.get().then((e=>{a.innerHTML=e.data().Name;let n=t.auth().currentUser.uid;var i;r.collection("users").doc(n).update({rooms_joined:e.id}),i=e.id,r.collection("rooms").doc(i).onSnapshot((t=>{let e=t.data(),n=r.collection("rooms").doc(i);console.log("ROOMROOM",i),console.log("SNAPSHOT SNAPSHOT"),e.Count===e.active_count?(v(n),function(t){r.runTransaction((e=>e.get(t).then((t=>{console.log("DOCDOC:",t.data().Count);let e=document.querySelector("#input-list"),n="";for(let e=0;e<t.data().Count;e++)n+='<li><input type="text" placeholder="enter word" class="input-cell" </input> </li>';n+=`<button class="next-1"id='${t.id}'>Next</button>`,e.innerHTML=n})).then((()=>{document.querySelector(".next-1").addEventListener("click",y)}))))}(n)):console.log("waiting for all users to join")})),console.log("ROOMROOM",i)})),console.log("user added")})))))}));let g=[];function y(e){let n=r.collection("rooms").doc(e.target.id);return r.runTransaction((e=>e.get(n).then((e=>{document.querySelectorAll(".input-cell").forEach((n=>{g.push(n.value+" "),console.log(n.value),e.ref.update({words:t.firestore.FieldValue.arrayUnion(n.value)})}))})).then((()=>{console.log("works"),n.get().then((t=>{let e=document.getElementById("input-list"),n="";for(let e=0;e<t.data().Count;e++){let e=Math.floor(Math.random()*t.data().Count);n+=`<li>${t.data().words[e]}</li>`}e.innerHTML=n}))})).then((()=>{n.get().then((t=>{console.log("BLUE TEST",t.data().words);let e=document.getElementById("input-list1"),n="";for(let e=0;e<t.data().active_count;e++)n+='<li>\n          <input type="text" placeholder="enter word" class="input-cell2"</input>\n          </li>';n+=`<button data-id="next-2" class="next-2"id='${t.id}'>Next</button>`,e.innerHTML=n}))})).then((()=>{console.log("DOCREF",n)}))))}document.querySelector("#test-btn").addEventListener("click",(function(){console.log(g),console.log(m)})),document.body.addEventListener("click",(function(e){document.querySelectorAll("input-cell2").forEach((t=>{m.push(t.value)})),"next-2"===e.target.dataset.id&&(console.log("ok"),function(e){r.collection("users").doc(t.auth().currentUser.uid);let n=r.collection("rooms").doc(e.target.id);r.runTransaction((e=>e.get(n).then((e=>{console.log("works");let n=document.querySelectorAll("input-cell2");console.log("works"),n.forEach((n=>{console.log(n.value,"CELL VALUE"),e.ref.update({words:t.firestore.FieldValue.arrayUnion(n.value)})}))})).then((()=>{console.log("works"),n.get().then((t=>{let e=document.getElementById("input-list1"),n="";for(let e=0;e<t.data().Count;e++){let e=Math.floor(Math.random()*t.data().Count);n+=`<li>${t.data().words[e]}</li>`}e.innerHTML=n}))})).then((()=>{let t=document.getElementById("input-list2"),e="";n.get().then((n=>{for(let t=0;t<n.data().active_count;t++)e+='<li><input type="text" placeholder="enter word" class="input-cell3" </input> </li>';e+=`<button data-id="next-3" id="${n.id}"class="next-3">Next</button>`,t.innerHTML=e}))})).then((()=>{document.body.addEventListener("click",(function(t){"next-3"===t.target.dataset.id&&(console.log("woohoo"),_(t))}))}))))}(e))}));let m=[];const _=e=>{let n=r.collection("rooms").doc(e.target.id);return r.runTransaction((e=>e.get(n).then((e=>{console.log("works"),document.querySelectorAll("input-cell3").forEach((n=>{console.log(n.value),g.push(n.value),e.ref.update({words:t.firestore.FieldValue.arrayUnion(n.value)})}))})).then((()=>{console.log("works"),n.get().then((t=>{let e=document.getElementById("input-list2"),n="";for(let e=0;e<t.data().Count;e++){let e=Math.floor(Math.random()*t.data().Count);n+=`<li>${t.data().words[e]}</li>`}e.innerHTML=n}))})).then((()=>{let t=document.getElementById("input-list3"),e="";n.get().then((n=>{for(let t=0;t<n.data().active_count;t++)e+='<li><input type="text" placeholder="enter word" class="input-cell" </input> </li>';e+=`<button data-id="${n.id}" class="next-3">Next</button>`,t.innerHTML=e}))}))))}})()})();